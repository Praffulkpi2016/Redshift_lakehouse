TRUNCATE table silver_bec_ods.xxbec_ibom_rc_temp;
INSERT INTO silver_bec_ods.xxbec_ibom_rc_temp (
  TOP_BILL_SEQUENCE_ID,
  BILL_SEQUENCE_ID,
  ORGANIZATION_ID,
  COMPONENT_SEQUENCE_ID,
  COMPONENT_ITEM_ID,
  PLAN_LEVEL,
  EXTENDED_QUANTITY,
  SORT_ORDER,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  GROUP_ID,
  SESSION_ID,
  SELECT_FLAG,
  SELECT_QUANTITY,
  EXTEND_COST_FLAG,
  TOP_ALTERNATE_DESIGNATOR,
  TOP_ITEM_ID,
  CONTEXT,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  HEADER_ID,
  LINE_ID,
  LIST_PRICE,
  SELLING_PRICE,
  COMPONENT_YIELD_FACTOR,
  ITEM_COST,
  INCLUDE_IN_ROLLUP_FLAG,
  BASED_ON_ROLLUP_FLAG,
  ACTUAL_COST_TYPE_ID,
  COMPONENT_QUANTITY,
  SHRINKAGE_RATE,
  SO_BASIS,
  OPTIONAL,
  MUTUALLY_EXCLUSIVE_OPTIONS,
  CHECK_ATP,
  SHIPPING_ALLOWED,
  REQUIRED_TO_SHIP,
  REQUIRED_FOR_REVENUE,
  INCLUDE_ON_SHIP_DOCS,
  INCLUDE_ON_BILL_DOCS,
  LOW_QUANTITY,
  HIGH_QUANTITY,
  PICK_COMPONENTS,
  PRIMARY_UOM_CODE,
  PRIMARY_UNIT_OF_MEASURE,
  BASE_ITEM_ID,
  ATP_COMPONENTS_FLAG,
  ATP_FLAG,
  BOM_ITEM_TYPE,
  PICK_COMPONENTS_FLAG,
  REPLENISH_TO_ORDER_FLAG,
  SHIPPABLE_ITEM_FLAG,
  CUSTOMER_ORDER_FLAG,
  INTERNAL_ORDER_FLAG,
  CUSTOMER_ORDER_ENABLED_FLAG,
  INTERNAL_ORDER_ENABLED_FLAG,
  SO_TRANSACTIONS_FLAG,
  MTL_TRANSACTIONS_ENABLED_FLAG,
  STOCK_ENABLED_FLAG,
  DESCRIPTION,
  ASSEMBLY_ITEM_ID,
  CONFIGURATOR_FLAG,
  PRICE_LIST_ID,
  ROUNDING_FACTOR,
  PRICING_CONTEXT,
  PRICING_ATTRIBUTE1,
  PRICING_ATTRIBUTE2,
  PRICING_ATTRIBUTE3,
  PRICING_ATTRIBUTE4,
  PRICING_ATTRIBUTE5,
  PRICING_ATTRIBUTE6,
  PRICING_ATTRIBUTE7,
  PRICING_ATTRIBUTE8,
  PRICING_ATTRIBUTE9,
  PRICING_ATTRIBUTE10,
  PRICING_ATTRIBUTE11,
  PRICING_ATTRIBUTE12,
  PRICING_ATTRIBUTE13,
  PRICING_ATTRIBUTE14,
  PRICING_ATTRIBUTE15,
  COMPONENT_CODE,
  LOOP_FLAG,
  INVENTORY_ASSET_FLAG,
  PLANNING_FACTOR,
  OPERATION_SEQ_NUM,
  PARENT_BOM_ITEM_TYPE,
  WIP_SUPPLY_TYPE,
  ITEM_NUM,
  EFFECTIVITY_DATE,
  DISABLE_DATE,
  IMPLEMENTATION_DATE,
  SUPPLY_SUBINVENTORY,
  SUPPLY_LOCATOR_ID,
  COMPONENT_REMARKS,
  CHANGE_NOTICE,
  OPERATION_LEAD_TIME_PERCENT,
  REXPLODE_FLAG,
  COMMON_BILL_SEQUENCE_ID,
  OPERATION_OFFSET,
  CURRENT_REVISION,
  LOCATOR,
  FROM_END_ITEM_UNIT_NUMBER,
  TO_END_ITEM_UNIT_NUMBER,
  BASIS_TYPE,
  kca_operation,
  is_deleted_flg,
  kca_seq_id,
  kca_seq_date
)
SELECT
  TOP_BILL_SEQUENCE_ID,
  BILL_SEQUENCE_ID,
  ORGANIZATION_ID,
  COMPONENT_SEQUENCE_ID,
  COMPONENT_ITEM_ID,
  PLAN_LEVEL,
  EXTENDED_QUANTITY,
  SORT_ORDER,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  GROUP_ID,
  SESSION_ID,
  SELECT_FLAG,
  SELECT_QUANTITY,
  EXTEND_COST_FLAG,
  TOP_ALTERNATE_DESIGNATOR,
  TOP_ITEM_ID,
  CONTEXT,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  HEADER_ID,
  LINE_ID,
  LIST_PRICE,
  SELLING_PRICE,
  COMPONENT_YIELD_FACTOR,
  ITEM_COST,
  INCLUDE_IN_ROLLUP_FLAG,
  BASED_ON_ROLLUP_FLAG,
  ACTUAL_COST_TYPE_ID,
  COMPONENT_QUANTITY,
  SHRINKAGE_RATE,
  SO_BASIS,
  OPTIONAL,
  MUTUALLY_EXCLUSIVE_OPTIONS,
  CHECK_ATP,
  SHIPPING_ALLOWED,
  REQUIRED_TO_SHIP,
  REQUIRED_FOR_REVENUE,
  INCLUDE_ON_SHIP_DOCS,
  INCLUDE_ON_BILL_DOCS,
  LOW_QUANTITY,
  HIGH_QUANTITY,
  PICK_COMPONENTS,
  PRIMARY_UOM_CODE,
  PRIMARY_UNIT_OF_MEASURE,
  BASE_ITEM_ID,
  ATP_COMPONENTS_FLAG,
  ATP_FLAG,
  BOM_ITEM_TYPE,
  PICK_COMPONENTS_FLAG,
  REPLENISH_TO_ORDER_FLAG,
  SHIPPABLE_ITEM_FLAG,
  CUSTOMER_ORDER_FLAG,
  INTERNAL_ORDER_FLAG,
  CUSTOMER_ORDER_ENABLED_FLAG,
  INTERNAL_ORDER_ENABLED_FLAG,
  SO_TRANSACTIONS_FLAG,
  MTL_TRANSACTIONS_ENABLED_FLAG,
  STOCK_ENABLED_FLAG,
  DESCRIPTION,
  ASSEMBLY_ITEM_ID,
  CONFIGURATOR_FLAG,
  PRICE_LIST_ID,
  ROUNDING_FACTOR,
  PRICING_CONTEXT,
  PRICING_ATTRIBUTE1,
  PRICING_ATTRIBUTE2,
  PRICING_ATTRIBUTE3,
  PRICING_ATTRIBUTE4,
  PRICING_ATTRIBUTE5,
  PRICING_ATTRIBUTE6,
  PRICING_ATTRIBUTE7,
  PRICING_ATTRIBUTE8,
  PRICING_ATTRIBUTE9,
  PRICING_ATTRIBUTE10,
  PRICING_ATTRIBUTE11,
  PRICING_ATTRIBUTE12,
  PRICING_ATTRIBUTE13,
  PRICING_ATTRIBUTE14,
  PRICING_ATTRIBUTE15,
  COMPONENT_CODE,
  LOOP_FLAG,
  INVENTORY_ASSET_FLAG,
  PLANNING_FACTOR,
  OPERATION_SEQ_NUM,
  PARENT_BOM_ITEM_TYPE,
  WIP_SUPPLY_TYPE,
  ITEM_NUM,
  EFFECTIVITY_DATE,
  DISABLE_DATE,
  IMPLEMENTATION_DATE,
  SUPPLY_SUBINVENTORY,
  SUPPLY_LOCATOR_ID,
  COMPONENT_REMARKS,
  CHANGE_NOTICE,
  OPERATION_LEAD_TIME_PERCENT,
  REXPLODE_FLAG,
  COMMON_BILL_SEQUENCE_ID,
  OPERATION_OFFSET,
  CURRENT_REVISION,
  LOCATOR,
  FROM_END_ITEM_UNIT_NUMBER,
  TO_END_ITEM_UNIT_NUMBER,
  BASIS_TYPE,
  kca_operation,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  KCA_SEQ_DATE
FROM bronze_bec_ods_stg.xxbec_ibom_rc_temp;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'xxbec_ibom_rc_temp';