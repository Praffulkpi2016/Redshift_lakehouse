DROP table IF EXISTS silver_bec_ods.XXBEC_INVENTORY_VALUE_RPT;
CREATE TABLE IF NOT EXISTS silver_bec_ods.XXBEC_INVENTORY_VALUE_RPT (
  AS_OF_DATE TIMESTAMP,
  INV_CATEGORY STRING,
  INV_SUBCATEGORY STRING,
  SUBINVENTORY STRING,
  LOCATOR STRING,
  PART_NUMBER STRING,
  DESCRIPTION STRING,
  INVENTORY_ITEM_STATUS_CODE STRING,
  CATEGORY_SEGMENT1 STRING,
  CATEGORY_SEGMENT2 STRING,
  CATEGORY STRING,
  PRIMARY_UOM_CODE STRING,
  QUANTITY DECIMAL(28, 10),
  ITEM_COST DECIMAL(28, 10),
  EXTENDED_COST DECIMAL(28, 10),
  ORGANIZATION_ID DECIMAL(15, 0),
  ORGANIZATION_NAME STRING,
  ORGANIZATION_CODE STRING,
  VMI_FLAG STRING,
  OWNING_ORGANIZATION_ID DECIMAL(15, 0),
  SUBINVENTORY_TYPE STRING,
  MATERIAL_COST DECIMAL(28, 10),
  MATERIAL_OVERHEAD_COST DECIMAL(28, 10),
  RESOURCE_COST DECIMAL(28, 10),
  OUTSIDE_PROCESSING_COST DECIMAL(28, 10),
  OVERHEAD_COST DECIMAL(28, 10),
  EXT_MATERIAL_COST DECIMAL(28, 10),
  EXT_MATERIAL_OVERHEAD_COST DECIMAL(28, 10),
  EXT_RESOURCE_COST DECIMAL(28, 10),
  EXT_OUTSIDE_PROCESSING_COST DECIMAL(28, 10),
  EXT_OVERHEAD_COST DECIMAL(28, 10),
  LOCATOR_ID DECIMAL(15, 0),
  kca_operation STRING,
  is_deleted_flg STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.XXBEC_INVENTORY_VALUE_RPT (
  AS_OF_DATE,
  INV_CATEGORY,
  INV_SUBCATEGORY,
  SUBINVENTORY,
  LOCATOR,
  PART_NUMBER,
  DESCRIPTION,
  INVENTORY_ITEM_STATUS_CODE,
  CATEGORY_SEGMENT1,
  CATEGORY_SEGMENT2,
  CATEGORY,
  PRIMARY_UOM_CODE,
  QUANTITY,
  ITEM_COST,
  EXTENDED_COST,
  ORGANIZATION_ID,
  ORGANIZATION_NAME,
  ORGANIZATION_CODE,
  VMI_FLAG,
  OWNING_ORGANIZATION_ID,
  SUBINVENTORY_TYPE,
  MATERIAL_COST,
  MATERIAL_OVERHEAD_COST,
  RESOURCE_COST,
  OUTSIDE_PROCESSING_COST,
  OVERHEAD_COST,
  EXT_MATERIAL_COST,
  EXT_MATERIAL_OVERHEAD_COST,
  EXT_RESOURCE_COST,
  EXT_OUTSIDE_PROCESSING_COST,
  EXT_OVERHEAD_COST,
  LOCATOR_ID,
  kca_operation,
  is_deleted_flg,
  kca_seq_id,
  kca_seq_date
)
(
  SELECT
    AS_OF_DATE,
    INV_CATEGORY,
    INV_SUBCATEGORY,
    SUBINVENTORY,
    LOCATOR,
    PART_NUMBER,
    DESCRIPTION,
    INVENTORY_ITEM_STATUS_CODE,
    CATEGORY_SEGMENT1,
    CATEGORY_SEGMENT2,
    CATEGORY,
    PRIMARY_UOM_CODE,
    QUANTITY,
    ITEM_COST,
    EXTENDED_COST,
    ORGANIZATION_ID,
    ORGANIZATION_NAME,
    ORGANIZATION_CODE,
    VMI_FLAG,
    OWNING_ORGANIZATION_ID,
    SUBINVENTORY_TYPE,
    MATERIAL_COST,
    MATERIAL_OVERHEAD_COST,
    RESOURCE_COST,
    OUTSIDE_PROCESSING_COST,
    OVERHEAD_COST,
    EXT_MATERIAL_COST,
    EXT_MATERIAL_OVERHEAD_COST,
    EXT_RESOURCE_COST,
    EXT_OUTSIDE_PROCESSING_COST,
    EXT_OVERHEAD_COST,
    LOCATOR_ID,
    kca_operation,
    'N' AS IS_DELETED_FLG,
    CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
    kca_seq_date
  FROM bronze_bec_ods_stg.XXBEC_INVENTORY_VALUE_RPT
);
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'xxbec_inventory_value_rpt';