DROP table IF EXISTS silver_bec_ods.CE_BANK_ACCOUNTS;
CREATE TABLE IF NOT EXISTS silver_bec_ods.CE_BANK_ACCOUNTS (
  BANK_ACCOUNT_ID DECIMAL(15, 0),
  BANK_ACCOUNT_NAME STRING,
  LAST_UPDATE_DATE TIMESTAMP,
  LAST_UPDATED_BY DECIMAL(15, 0),
  LAST_UPDATE_LOGIN DECIMAL(15, 0),
  CREATION_DATE TIMESTAMP,
  CREATED_BY DECIMAL(15, 0),
  BANK_ACCOUNT_NUM STRING,
  BANK_BRANCH_ID DECIMAL(15, 0),
  BANK_ID DECIMAL(15, 0),
  CURRENCY_CODE STRING,
  DESCRIPTION STRING,
  ATTRIBUTE_CATEGORY STRING,
  ATTRIBUTE1 STRING,
  ATTRIBUTE2 STRING,
  ATTRIBUTE3 STRING,
  ATTRIBUTE4 STRING,
  ATTRIBUTE5 STRING,
  ATTRIBUTE6 STRING,
  ATTRIBUTE7 STRING,
  ATTRIBUTE8 STRING,
  ATTRIBUTE9 STRING,
  ATTRIBUTE10 STRING,
  ATTRIBUTE11 STRING,
  ATTRIBUTE12 STRING,
  ATTRIBUTE13 STRING,
  ATTRIBUTE14 STRING,
  ATTRIBUTE15 STRING,
  REQUEST_ID DECIMAL(15, 0),
  PROGRAM_APPLICATION_ID DECIMAL(15, 0),
  PROGRAM_ID DECIMAL(15, 0),
  PROGRAM_UPDATE_DATE TIMESTAMP,
  CHECK_DIGITS STRING,
  BANK_ACCOUNT_NAME_ALT STRING,
  ACCOUNT_HOLDER_ID DECIMAL(15, 0),
  EFT_REQUESTER_IDENTIFIER STRING,
  SECONDARY_ACCOUNT_REFERENCE STRING,
  ACCOUNT_SUFFIX STRING,
  DESCRIPTION_CODE1 STRING,
  DESCRIPTION_CODE2 STRING,
  IBAN_NUMBER STRING,
  SHORT_ACCOUNT_NAME STRING,
  ACCOUNT_OWNER_PARTY_ID DECIMAL(15, 0),
  ACCOUNT_OWNER_ORG_ID DECIMAL(15, 0),
  ACCOUNT_CLASSIFICATION STRING,
  AP_USE_ALLOWED_FLAG STRING,
  AR_USE_ALLOWED_FLAG STRING,
  XTR_USE_ALLOWED_FLAG STRING,
  PAY_USE_ALLOWED_FLAG STRING,
  MULTI_CURRENCY_ALLOWED_FLAG STRING,
  PAYMENT_MULTI_CURRENCY_FLAG STRING,
  RECEIPT_MULTI_CURRENCY_FLAG STRING,
  ZERO_AMOUNT_ALLOWED STRING,
  MAX_OUTLAY DECIMAL(15, 0),
  MAX_CHECK_AMOUNT DECIMAL(28, 10),
  MIN_CHECK_AMOUNT DECIMAL(28, 10),
  AP_AMOUNT_TOLERANCE DECIMAL(28, 10),
  AR_AMOUNT_TOLERANCE DECIMAL(28, 10),
  XTR_AMOUNT_TOLERANCE DECIMAL(28, 10),
  PAY_AMOUNT_TOLERANCE DECIMAL(28, 10),
  AP_PERCENT_TOLERANCE DECIMAL(28, 10),
  AR_PERCENT_TOLERANCE DECIMAL(28, 10),
  XTR_PERCENT_TOLERANCE DECIMAL(28, 10),
  PAY_PERCENT_TOLERANCE DECIMAL(28, 10),
  BANK_ACCOUNT_TYPE STRING,
  AGENCY_LOCATION_CODE STRING,
  START_DATE TIMESTAMP,
  END_DATE TIMESTAMP,
  ACCOUNT_HOLDER_NAME_ALT STRING,
  ACCOUNT_HOLDER_NAME STRING,
  CASHFLOW_DISPLAY_ORDER DECIMAL(15, 0),
  POOLED_FLAG STRING,
  MIN_TARGET_BALANCE DECIMAL(28, 10),
  MAX_TARGET_BALANCE DECIMAL(28, 10),
  EFT_USER_NUM STRING,
  MASKED_ACCOUNT_NUM STRING,
  MASKED_IBAN STRING,
  INTEREST_SCHEDULE_ID DECIMAL(15, 0),
  CASHPOOL_MIN_PAYMENT_AMT DECIMAL(28, 10),
  CASHPOOL_MIN_RECEIPT_AMT DECIMAL(28, 10),
  CASHPOOL_ROUND_FACTOR DECIMAL(28, 10),
  CASHPOOL_ROUND_RULE STRING,
  CE_AMOUNT_TOLERANCE DECIMAL(28, 10),
  CE_PERCENT_TOLERANCE DECIMAL(28, 10),
  ASSET_CODE_COMBINATION_ID DECIMAL(15, 0),
  CASH_CLEARING_CCID DECIMAL(15, 0),
  BANK_CHARGES_CCID DECIMAL(15, 0),
  BANK_ERRORS_CCID DECIMAL(15, 0),
  OBJECT_VERSION_NUMBER DECIMAL(15, 0),
  NETTING_ACCT_FLAG STRING,
  POOL_PAYMENT_METHOD_CODE STRING,
  POOL_BANK_CHARGE_BEARER_CODE STRING,
  POOL_PAYMENT_REASON_CODE STRING,
  POOL_PAYMENT_REASON_COMMENTS STRING,
  POOL_REMITTANCE_MESSAGE1 STRING,
  POOL_REMITTANCE_MESSAGE2 STRING,
  POOL_REMITTANCE_MESSAGE3 STRING,
  FX_CHARGE_CCID DECIMAL(15, 0),
  BANK_ACCOUNT_NUM_ELECTRONIC STRING,
  STMT_LINE_FLOAT_HANDLING_FLAG STRING,
  AUTORECON_AP_MATCHING_ORDER STRING,
  AUTORECON_AR_MATCHING_ORDER STRING,
  RECON_FOREIGN_BANK_XRATE_TYPE STRING,
  RECON_FOR_BANK_XRATE_DATE_TYPE STRING,
  RECON_ENABLE_OI_FLAG STRING,
  RECON_OI_FLOAT_STATUS STRING,
  RECON_OI_CLEARED_STATUS STRING,
  RECON_OI_MATCHING_CODE STRING,
  RECON_OI_AMOUNT_TOLERANCE DECIMAL(28, 10),
  RECON_OI_PERCENT_TOLERANCE DECIMAL(28, 10),
  MANUAL_RECON_AMOUNT_TOLERANCE DECIMAL(28, 10),
  MANUAL_RECON_PERCENT_TOLERANCE DECIMAL(28, 10),
  RECON_AP_FOREIGN_DIFF_HANDLING STRING,
  RECON_AR_FOREIGN_DIFF_HANDLING STRING,
  RECON_CE_FOREIGN_DIFF_HANDLING STRING,
  RECON_AP_TOLERANCE_DIFF_ACCT STRING,
  RECON_CE_TOLERANCE_DIFF_ACCT STRING,
  XTR_BANK_ACCOUNT_REFERENCE STRING,
  AUTORECON_AP_MATCHING_ORDER2 STRING,
  AUTORECON_AR_MATCHING_ORDER2 STRING,
  AUTORECON_AR_MATCHING_ORDER3 STRING,
  AUTORECON_AR_MATCHING_ORDER4 STRING,
  AUTORECON_AR_MATCHING_ORDER5 STRING,
  FED_DO_SYMBOL STRING,
  FED_DUNS_NUM STRING,
  GAIN_CODE_COMBINATION_ID DECIMAL(15, 0),
  LOSS_CODE_COMBINATION_ID DECIMAL(15, 0),
  SEARCH_BY_PSON STRING,
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.CE_BANK_ACCOUNTS (
  BANK_ACCOUNT_ID,
  BANK_ACCOUNT_NAME,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_LOGIN,
  CREATION_DATE,
  CREATED_BY,
  BANK_ACCOUNT_NUM,
  BANK_BRANCH_ID,
  BANK_ID,
  CURRENCY_CODE,
  DESCRIPTION,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  CHECK_DIGITS,
  BANK_ACCOUNT_NAME_ALT,
  ACCOUNT_HOLDER_ID,
  EFT_REQUESTER_IDENTIFIER,
  SECONDARY_ACCOUNT_REFERENCE,
  ACCOUNT_SUFFIX,
  DESCRIPTION_CODE1,
  DESCRIPTION_CODE2,
  IBAN_NUMBER,
  SHORT_ACCOUNT_NAME,
  ACCOUNT_OWNER_PARTY_ID,
  ACCOUNT_OWNER_ORG_ID,
  ACCOUNT_CLASSIFICATION,
  AP_USE_ALLOWED_FLAG,
  AR_USE_ALLOWED_FLAG,
  XTR_USE_ALLOWED_FLAG,
  PAY_USE_ALLOWED_FLAG,
  MULTI_CURRENCY_ALLOWED_FLAG,
  PAYMENT_MULTI_CURRENCY_FLAG,
  RECEIPT_MULTI_CURRENCY_FLAG,
  ZERO_AMOUNT_ALLOWED,
  MAX_OUTLAY,
  MAX_CHECK_AMOUNT,
  MIN_CHECK_AMOUNT,
  AP_AMOUNT_TOLERANCE,
  AR_AMOUNT_TOLERANCE,
  XTR_AMOUNT_TOLERANCE,
  PAY_AMOUNT_TOLERANCE,
  AP_PERCENT_TOLERANCE,
  AR_PERCENT_TOLERANCE,
  XTR_PERCENT_TOLERANCE,
  PAY_PERCENT_TOLERANCE,
  BANK_ACCOUNT_TYPE,
  AGENCY_LOCATION_CODE,
  START_DATE,
  END_DATE,
  ACCOUNT_HOLDER_NAME_ALT,
  ACCOUNT_HOLDER_NAME,
  CASHFLOW_DISPLAY_ORDER,
  POOLED_FLAG,
  MIN_TARGET_BALANCE,
  MAX_TARGET_BALANCE,
  EFT_USER_NUM,
  MASKED_ACCOUNT_NUM,
  MASKED_IBAN,
  INTEREST_SCHEDULE_ID,
  CASHPOOL_MIN_PAYMENT_AMT,
  CASHPOOL_MIN_RECEIPT_AMT,
  CASHPOOL_ROUND_FACTOR,
  CASHPOOL_ROUND_RULE,
  CE_AMOUNT_TOLERANCE,
  CE_PERCENT_TOLERANCE,
  ASSET_CODE_COMBINATION_ID,
  CASH_CLEARING_CCID,
  BANK_CHARGES_CCID,
  BANK_ERRORS_CCID,
  OBJECT_VERSION_NUMBER,
  NETTING_ACCT_FLAG,
  POOL_PAYMENT_METHOD_CODE,
  POOL_BANK_CHARGE_BEARER_CODE,
  POOL_PAYMENT_REASON_CODE,
  POOL_PAYMENT_REASON_COMMENTS,
  POOL_REMITTANCE_MESSAGE1,
  POOL_REMITTANCE_MESSAGE2,
  POOL_REMITTANCE_MESSAGE3,
  FX_CHARGE_CCID,
  BANK_ACCOUNT_NUM_ELECTRONIC,
  STMT_LINE_FLOAT_HANDLING_FLAG,
  AUTORECON_AP_MATCHING_ORDER,
  AUTORECON_AR_MATCHING_ORDER,
  RECON_FOREIGN_BANK_XRATE_TYPE,
  RECON_FOR_BANK_XRATE_DATE_TYPE,
  RECON_ENABLE_OI_FLAG,
  RECON_OI_FLOAT_STATUS,
  RECON_OI_CLEARED_STATUS,
  RECON_OI_MATCHING_CODE,
  RECON_OI_AMOUNT_TOLERANCE,
  RECON_OI_PERCENT_TOLERANCE,
  MANUAL_RECON_AMOUNT_TOLERANCE,
  MANUAL_RECON_PERCENT_TOLERANCE,
  RECON_AP_FOREIGN_DIFF_HANDLING,
  RECON_AR_FOREIGN_DIFF_HANDLING,
  RECON_CE_FOREIGN_DIFF_HANDLING,
  RECON_AP_TOLERANCE_DIFF_ACCT,
  RECON_CE_TOLERANCE_DIFF_ACCT,
  XTR_BANK_ACCOUNT_REFERENCE,
  AUTORECON_AP_MATCHING_ORDER2,
  AUTORECON_AR_MATCHING_ORDER2,
  AUTORECON_AR_MATCHING_ORDER3,
  AUTORECON_AR_MATCHING_ORDER4,
  AUTORECON_AR_MATCHING_ORDER5,
  FED_DO_SYMBOL,
  FED_DUNS_NUM,
  GAIN_CODE_COMBINATION_ID,
  LOSS_CODE_COMBINATION_ID,
  SEARCH_BY_PSON,
  KCA_OPERATION,
  IS_DELETED_FLG,
  KCA_SEQ_ID,
  kca_seq_date
)
(
  SELECT
    BANK_ACCOUNT_ID,
    BANK_ACCOUNT_NAME,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    LAST_UPDATE_LOGIN,
    CREATION_DATE,
    CREATED_BY,
    BANK_ACCOUNT_NUM,
    BANK_BRANCH_ID,
    BANK_ID,
    CURRENCY_CODE,
    DESCRIPTION,
    ATTRIBUTE_CATEGORY,
    ATTRIBUTE1,
    ATTRIBUTE2,
    ATTRIBUTE3,
    ATTRIBUTE4,
    ATTRIBUTE5,
    ATTRIBUTE6,
    ATTRIBUTE7,
    ATTRIBUTE8,
    ATTRIBUTE9,
    ATTRIBUTE10,
    ATTRIBUTE11,
    ATTRIBUTE12,
    ATTRIBUTE13,
    ATTRIBUTE14,
    ATTRIBUTE15,
    REQUEST_ID,
    PROGRAM_APPLICATION_ID,
    PROGRAM_ID,
    PROGRAM_UPDATE_DATE,
    CHECK_DIGITS,
    BANK_ACCOUNT_NAME_ALT,
    ACCOUNT_HOLDER_ID,
    EFT_REQUESTER_IDENTIFIER,
    SECONDARY_ACCOUNT_REFERENCE,
    ACCOUNT_SUFFIX,
    DESCRIPTION_CODE1,
    DESCRIPTION_CODE2,
    IBAN_NUMBER,
    SHORT_ACCOUNT_NAME,
    ACCOUNT_OWNER_PARTY_ID,
    ACCOUNT_OWNER_ORG_ID,
    ACCOUNT_CLASSIFICATION,
    AP_USE_ALLOWED_FLAG,
    AR_USE_ALLOWED_FLAG,
    XTR_USE_ALLOWED_FLAG,
    PAY_USE_ALLOWED_FLAG,
    MULTI_CURRENCY_ALLOWED_FLAG,
    PAYMENT_MULTI_CURRENCY_FLAG,
    RECEIPT_MULTI_CURRENCY_FLAG,
    ZERO_AMOUNT_ALLOWED,
    MAX_OUTLAY,
    MAX_CHECK_AMOUNT,
    MIN_CHECK_AMOUNT,
    AP_AMOUNT_TOLERANCE,
    AR_AMOUNT_TOLERANCE,
    XTR_AMOUNT_TOLERANCE,
    PAY_AMOUNT_TOLERANCE,
    AP_PERCENT_TOLERANCE,
    AR_PERCENT_TOLERANCE,
    XTR_PERCENT_TOLERANCE,
    PAY_PERCENT_TOLERANCE,
    BANK_ACCOUNT_TYPE,
    AGENCY_LOCATION_CODE,
    START_DATE,
    END_DATE,
    ACCOUNT_HOLDER_NAME_ALT,
    ACCOUNT_HOLDER_NAME,
    CASHFLOW_DISPLAY_ORDER,
    POOLED_FLAG,
    MIN_TARGET_BALANCE,
    MAX_TARGET_BALANCE,
    EFT_USER_NUM,
    MASKED_ACCOUNT_NUM,
    MASKED_IBAN,
    INTEREST_SCHEDULE_ID,
    CASHPOOL_MIN_PAYMENT_AMT,
    CASHPOOL_MIN_RECEIPT_AMT,
    CASHPOOL_ROUND_FACTOR,
    CASHPOOL_ROUND_RULE,
    CE_AMOUNT_TOLERANCE,
    CE_PERCENT_TOLERANCE,
    ASSET_CODE_COMBINATION_ID,
    CASH_CLEARING_CCID,
    BANK_CHARGES_CCID,
    BANK_ERRORS_CCID,
    OBJECT_VERSION_NUMBER,
    NETTING_ACCT_FLAG,
    POOL_PAYMENT_METHOD_CODE,
    POOL_BANK_CHARGE_BEARER_CODE,
    POOL_PAYMENT_REASON_CODE,
    POOL_PAYMENT_REASON_COMMENTS,
    POOL_REMITTANCE_MESSAGE1,
    POOL_REMITTANCE_MESSAGE2,
    POOL_REMITTANCE_MESSAGE3,
    FX_CHARGE_CCID,
    BANK_ACCOUNT_NUM_ELECTRONIC,
    STMT_LINE_FLOAT_HANDLING_FLAG,
    AUTORECON_AP_MATCHING_ORDER,
    AUTORECON_AR_MATCHING_ORDER,
    RECON_FOREIGN_BANK_XRATE_TYPE,
    RECON_FOR_BANK_XRATE_DATE_TYPE,
    RECON_ENABLE_OI_FLAG,
    RECON_OI_FLOAT_STATUS,
    RECON_OI_CLEARED_STATUS,
    RECON_OI_MATCHING_CODE,
    RECON_OI_AMOUNT_TOLERANCE,
    RECON_OI_PERCENT_TOLERANCE,
    MANUAL_RECON_AMOUNT_TOLERANCE,
    MANUAL_RECON_PERCENT_TOLERANCE,
    RECON_AP_FOREIGN_DIFF_HANDLING,
    RECON_AR_FOREIGN_DIFF_HANDLING,
    RECON_CE_FOREIGN_DIFF_HANDLING,
    RECON_AP_TOLERANCE_DIFF_ACCT,
    RECON_CE_TOLERANCE_DIFF_ACCT,
    XTR_BANK_ACCOUNT_REFERENCE,
    AUTORECON_AP_MATCHING_ORDER2,
    AUTORECON_AR_MATCHING_ORDER2,
    AUTORECON_AR_MATCHING_ORDER3,
    AUTORECON_AR_MATCHING_ORDER4,
    AUTORECON_AR_MATCHING_ORDER5,
    FED_DO_SYMBOL,
    FED_DUNS_NUM,
    GAIN_CODE_COMBINATION_ID,
    LOSS_CODE_COMBINATION_ID,
    SEARCH_BY_PSON,
    KCA_OPERATION,
    'N' AS IS_DELETED_FLG,
    CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
    kca_seq_date
  FROM bronze_bec_ods_stg.CE_BANK_ACCOUNTS
);
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'ce_bank_accounts';