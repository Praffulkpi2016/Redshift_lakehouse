DROP table IF EXISTS silver_bec_ods.ap_supplier_sites_all;
CREATE TABLE IF NOT EXISTS silver_bec_ods.ap_supplier_sites_all (
  vendor_site_id DECIMAL(15, 0),
  last_update_date TIMESTAMP,
  last_updated_by DECIMAL(15, 0),
  vendor_id DECIMAL(15, 0),
  vendor_site_code STRING,
  vendor_site_code_alt STRING,
  last_update_login DECIMAL(15, 0),
  creation_date TIMESTAMP,
  created_by DECIMAL(15, 0),
  purchasing_site_flag STRING,
  rfq_only_site_flag STRING,
  pay_site_flag STRING,
  attention_ar_flag STRING,
  address_line1 STRING,
  address_lines_alt STRING,
  address_line2 STRING,
  address_line3 STRING,
  city STRING,
  state STRING,
  zip STRING,
  province STRING,
  country STRING,
  area_code STRING,
  phone STRING,
  customer_num STRING,
  ship_to_location_id DECIMAL(15, 0),
  bill_to_location_id DECIMAL(15, 0),
  ship_via_lookup_code STRING,
  freight_terms_lookup_code STRING,
  fob_lookup_code STRING,
  inactive_date TIMESTAMP,
  fax STRING,
  fax_area_code STRING,
  telex STRING,
  payment_method_lookup_code STRING,
  bank_account_name STRING,
  bank_account_num STRING,
  bank_num STRING,
  bank_account_type STRING,
  terms_date_basis STRING,
  current_catalog_num STRING,
  vat_code STRING,
  distribution_set_id DECIMAL(15, 0),
  accts_pay_code_combination_id DECIMAL(15, 0),
  prepay_code_combination_id DECIMAL(15, 0),
  pay_group_lookup_code STRING,
  payment_priority DECIMAL(15, 0),
  terms_id DECIMAL(15, 0),
  invoice_amount_limit DECIMAL(28, 10),
  pay_date_basis_lookup_code STRING,
  always_take_disc_flag STRING,
  invoice_currency_code STRING,
  payment_currency_code STRING,
  hold_all_payments_flag STRING,
  hold_future_payments_flag STRING,
  hold_reason STRING,
  hold_unmatched_invoices_flag STRING,
  ap_tax_rounding_rule STRING,
  auto_tax_calc_flag STRING,
  auto_tax_calc_override STRING,
  amount_includes_tax_flag STRING,
  exclusive_payment_flag STRING,
  tax_reporting_site_flag STRING,
  attribute_category STRING,
  attribute1 STRING,
  attribute2 STRING,
  attribute3 STRING,
  attribute4 STRING,
  attribute5 STRING,
  attribute6 STRING,
  attribute7 STRING,
  attribute8 STRING,
  attribute9 STRING,
  attribute10 STRING,
  attribute11 STRING,
  attribute12 STRING,
  attribute13 STRING,
  attribute14 STRING,
  attribute15 STRING,
  request_id DECIMAL(15, 0),
  program_application_id DECIMAL(15, 0),
  program_id DECIMAL(15, 0),
  program_update_date TIMESTAMP,
  validation_number DECIMAL(15, 0),
  exclude_freight_from_discount STRING,
  vat_registration_num STRING,
  offset_vat_code STRING,
  org_id DECIMAL(15, 0),
  check_digits STRING,
  bank_number STRING,
  address_line4 STRING,
  county STRING,
  address_style STRING,
  language STRING,
  allow_awt_flag STRING,
  awt_group_id DECIMAL(15, 0),
  global_attribute1 STRING,
  global_attribute2 STRING,
  global_attribute3 STRING,
  global_attribute4 STRING,
  global_attribute5 STRING,
  global_attribute6 STRING,
  global_attribute7 STRING,
  global_attribute8 STRING,
  global_attribute9 STRING,
  global_attribute10 STRING,
  global_attribute11 STRING,
  global_attribute12 STRING,
  global_attribute13 STRING,
  global_attribute14 STRING,
  global_attribute15 STRING,
  global_attribute16 STRING,
  global_attribute17 STRING,
  global_attribute18 STRING,
  global_attribute19 STRING,
  global_attribute20 STRING,
  global_attribute_category STRING,
  edi_transaction_handling STRING,
  edi_id_number STRING,
  edi_payment_method STRING,
  edi_payment_format STRING,
  edi_remittance_method STRING,
  bank_charge_bearer STRING,
  edi_remittance_instruction STRING,
  bank_branch_type STRING,
  pay_on_code STRING,
  default_pay_site_id DECIMAL(15, 0),
  pay_on_receipt_summary_code STRING,
  tp_header_id DECIMAL(15, 0),
  ece_tp_location_code STRING,
  pcard_site_flag STRING,
  match_option STRING,
  country_of_origin_code STRING,
  future_dated_payment_ccid DECIMAL(15, 0),
  create_debit_memo_flag STRING,
  offset_tax_flag STRING,
  supplier_notif_method STRING,
  email_address STRING,
  remittance_email STRING,
  primary_pay_site_flag STRING,
  shipping_control STRING,
  selling_company_identifier STRING,
  gapless_inv_num_flag STRING,
  duns_number STRING,
  tolerance_id DECIMAL(15, 0),
  location_id DECIMAL(15, 0),
  party_site_id DECIMAL(15, 0),
  services_tolerance_id DECIMAL(15, 0),
  retainage_rate DECIMAL(28, 10),
  tca_sync_state STRING,
  tca_sync_province STRING,
  tca_sync_county STRING,
  tca_sync_city STRING,
  tca_sync_zip STRING,
  tca_sync_country STRING,
  pay_awt_group_id DECIMAL(15, 0),
  CAGE_CODE STRING,
  LEGAL_BUSINESS_NAME STRING,
  DOING_BUS_AS_NAME STRING,
  DIVISION_NAME STRING,
  SMALL_BUSINESS_CODE STRING,
  CCR_COMMENTS STRING,
  DEBARMENT_START_DATE TIMESTAMP,
  DEBARMENT_END_DATE TIMESTAMP,
  ACK_LEAD_TIME DECIMAL(28, 10),
  `VAT_REGISTRATION_NUM#1` STRING,
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.ap_supplier_sites_all (
  vendor_site_id,
  last_update_date,
  last_updated_by,
  vendor_id,
  vendor_site_code,
  vendor_site_code_alt,
  last_update_login,
  creation_date,
  created_by,
  purchasing_site_flag,
  rfq_only_site_flag,
  pay_site_flag,
  attention_ar_flag,
  address_line1,
  address_lines_alt,
  address_line2,
  address_line3,
  city,
  state,
  zip,
  province,
  country,
  area_code,
  phone,
  customer_num,
  ship_to_location_id,
  bill_to_location_id,
  ship_via_lookup_code,
  freight_terms_lookup_code,
  fob_lookup_code,
  inactive_date,
  fax,
  fax_area_code,
  telex,
  payment_method_lookup_code,
  bank_account_name,
  bank_account_num,
  bank_num,
  bank_account_type,
  terms_date_basis,
  current_catalog_num,
  vat_code,
  distribution_set_id,
  accts_pay_code_combination_id,
  prepay_code_combination_id,
  pay_group_lookup_code,
  payment_priority,
  terms_id,
  invoice_amount_limit,
  pay_date_basis_lookup_code,
  always_take_disc_flag,
  invoice_currency_code,
  payment_currency_code,
  hold_all_payments_flag,
  hold_future_payments_flag,
  hold_reason,
  hold_unmatched_invoices_flag,
  ap_tax_rounding_rule,
  auto_tax_calc_flag,
  auto_tax_calc_override,
  amount_includes_tax_flag,
  exclusive_payment_flag,
  tax_reporting_site_flag,
  attribute_category,
  attribute1,
  attribute2,
  attribute3,
  attribute4,
  attribute5,
  attribute6,
  attribute7,
  attribute8,
  attribute9,
  attribute10,
  attribute11,
  attribute12,
  attribute13,
  attribute14,
  attribute15,
  request_id,
  program_application_id,
  program_id,
  program_update_date,
  validation_number,
  exclude_freight_from_discount,
  vat_registration_num,
  offset_vat_code,
  org_id,
  check_digits,
  bank_number,
  address_line4,
  county,
  address_style,
  language,
  allow_awt_flag,
  awt_group_id,
  global_attribute1,
  global_attribute2,
  global_attribute3,
  global_attribute4,
  global_attribute5,
  global_attribute6,
  global_attribute7,
  global_attribute8,
  global_attribute9,
  global_attribute10,
  global_attribute11,
  global_attribute12,
  global_attribute13,
  global_attribute14,
  global_attribute15,
  global_attribute16,
  global_attribute17,
  global_attribute18,
  global_attribute19,
  global_attribute20,
  global_attribute_category,
  edi_transaction_handling,
  edi_id_number,
  edi_payment_method,
  edi_payment_format,
  edi_remittance_method,
  bank_charge_bearer,
  edi_remittance_instruction,
  bank_branch_type,
  pay_on_code,
  default_pay_site_id,
  pay_on_receipt_summary_code,
  tp_header_id,
  ece_tp_location_code,
  pcard_site_flag,
  match_option,
  country_of_origin_code,
  future_dated_payment_ccid,
  create_debit_memo_flag,
  offset_tax_flag,
  supplier_notif_method,
  email_address,
  remittance_email,
  primary_pay_site_flag,
  shipping_control,
  selling_company_identifier,
  gapless_inv_num_flag,
  duns_number,
  tolerance_id,
  location_id,
  party_site_id,
  services_tolerance_id,
  retainage_rate,
  tca_sync_state,
  tca_sync_province,
  tca_sync_county,
  tca_sync_city,
  tca_sync_zip,
  tca_sync_country,
  pay_awt_group_id,
  cage_code,
  legal_business_name,
  doing_bus_as_name,
  division_name,
  small_business_code,
  ccr_comments,
  debarment_start_date,
  debarment_end_date,
  ack_lead_time,
  `vat_registration_num#1`,
  KCA_OPERATION,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
(
  SELECT
    vendor_site_id,
    last_update_date,
    last_updated_by,
    vendor_id,
    vendor_site_code,
    vendor_site_code_alt,
    last_update_login,
    creation_date,
    created_by,
    purchasing_site_flag,
    rfq_only_site_flag,
    pay_site_flag,
    attention_ar_flag,
    address_line1,
    address_lines_alt,
    address_line2,
    address_line3,
    city,
    state,
    zip,
    province,
    country,
    area_code,
    phone,
    customer_num,
    ship_to_location_id,
    bill_to_location_id,
    ship_via_lookup_code,
    freight_terms_lookup_code,
    fob_lookup_code,
    inactive_date,
    fax,
    fax_area_code,
    telex,
    payment_method_lookup_code,
    bank_account_name,
    bank_account_num,
    bank_num,
    bank_account_type,
    terms_date_basis,
    current_catalog_num,
    vat_code,
    distribution_set_id,
    accts_pay_code_combination_id,
    prepay_code_combination_id,
    pay_group_lookup_code,
    payment_priority,
    terms_id,
    invoice_amount_limit,
    pay_date_basis_lookup_code,
    always_take_disc_flag,
    invoice_currency_code,
    payment_currency_code,
    hold_all_payments_flag,
    hold_future_payments_flag,
    hold_reason,
    hold_unmatched_invoices_flag,
    ap_tax_rounding_rule,
    auto_tax_calc_flag,
    auto_tax_calc_override,
    amount_includes_tax_flag,
    exclusive_payment_flag,
    tax_reporting_site_flag,
    attribute_category,
    attribute1,
    attribute2,
    attribute3,
    attribute4,
    attribute5,
    attribute6,
    attribute7,
    attribute8,
    attribute9,
    attribute10,
    attribute11,
    attribute12,
    attribute13,
    attribute14,
    attribute15,
    request_id,
    program_application_id,
    program_id,
    program_update_date,
    validation_number,
    exclude_freight_from_discount,
    vat_registration_num,
    offset_vat_code,
    org_id,
    check_digits,
    bank_number,
    address_line4,
    county,
    address_style,
    language,
    allow_awt_flag,
    awt_group_id,
    global_attribute1,
    global_attribute2,
    global_attribute3,
    global_attribute4,
    global_attribute5,
    global_attribute6,
    global_attribute7,
    global_attribute8,
    global_attribute9,
    global_attribute10,
    global_attribute11,
    global_attribute12,
    global_attribute13,
    global_attribute14,
    global_attribute15,
    global_attribute16,
    global_attribute17,
    global_attribute18,
    global_attribute19,
    global_attribute20,
    global_attribute_category,
    edi_transaction_handling,
    edi_id_number,
    edi_payment_method,
    edi_payment_format,
    edi_remittance_method,
    bank_charge_bearer,
    edi_remittance_instruction,
    bank_branch_type,
    pay_on_code,
    default_pay_site_id,
    pay_on_receipt_summary_code,
    tp_header_id,
    ece_tp_location_code,
    pcard_site_flag,
    match_option,
    country_of_origin_code,
    future_dated_payment_ccid,
    create_debit_memo_flag,
    offset_tax_flag,
    supplier_notif_method,
    email_address,
    remittance_email,
    primary_pay_site_flag,
    shipping_control,
    selling_company_identifier,
    gapless_inv_num_flag,
    duns_number,
    tolerance_id,
    location_id,
    party_site_id,
    services_tolerance_id,
    retainage_rate,
    tca_sync_state,
    tca_sync_province,
    tca_sync_county,
    tca_sync_city,
    tca_sync_zip,
    tca_sync_country,
    pay_awt_group_id,
    CAGE_CODE,
    LEGAL_BUSINESS_NAME,
    DOING_BUS_AS_NAME,
    DIVISION_NAME,
    SMALL_BUSINESS_CODE,
    CCR_COMMENTS,
    DEBARMENT_START_DATE,
    DEBARMENT_END_DATE,
    ACK_LEAD_TIME,
    `VAT_REGISTRATION_NUM#1`,
    KCA_OPERATION,
    'N' AS IS_DELETED_FLG,
    CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
    kca_seq_date
  FROM bronze_bec_ods_stg.ap_supplier_sites_all
);
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'ap_supplier_sites_all';