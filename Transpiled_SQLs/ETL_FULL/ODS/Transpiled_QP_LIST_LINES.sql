DROP TABLE IF EXISTS silver_bec_ods.QP_LIST_LINES;
CREATE TABLE IF NOT EXISTS silver_bec_ods.QP_LIST_LINES (
  list_line_id DECIMAL(15, 0),
  creation_date TIMESTAMP,
  created_by DECIMAL(15, 0),
  last_update_date TIMESTAMP,
  last_updated_by DECIMAL(15, 0),
  last_update_login DECIMAL(15, 0),
  program_application_id DECIMAL(15, 0),
  program_id DECIMAL(15, 0),
  program_update_date TIMESTAMP,
  request_id DECIMAL(15, 0),
  list_header_id DECIMAL(15, 0),
  list_line_type_code STRING,
  start_date_active TIMESTAMP,
  end_date_active TIMESTAMP,
  automatic_flag STRING,
  modifier_level_code STRING,
  price_by_formula_id DECIMAL(15, 0),
  list_price DECIMAL(28, 10),
  list_price_uom_code STRING,
  primary_uom_flag STRING,
  inventory_item_id DECIMAL(15, 0),
  organization_id DECIMAL(15, 0),
  related_item_id DECIMAL(15, 0),
  relationship_type_id DECIMAL(15, 0),
  substitution_context STRING,
  substitution_attribute STRING,
  substitution_value STRING,
  revision STRING,
  revision_date TIMESTAMP,
  revision_reason_code STRING,
  price_break_type_code STRING,
  percent_price DECIMAL(28, 10),
  number_effective_periods DECIMAL(15, 0),
  effective_period_uom STRING,
  arithmetic_operator STRING,
  operand DECIMAL(28, 10),
  override_flag STRING,
  print_on_invoice_flag STRING,
  rebate_transaction_type_code STRING,
  base_qty DECIMAL(28, 10),
  base_uom_code STRING,
  accrual_qty DECIMAL(28, 10),
  accrual_uom_code STRING,
  estim_accrual_rate DECIMAL(28, 10),
  comments STRING,
  generate_using_formula_id DECIMAL(15, 0),
  reprice_flag STRING,
  list_line_no STRING,
  estim_gl_value DECIMAL(28, 10),
  benefit_price_list_line_id DECIMAL(15, 0),
  expiration_period_start_date TIMESTAMP,
  number_expiration_periods DECIMAL(28, 10),
  expiration_period_uom STRING,
  expiration_date TIMESTAMP,
  accrual_flag STRING,
  pricing_phase_id DECIMAL(15, 0),
  pricing_group_sequence DECIMAL(28, 10),
  incompatibility_grp_code STRING,
  product_precedence DECIMAL(15, 0),
  proration_type_code STRING,
  accrual_conversion_rate DECIMAL(28, 10),
  benefit_qty DECIMAL(28, 10),
  benefit_uom_code STRING,
  recurring_flag STRING,
  benefit_limit DECIMAL(28, 10),
  charge_type_code STRING,
  charge_subtype_code STRING,
  context STRING,
  attribute1 STRING,
  attribute2 STRING,
  attribute3 STRING,
  attribute4 STRING,
  attribute5 STRING,
  attribute6 STRING,
  attribute7 STRING,
  attribute8 STRING,
  attribute9 STRING,
  attribute10 STRING,
  attribute11 STRING,
  attribute12 STRING,
  attribute13 STRING,
  attribute14 STRING,
  attribute15 STRING,
  include_on_returns_flag STRING,
  qualification_ind DECIMAL(15, 0),
  limit_exists_flag STRING,
  group_count DECIMAL(28, 10),
  net_amount_flag STRING,
  recurring_value DECIMAL(28, 10),
  accum_context STRING,
  accum_attribute STRING,
  accum_attr_run_src_flag STRING,
  customer_item_id DECIMAL(15, 0),
  break_uom_code STRING,
  break_uom_context STRING,
  break_uom_attribute STRING,
  pattern_id DECIMAL(15, 0),
  product_uom_code STRING,
  pricing_attribute_count DECIMAL(28, 10),
  hash_key STRING,
  cache_key STRING,
  orig_sys_line_ref STRING,
  orig_sys_header_ref STRING,
  continuous_price_break_flag STRING,
  eq_flag STRING,
  currency_header_id DECIMAL(15, 0),
  null_other_oprt_count DECIMAL(28, 10),
  pte_code STRING,
  source_system_code STRING,
  service_duration DECIMAL(28, 10),
  service_period STRING,
  subscription_service_flag STRING,
  subscription_template_id DECIMAL(15, 0),
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.QP_LIST_LINES (
  list_line_id,
  creation_date,
  created_by,
  last_update_date,
  last_updated_by,
  last_update_login,
  program_application_id,
  program_id,
  program_update_date,
  request_id,
  list_header_id,
  list_line_type_code,
  start_date_active,
  end_date_active,
  automatic_flag,
  modifier_level_code,
  price_by_formula_id,
  list_price,
  list_price_uom_code,
  primary_uom_flag,
  inventory_item_id,
  organization_id,
  related_item_id,
  relationship_type_id,
  substitution_context,
  substitution_attribute,
  substitution_value,
  revision,
  revision_date,
  revision_reason_code,
  price_break_type_code,
  percent_price,
  number_effective_periods,
  effective_period_uom,
  arithmetic_operator,
  operand,
  override_flag,
  print_on_invoice_flag,
  rebate_transaction_type_code,
  base_qty,
  base_uom_code,
  accrual_qty,
  accrual_uom_code,
  estim_accrual_rate,
  comments,
  generate_using_formula_id,
  reprice_flag,
  list_line_no,
  estim_gl_value,
  benefit_price_list_line_id,
  expiration_period_start_date,
  number_expiration_periods,
  expiration_period_uom,
  expiration_date,
  accrual_flag,
  pricing_phase_id,
  pricing_group_sequence,
  incompatibility_grp_code,
  product_precedence,
  proration_type_code,
  accrual_conversion_rate,
  benefit_qty,
  benefit_uom_code,
  recurring_flag,
  benefit_limit,
  charge_type_code,
  charge_subtype_code,
  context,
  attribute1,
  attribute2,
  attribute3,
  attribute4,
  attribute5,
  attribute6,
  attribute7,
  attribute8,
  attribute9,
  attribute10,
  attribute11,
  attribute12,
  attribute13,
  attribute14,
  attribute15,
  include_on_returns_flag,
  qualification_ind,
  limit_exists_flag,
  group_count,
  net_amount_flag,
  recurring_value,
  accum_context,
  accum_attribute,
  accum_attr_run_src_flag,
  customer_item_id,
  break_uom_code,
  break_uom_context,
  break_uom_attribute,
  pattern_id,
  product_uom_code,
  pricing_attribute_count,
  hash_key,
  cache_key,
  orig_sys_line_ref,
  orig_sys_header_ref,
  continuous_price_break_flag,
  eq_flag,
  currency_header_id,
  null_other_oprt_count,
  pte_code,
  source_system_code,
  service_duration,
  service_period,
  subscription_service_flag,
  subscription_template_id,
  kca_operation,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
SELECT
  list_line_id,
  creation_date,
  created_by,
  last_update_date,
  last_updated_by,
  last_update_login,
  program_application_id,
  program_id,
  program_update_date,
  request_id,
  list_header_id,
  list_line_type_code,
  start_date_active,
  end_date_active,
  automatic_flag,
  modifier_level_code,
  price_by_formula_id,
  list_price,
  list_price_uom_code,
  primary_uom_flag,
  inventory_item_id,
  organization_id,
  related_item_id,
  relationship_type_id,
  substitution_context,
  substitution_attribute,
  substitution_value,
  revision,
  revision_date,
  revision_reason_code,
  price_break_type_code,
  percent_price,
  number_effective_periods,
  effective_period_uom,
  arithmetic_operator,
  operand,
  override_flag,
  print_on_invoice_flag,
  rebate_transaction_type_code,
  base_qty,
  base_uom_code,
  accrual_qty,
  accrual_uom_code,
  estim_accrual_rate,
  comments,
  generate_using_formula_id,
  reprice_flag,
  list_line_no,
  estim_gl_value,
  benefit_price_list_line_id,
  expiration_period_start_date,
  number_expiration_periods,
  expiration_period_uom,
  expiration_date,
  accrual_flag,
  pricing_phase_id,
  pricing_group_sequence,
  incompatibility_grp_code,
  product_precedence,
  proration_type_code,
  accrual_conversion_rate,
  benefit_qty,
  benefit_uom_code,
  recurring_flag,
  benefit_limit,
  charge_type_code,
  charge_subtype_code,
  context,
  attribute1,
  attribute2,
  attribute3,
  attribute4,
  attribute5,
  attribute6,
  attribute7,
  attribute8,
  attribute9,
  attribute10,
  attribute11,
  attribute12,
  attribute13,
  attribute14,
  attribute15,
  include_on_returns_flag,
  qualification_ind,
  limit_exists_flag,
  group_count,
  net_amount_flag,
  recurring_value,
  accum_context,
  accum_attribute,
  accum_attr_run_src_flag,
  customer_item_id,
  break_uom_code,
  break_uom_context,
  break_uom_attribute,
  pattern_id,
  product_uom_code,
  pricing_attribute_count,
  hash_key,
  cache_key,
  orig_sys_line_ref,
  orig_sys_header_ref,
  continuous_price_break_flag,
  eq_flag,
  currency_header_id,
  null_other_oprt_count,
  pte_code,
  source_system_code,
  service_duration,
  service_period,
  subscription_service_flag,
  subscription_template_id,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.QP_LIST_LINES;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'qp_list_lines';