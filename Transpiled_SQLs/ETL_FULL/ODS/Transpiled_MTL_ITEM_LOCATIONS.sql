DROP TABLE IF EXISTS silver_bec_ods.MTL_ITEM_LOCATIONS;
CREATE TABLE IF NOT EXISTS silver_bec_ods.MTL_ITEM_LOCATIONS (
  inventory_location_id DECIMAL(15, 0),
  INV_DOCK_DOOR_ID DECIMAL(15, 0),
  INV_ORG_ID DECIMAL(15, 0),
  organization_id DECIMAL(15, 0),
  last_update_date TIMESTAMP,
  last_updated_by DECIMAL(15, 0),
  creation_date TIMESTAMP,
  created_by DECIMAL(15, 0),
  last_update_login DECIMAL(15, 0),
  description STRING,
  descriptive_text STRING,
  disable_date TIMESTAMP,
  inventory_location_type DECIMAL(15, 0),
  picking_order DECIMAL(15, 0),
  physical_location_code STRING,
  location_maximum_units DECIMAL(15, 0),
  subinventory_code STRING,
  location_weight_uom_code STRING,
  max_weight DECIMAL(28, 10),
  volume_uom_code STRING,
  max_cubic_area DECIMAL(28, 10),
  x_coordinate DECIMAL(15, 0),
  y_coordinate DECIMAL(15, 0),
  z_coordinate DECIMAL(15, 0),
  inventory_account_id DECIMAL(15, 0),
  segment1 STRING,
  segment2 STRING,
  segment3 STRING,
  segment4 STRING,
  segment5 STRING,
  segment6 STRING,
  segment7 STRING,
  segment8 STRING,
  segment9 STRING,
  segment10 STRING,
  segment11 STRING,
  segment12 STRING,
  segment13 STRING,
  segment14 STRING,
  segment15 STRING,
  segment16 STRING,
  segment17 STRING,
  segment18 STRING,
  segment19 STRING,
  segment20 STRING,
  summary_flag STRING,
  enabled_flag STRING,
  start_date_active TIMESTAMP,
  end_date_active TIMESTAMP,
  attribute_category STRING,
  attribute1 STRING,
  attribute2 STRING,
  attribute3 STRING,
  attribute4 STRING,
  attribute5 STRING,
  attribute6 STRING,
  attribute7 STRING,
  attribute8 STRING,
  attribute9 STRING,
  attribute10 STRING,
  attribute11 STRING,
  attribute12 STRING,
  attribute13 STRING,
  attribute14 STRING,
  attribute15 STRING,
  request_id DECIMAL(15, 0),
  program_application_id DECIMAL(15, 0),
  program_id DECIMAL(15, 0),
  program_update_date TIMESTAMP,
  project_id DECIMAL(15, 0),
  task_id DECIMAL(15, 0),
  physical_location_id DECIMAL(15, 0),
  pick_uom_code STRING,
  dimension_uom_code STRING,
  length DECIMAL(28, 10),
  width DECIMAL(28, 10),
  height DECIMAL(28, 10),
  locator_status DECIMAL(15, 0),
  status_id DECIMAL(15, 0),
  current_cubic_area DECIMAL(28, 10),
  available_cubic_area DECIMAL(28, 10),
  current_weight DECIMAL(28, 10),
  available_weight DECIMAL(28, 10),
  location_current_units DECIMAL(28, 10),
  location_available_units DECIMAL(15, 0),
  inventory_item_id DECIMAL(15, 0),
  suggested_cubic_area DECIMAL(28, 10),
  suggested_weight DECIMAL(28, 10),
  location_suggested_units DECIMAL(15, 0),
  empty_flag STRING,
  mixed_items_flag STRING,
  dropping_order DECIMAL(15, 0),
  availability_type DECIMAL(15, 0),
  inventory_atp_code DECIMAL(15, 0),
  reservable_type DECIMAL(15, 0),
  alias STRING,
  AREA_ROW_ID DECIMAL(15, 0),
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.MTL_ITEM_LOCATIONS (
  inventory_location_id,
  inv_dock_door_id,
  inv_org_id,
  organization_id,
  last_update_date,
  last_updated_by,
  creation_date,
  created_by,
  last_update_login,
  description,
  descriptive_text,
  disable_date,
  inventory_location_type,
  picking_order,
  physical_location_code,
  location_maximum_units,
  subinventory_code,
  location_weight_uom_code,
  max_weight,
  volume_uom_code,
  max_cubic_area,
  x_coordinate,
  y_coordinate,
  z_coordinate,
  inventory_account_id,
  segment1,
  segment2,
  segment3,
  segment4,
  segment5,
  segment6,
  segment7,
  segment8,
  segment9,
  segment10,
  segment11,
  segment12,
  segment13,
  segment14,
  segment15,
  segment16,
  segment17,
  segment18,
  segment19,
  segment20,
  summary_flag,
  enabled_flag,
  start_date_active,
  end_date_active,
  attribute_category,
  attribute1,
  attribute2,
  attribute3,
  attribute4,
  attribute5,
  attribute6,
  attribute7,
  attribute8,
  attribute9,
  attribute10,
  attribute11,
  attribute12,
  attribute13,
  attribute14,
  attribute15,
  request_id,
  program_application_id,
  program_id,
  program_update_date,
  project_id,
  task_id,
  physical_location_id,
  pick_uom_code,
  dimension_uom_code,
  length,
  width,
  height,
  locator_status,
  status_id,
  current_cubic_area,
  available_cubic_area,
  current_weight,
  available_weight,
  location_current_units,
  location_available_units,
  inventory_item_id,
  suggested_cubic_area,
  suggested_weight,
  location_suggested_units,
  empty_flag,
  mixed_items_flag,
  dropping_order,
  availability_type,
  inventory_atp_code,
  reservable_type,
  alias,
  AREA_ROW_ID,
  kca_operation,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
SELECT
  inventory_location_id,
  inv_dock_door_id,
  inv_org_id,
  organization_id,
  last_update_date,
  last_updated_by,
  creation_date,
  created_by,
  last_update_login,
  description,
  descriptive_text,
  disable_date,
  inventory_location_type,
  picking_order,
  physical_location_code,
  location_maximum_units,
  subinventory_code,
  location_weight_uom_code,
  max_weight,
  volume_uom_code,
  max_cubic_area,
  x_coordinate,
  y_coordinate,
  z_coordinate,
  inventory_account_id,
  segment1,
  segment2,
  segment3,
  segment4,
  segment5,
  segment6,
  segment7,
  segment8,
  segment9,
  segment10,
  segment11,
  segment12,
  segment13,
  segment14,
  segment15,
  segment16,
  segment17,
  segment18,
  segment19,
  segment20,
  summary_flag,
  enabled_flag,
  start_date_active,
  end_date_active,
  attribute_category,
  attribute1,
  attribute2,
  attribute3,
  attribute4,
  attribute5,
  attribute6,
  attribute7,
  attribute8,
  attribute9,
  attribute10,
  attribute11,
  attribute12,
  attribute13,
  attribute14,
  attribute15,
  request_id,
  program_application_id,
  program_id,
  program_update_date,
  project_id,
  task_id,
  physical_location_id,
  pick_uom_code,
  dimension_uom_code,
  length,
  width,
  height,
  locator_status,
  status_id,
  current_cubic_area,
  available_cubic_area,
  current_weight,
  available_weight,
  location_current_units,
  location_available_units,
  inventory_item_id,
  suggested_cubic_area,
  suggested_weight,
  location_suggested_units,
  empty_flag,
  mixed_items_flag,
  dropping_order,
  availability_type,
  inventory_atp_code,
  reservable_type,
  alias,
  AREA_ROW_ID,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.MTL_ITEM_LOCATIONS;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'mtl_item_locations';