DROP TABLE IF EXISTS silver_bec_ods.xxbec_ibom_rc_temp;
CREATE TABLE IF NOT EXISTS silver_bec_ods.xxbec_ibom_rc_temp (
  TOP_BILL_SEQUENCE_ID DECIMAL(15, 0),
  BILL_SEQUENCE_ID DECIMAL(15, 0),
  ORGANIZATION_ID DECIMAL(15, 0),
  COMPONENT_SEQUENCE_ID DECIMAL(15, 0),
  COMPONENT_ITEM_ID DECIMAL(15, 0),
  PLAN_LEVEL DECIMAL(28, 10),
  EXTENDED_QUANTITY DECIMAL(28, 10),
  SORT_ORDER STRING,
  REQUEST_ID DECIMAL(15, 0),
  PROGRAM_APPLICATION_ID DECIMAL(15, 0),
  PROGRAM_ID DECIMAL(15, 0),
  PROGRAM_UPDATE_DATE TIMESTAMP,
  GROUP_ID DECIMAL(15, 0),
  SESSION_ID DECIMAL(15, 0),
  SELECT_FLAG STRING,
  SELECT_QUANTITY DECIMAL(28, 10),
  EXTEND_COST_FLAG DECIMAL(28, 10),
  TOP_ALTERNATE_DESIGNATOR STRING,
  TOP_ITEM_ID DECIMAL(15, 0),
  CONTEXT STRING,
  attribute1 STRING,
  attribute2 STRING,
  attribute3 STRING,
  attribute4 STRING,
  attribute5 STRING,
  attribute6 STRING,
  attribute7 STRING,
  attribute8 STRING,
  attribute9 STRING,
  attribute10 STRING,
  attribute11 STRING,
  attribute12 STRING,
  attribute13 STRING,
  attribute14 STRING,
  attribute15 STRING,
  HEADER_ID DECIMAL(15, 0),
  LINE_ID DECIMAL(15, 0),
  LIST_PRICE DECIMAL(28, 10),
  SELLING_PRICE DECIMAL(28, 10),
  COMPONENT_YIELD_FACTOR DECIMAL(28, 10),
  ITEM_COST DECIMAL(28, 10),
  INCLUDE_IN_ROLLUP_FLAG DECIMAL(28, 10),
  BASED_ON_ROLLUP_FLAG DECIMAL(28, 10),
  ACTUAL_COST_TYPE_ID DECIMAL(15, 0),
  COMPONENT_QUANTITY DECIMAL(28, 10),
  SHRINKAGE_RATE DECIMAL(28, 10),
  SO_BASIS DECIMAL(28, 10),
  OPTIONAL DECIMAL(28, 10),
  MUTUALLY_EXCLUSIVE_OPTIONS DECIMAL(28, 10),
  CHECK_ATP DECIMAL(28, 10),
  SHIPPING_ALLOWED DECIMAL(28, 10),
  REQUIRED_TO_SHIP DECIMAL(28, 10),
  REQUIRED_FOR_REVENUE DECIMAL(28, 10),
  INCLUDE_ON_SHIP_DOCS DECIMAL(28, 10),
  INCLUDE_ON_BILL_DOCS DECIMAL(28, 10),
  LOW_QUANTITY DECIMAL(28, 10),
  HIGH_QUANTITY DECIMAL(28, 10),
  PICK_COMPONENTS DECIMAL(28, 10),
  PRIMARY_UOM_CODE STRING,
  PRIMARY_UNIT_OF_MEASURE STRING,
  BASE_ITEM_ID DECIMAL(15, 0),
  ATP_COMPONENTS_FLAG STRING,
  ATP_FLAG STRING,
  BOM_ITEM_TYPE DECIMAL(28, 10),
  PICK_COMPONENTS_FLAG STRING,
  REPLENISH_TO_ORDER_FLAG STRING,
  SHIPPABLE_ITEM_FLAG STRING,
  CUSTOMER_ORDER_FLAG STRING,
  INTERNAL_ORDER_FLAG STRING,
  CUSTOMER_ORDER_ENABLED_FLAG STRING,
  INTERNAL_ORDER_ENABLED_FLAG STRING,
  SO_TRANSACTIONS_FLAG STRING,
  MTL_TRANSACTIONS_ENABLED_FLAG STRING,
  STOCK_ENABLED_FLAG STRING,
  DESCRIPTION STRING,
  ASSEMBLY_ITEM_ID DECIMAL(15, 0),
  CONFIGURATOR_FLAG STRING,
  PRICE_LIST_ID DECIMAL(15, 0),
  ROUNDING_FACTOR DECIMAL(28, 10),
  PRICING_CONTEXT STRING,
  pricing_attribute1 STRING,
  pricing_attribute2 STRING,
  pricing_attribute3 STRING,
  pricing_attribute4 STRING,
  pricing_attribute5 STRING,
  pricing_attribute6 STRING,
  pricing_attribute7 STRING,
  pricing_attribute8 STRING,
  pricing_attribute9 STRING,
  pricing_attribute10 STRING,
  pricing_attribute11 STRING,
  pricing_attribute12 STRING,
  pricing_attribute13 STRING,
  pricing_attribute14 STRING,
  pricing_attribute15 STRING,
  COMPONENT_CODE STRING,
  LOOP_FLAG DECIMAL(28, 10),
  INVENTORY_ASSET_FLAG DECIMAL(28, 10),
  PLANNING_FACTOR DECIMAL(28, 10),
  OPERATION_SEQ_NUM DECIMAL(28, 10),
  PARENT_BOM_ITEM_TYPE DECIMAL(28, 10),
  WIP_SUPPLY_TYPE DECIMAL(28, 10),
  ITEM_NUM DECIMAL(28, 10),
  EFFECTIVITY_DATE TIMESTAMP,
  DISABLE_DATE TIMESTAMP,
  IMPLEMENTATION_DATE TIMESTAMP,
  SUPPLY_SUBINVENTORY STRING,
  SUPPLY_LOCATOR_ID DECIMAL(15, 0),
  COMPONENT_REMARKS STRING,
  CHANGE_NOTICE STRING,
  OPERATION_LEAD_TIME_PERCENT DECIMAL(28, 10),
  REXPLODE_FLAG DECIMAL(28, 10),
  COMMON_BILL_SEQUENCE_ID DECIMAL(15, 0),
  OPERATION_OFFSET DECIMAL(28, 10),
  CURRENT_REVISION STRING,
  LOCATOR STRING,
  FROM_END_ITEM_UNIT_NUMBER STRING,
  TO_END_ITEM_UNIT_NUMBER STRING,
  BASIS_TYPE DECIMAL(28, 10),
  kca_operation STRING,
  is_deleted_flg STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.xxbec_ibom_rc_temp (
  TOP_BILL_SEQUENCE_ID,
  BILL_SEQUENCE_ID,
  ORGANIZATION_ID,
  COMPONENT_SEQUENCE_ID,
  COMPONENT_ITEM_ID,
  PLAN_LEVEL,
  EXTENDED_QUANTITY,
  SORT_ORDER,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  GROUP_ID,
  SESSION_ID,
  SELECT_FLAG,
  SELECT_QUANTITY,
  EXTEND_COST_FLAG,
  TOP_ALTERNATE_DESIGNATOR,
  TOP_ITEM_ID,
  CONTEXT,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  HEADER_ID,
  LINE_ID,
  LIST_PRICE,
  SELLING_PRICE,
  COMPONENT_YIELD_FACTOR,
  ITEM_COST,
  INCLUDE_IN_ROLLUP_FLAG,
  BASED_ON_ROLLUP_FLAG,
  ACTUAL_COST_TYPE_ID,
  COMPONENT_QUANTITY,
  SHRINKAGE_RATE,
  SO_BASIS,
  OPTIONAL,
  MUTUALLY_EXCLUSIVE_OPTIONS,
  CHECK_ATP,
  SHIPPING_ALLOWED,
  REQUIRED_TO_SHIP,
  REQUIRED_FOR_REVENUE,
  INCLUDE_ON_SHIP_DOCS,
  INCLUDE_ON_BILL_DOCS,
  LOW_QUANTITY,
  HIGH_QUANTITY,
  PICK_COMPONENTS,
  PRIMARY_UOM_CODE,
  PRIMARY_UNIT_OF_MEASURE,
  BASE_ITEM_ID,
  ATP_COMPONENTS_FLAG,
  ATP_FLAG,
  BOM_ITEM_TYPE,
  PICK_COMPONENTS_FLAG,
  REPLENISH_TO_ORDER_FLAG,
  SHIPPABLE_ITEM_FLAG,
  CUSTOMER_ORDER_FLAG,
  INTERNAL_ORDER_FLAG,
  CUSTOMER_ORDER_ENABLED_FLAG,
  INTERNAL_ORDER_ENABLED_FLAG,
  SO_TRANSACTIONS_FLAG,
  MTL_TRANSACTIONS_ENABLED_FLAG,
  STOCK_ENABLED_FLAG,
  DESCRIPTION,
  ASSEMBLY_ITEM_ID,
  CONFIGURATOR_FLAG,
  PRICE_LIST_ID,
  ROUNDING_FACTOR,
  PRICING_CONTEXT,
  PRICING_ATTRIBUTE1,
  PRICING_ATTRIBUTE2,
  PRICING_ATTRIBUTE3,
  PRICING_ATTRIBUTE4,
  PRICING_ATTRIBUTE5,
  PRICING_ATTRIBUTE6,
  PRICING_ATTRIBUTE7,
  PRICING_ATTRIBUTE8,
  PRICING_ATTRIBUTE9,
  PRICING_ATTRIBUTE10,
  PRICING_ATTRIBUTE11,
  PRICING_ATTRIBUTE12,
  PRICING_ATTRIBUTE13,
  PRICING_ATTRIBUTE14,
  PRICING_ATTRIBUTE15,
  COMPONENT_CODE,
  LOOP_FLAG,
  INVENTORY_ASSET_FLAG,
  PLANNING_FACTOR,
  OPERATION_SEQ_NUM,
  PARENT_BOM_ITEM_TYPE,
  WIP_SUPPLY_TYPE,
  ITEM_NUM,
  EFFECTIVITY_DATE,
  DISABLE_DATE,
  IMPLEMENTATION_DATE,
  SUPPLY_SUBINVENTORY,
  SUPPLY_LOCATOR_ID,
  COMPONENT_REMARKS,
  CHANGE_NOTICE,
  OPERATION_LEAD_TIME_PERCENT,
  REXPLODE_FLAG,
  COMMON_BILL_SEQUENCE_ID,
  OPERATION_OFFSET,
  CURRENT_REVISION,
  LOCATOR,
  FROM_END_ITEM_UNIT_NUMBER,
  TO_END_ITEM_UNIT_NUMBER,
  BASIS_TYPE,
  kca_operation,
  is_deleted_flg,
  kca_seq_id,
  kca_seq_date
)
SELECT
  TOP_BILL_SEQUENCE_ID,
  BILL_SEQUENCE_ID,
  ORGANIZATION_ID,
  COMPONENT_SEQUENCE_ID,
  COMPONENT_ITEM_ID,
  PLAN_LEVEL,
  EXTENDED_QUANTITY,
  SORT_ORDER,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  GROUP_ID,
  SESSION_ID,
  SELECT_FLAG,
  SELECT_QUANTITY,
  EXTEND_COST_FLAG,
  TOP_ALTERNATE_DESIGNATOR,
  TOP_ITEM_ID,
  CONTEXT,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  HEADER_ID,
  LINE_ID,
  LIST_PRICE,
  SELLING_PRICE,
  COMPONENT_YIELD_FACTOR,
  ITEM_COST,
  INCLUDE_IN_ROLLUP_FLAG,
  BASED_ON_ROLLUP_FLAG,
  ACTUAL_COST_TYPE_ID,
  COMPONENT_QUANTITY,
  SHRINKAGE_RATE,
  SO_BASIS,
  OPTIONAL,
  MUTUALLY_EXCLUSIVE_OPTIONS,
  CHECK_ATP,
  SHIPPING_ALLOWED,
  REQUIRED_TO_SHIP,
  REQUIRED_FOR_REVENUE,
  INCLUDE_ON_SHIP_DOCS,
  INCLUDE_ON_BILL_DOCS,
  LOW_QUANTITY,
  HIGH_QUANTITY,
  PICK_COMPONENTS,
  PRIMARY_UOM_CODE,
  PRIMARY_UNIT_OF_MEASURE,
  BASE_ITEM_ID,
  ATP_COMPONENTS_FLAG,
  ATP_FLAG,
  BOM_ITEM_TYPE,
  PICK_COMPONENTS_FLAG,
  REPLENISH_TO_ORDER_FLAG,
  SHIPPABLE_ITEM_FLAG,
  CUSTOMER_ORDER_FLAG,
  INTERNAL_ORDER_FLAG,
  CUSTOMER_ORDER_ENABLED_FLAG,
  INTERNAL_ORDER_ENABLED_FLAG,
  SO_TRANSACTIONS_FLAG,
  MTL_TRANSACTIONS_ENABLED_FLAG,
  STOCK_ENABLED_FLAG,
  DESCRIPTION,
  ASSEMBLY_ITEM_ID,
  CONFIGURATOR_FLAG,
  PRICE_LIST_ID,
  ROUNDING_FACTOR,
  PRICING_CONTEXT,
  PRICING_ATTRIBUTE1,
  PRICING_ATTRIBUTE2,
  PRICING_ATTRIBUTE3,
  PRICING_ATTRIBUTE4,
  PRICING_ATTRIBUTE5,
  PRICING_ATTRIBUTE6,
  PRICING_ATTRIBUTE7,
  PRICING_ATTRIBUTE8,
  PRICING_ATTRIBUTE9,
  PRICING_ATTRIBUTE10,
  PRICING_ATTRIBUTE11,
  PRICING_ATTRIBUTE12,
  PRICING_ATTRIBUTE13,
  PRICING_ATTRIBUTE14,
  PRICING_ATTRIBUTE15,
  COMPONENT_CODE,
  LOOP_FLAG,
  INVENTORY_ASSET_FLAG,
  PLANNING_FACTOR,
  OPERATION_SEQ_NUM,
  PARENT_BOM_ITEM_TYPE,
  WIP_SUPPLY_TYPE,
  ITEM_NUM,
  EFFECTIVITY_DATE,
  DISABLE_DATE,
  IMPLEMENTATION_DATE,
  SUPPLY_SUBINVENTORY,
  SUPPLY_LOCATOR_ID,
  COMPONENT_REMARKS,
  CHANGE_NOTICE,
  OPERATION_LEAD_TIME_PERCENT,
  REXPLODE_FLAG,
  COMMON_BILL_SEQUENCE_ID,
  OPERATION_OFFSET,
  CURRENT_REVISION,
  LOCATOR,
  FROM_END_ITEM_UNIT_NUMBER,
  TO_END_ITEM_UNIT_NUMBER,
  BASIS_TYPE,
  kca_operation,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.xxbec_ibom_rc_temp;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'xxbec_ibom_rc_temp';