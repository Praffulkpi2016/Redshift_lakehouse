DROP TABLE IF EXISTS silver_bec_ods.mtl_reservations;
CREATE TABLE IF NOT EXISTS silver_bec_ods.mtl_reservations (
  RESERVATION_ID DECIMAL(15, 0),
  REQUIREMENT_DATE TIMESTAMP,
  ORGANIZATION_ID DECIMAL(15, 0),
  INVENTORY_ITEM_ID DECIMAL(15, 0),
  DEMAND_SOURCE_TYPE_ID DECIMAL(15, 0),
  DEMAND_SOURCE_NAME STRING,
  DEMAND_SOURCE_HEADER_ID DECIMAL(15, 0),
  DEMAND_SOURCE_LINE_ID DECIMAL(15, 0),
  DEMAND_SOURCE_DELIVERY DECIMAL(28, 10),
  PRIMARY_UOM_CODE STRING,
  PRIMARY_UOM_ID DECIMAL(15, 0),
  RESERVATION_UOM_CODE STRING,
  RESERVATION_UOM_ID DECIMAL(15, 0),
  RESERVATION_QUANTITY DECIMAL(28, 10),
  PRIMARY_RESERVATION_QUANTITY DECIMAL(28, 10),
  AUTODETAIL_GROUP_ID DECIMAL(15, 0),
  EXTERNAL_SOURCE_CODE STRING,
  EXTERNAL_SOURCE_LINE_ID DECIMAL(15, 0),
  SUPPLY_SOURCE_TYPE_ID DECIMAL(15, 0),
  SUPPLY_SOURCE_HEADER_ID DECIMAL(15, 0),
  SUPPLY_SOURCE_LINE_ID DECIMAL(15, 0),
  SUPPLY_SOURCE_LINE_DETAIL DECIMAL(28, 10),
  SUPPLY_SOURCE_NAME STRING,
  REVISION STRING,
  SUBINVENTORY_CODE STRING,
  SUBINVENTORY_ID DECIMAL(15, 0),
  LOCATOR_ID DECIMAL(15, 0),
  LOT_NUMBER STRING,
  LOT_NUMBER_ID DECIMAL(15, 0),
  SERIAL_NUMBER STRING,
  SERIAL_NUMBER_ID DECIMAL(15, 0),
  PARTIAL_QUANTITIES_ALLOWED DECIMAL(28, 10),
  AUTO_DETAILED DECIMAL(28, 10),
  PICK_SLIP_NUMBER DECIMAL(28, 10),
  LPN_ID DECIMAL(15, 0),
  LAST_UPDATE_DATE TIMESTAMP,
  LAST_UPDATED_BY DECIMAL(15, 0),
  CREATION_DATE TIMESTAMP,
  CREATED_BY DECIMAL(15, 0),
  LAST_UPDATE_LOGIN DECIMAL(15, 0),
  REQUEST_ID DECIMAL(15, 0),
  PROGRAM_APPLICATION_ID DECIMAL(15, 0),
  PROGRAM_ID DECIMAL(15, 0),
  PROGRAM_UPDATE_DATE TIMESTAMP,
  ATTRIBUTE_CATEGORY STRING,
  ATTRIBUTE1 STRING,
  ATTRIBUTE2 STRING,
  ATTRIBUTE3 STRING,
  ATTRIBUTE4 STRING,
  ATTRIBUTE5 STRING,
  ATTRIBUTE6 STRING,
  ATTRIBUTE7 STRING,
  ATTRIBUTE8 STRING,
  ATTRIBUTE9 STRING,
  ATTRIBUTE10 STRING,
  ATTRIBUTE11 STRING,
  ATTRIBUTE12 STRING,
  ATTRIBUTE13 STRING,
  ATTRIBUTE14 STRING,
  ATTRIBUTE15 STRING,
  SHIP_READY_FLAG DECIMAL(15, 0),
  N_COLUMN1 DECIMAL(28, 10),
  DETAILED_QUANTITY DECIMAL(28, 10),
  COST_GROUP_ID DECIMAL(15, 0),
  CONTAINER_LPN_ID DECIMAL(15, 0),
  STAGED_FLAG STRING,
  SECONDARY_DETAILED_QUANTITY DECIMAL(28, 10),
  SECONDARY_RESERVATION_QUANTITY DECIMAL(28, 10),
  SECONDARY_UOM_CODE STRING,
  SECONDARY_UOM_ID DECIMAL(15, 0),
  CROSSDOCK_FLAG STRING,
  CROSSDOCK_CRITERIA_ID DECIMAL(15, 0),
  DEMAND_SOURCE_LINE_DETAIL DECIMAL(28, 10),
  SERIAL_RESERVATION_QUANTITY DECIMAL(28, 10),
  SUPPLY_RECEIPT_DATE TIMESTAMP,
  DEMAND_SHIP_DATE TIMESTAMP,
  EXCEPTION_CODE STRING,
  ORIG_SUPPLY_SOURCE_TYPE_ID DECIMAL(15, 0),
  ORIG_SUPPLY_SOURCE_HEADER_ID DECIMAL(15, 0),
  ORIG_SUPPLY_SOURCE_LINE_ID DECIMAL(15, 0),
  ORIG_SUPPLY_SOURCE_LINE_DETAIL DECIMAL(28, 10),
  ORIG_DEMAND_SOURCE_TYPE_ID DECIMAL(15, 0),
  ORIG_DEMAND_SOURCE_HEADER_ID DECIMAL(15, 0),
  ORIG_DEMAND_SOURCE_LINE_ID DECIMAL(15, 0),
  ORIG_DEMAND_SOURCE_LINE_DETAIL DECIMAL(28, 10),
  PROJECT_ID DECIMAL(15, 0),
  TASK_ID DECIMAL(15, 0),
  MCC_CODE STRING,
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.mtl_reservations (
  RESERVATION_ID,
  REQUIREMENT_DATE,
  ORGANIZATION_ID,
  INVENTORY_ITEM_ID,
  DEMAND_SOURCE_TYPE_ID,
  DEMAND_SOURCE_NAME,
  DEMAND_SOURCE_HEADER_ID,
  DEMAND_SOURCE_LINE_ID,
  DEMAND_SOURCE_DELIVERY,
  PRIMARY_UOM_CODE,
  PRIMARY_UOM_ID,
  RESERVATION_UOM_CODE,
  RESERVATION_UOM_ID,
  RESERVATION_QUANTITY,
  PRIMARY_RESERVATION_QUANTITY,
  AUTODETAIL_GROUP_ID,
  EXTERNAL_SOURCE_CODE,
  EXTERNAL_SOURCE_LINE_ID,
  SUPPLY_SOURCE_TYPE_ID,
  SUPPLY_SOURCE_HEADER_ID,
  SUPPLY_SOURCE_LINE_ID,
  SUPPLY_SOURCE_LINE_DETAIL,
  SUPPLY_SOURCE_NAME,
  REVISION,
  SUBINVENTORY_CODE,
  SUBINVENTORY_ID,
  LOCATOR_ID,
  LOT_NUMBER,
  LOT_NUMBER_ID,
  SERIAL_NUMBER,
  SERIAL_NUMBER_ID,
  PARTIAL_QUANTITIES_ALLOWED,
  AUTO_DETAILED,
  PICK_SLIP_NUMBER,
  LPN_ID,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_LOGIN,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  SHIP_READY_FLAG,
  N_COLUMN1,
  DETAILED_QUANTITY,
  COST_GROUP_ID,
  CONTAINER_LPN_ID,
  STAGED_FLAG,
  SECONDARY_DETAILED_QUANTITY,
  SECONDARY_RESERVATION_QUANTITY,
  SECONDARY_UOM_CODE,
  SECONDARY_UOM_ID,
  CROSSDOCK_FLAG,
  CROSSDOCK_CRITERIA_ID,
  DEMAND_SOURCE_LINE_DETAIL,
  SERIAL_RESERVATION_QUANTITY,
  SUPPLY_RECEIPT_DATE,
  DEMAND_SHIP_DATE,
  EXCEPTION_CODE,
  ORIG_SUPPLY_SOURCE_TYPE_ID,
  ORIG_SUPPLY_SOURCE_HEADER_ID,
  ORIG_SUPPLY_SOURCE_LINE_ID,
  ORIG_SUPPLY_SOURCE_LINE_DETAIL,
  ORIG_DEMAND_SOURCE_TYPE_ID,
  ORIG_DEMAND_SOURCE_HEADER_ID,
  ORIG_DEMAND_SOURCE_LINE_ID,
  ORIG_DEMAND_SOURCE_LINE_DETAIL,
  PROJECT_ID,
  TASK_ID,
  MCC_CODE,
  KCA_OPERATION,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
SELECT
  RESERVATION_ID,
  REQUIREMENT_DATE,
  ORGANIZATION_ID,
  INVENTORY_ITEM_ID,
  DEMAND_SOURCE_TYPE_ID,
  DEMAND_SOURCE_NAME,
  DEMAND_SOURCE_HEADER_ID,
  DEMAND_SOURCE_LINE_ID,
  DEMAND_SOURCE_DELIVERY,
  PRIMARY_UOM_CODE,
  PRIMARY_UOM_ID,
  RESERVATION_UOM_CODE,
  RESERVATION_UOM_ID,
  RESERVATION_QUANTITY,
  PRIMARY_RESERVATION_QUANTITY,
  AUTODETAIL_GROUP_ID,
  EXTERNAL_SOURCE_CODE,
  EXTERNAL_SOURCE_LINE_ID,
  SUPPLY_SOURCE_TYPE_ID,
  SUPPLY_SOURCE_HEADER_ID,
  SUPPLY_SOURCE_LINE_ID,
  SUPPLY_SOURCE_LINE_DETAIL,
  SUPPLY_SOURCE_NAME,
  REVISION,
  SUBINVENTORY_CODE,
  SUBINVENTORY_ID,
  LOCATOR_ID,
  LOT_NUMBER,
  LOT_NUMBER_ID,
  SERIAL_NUMBER,
  SERIAL_NUMBER_ID,
  PARTIAL_QUANTITIES_ALLOWED,
  AUTO_DETAILED,
  PICK_SLIP_NUMBER,
  LPN_ID,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_LOGIN,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  SHIP_READY_FLAG,
  N_COLUMN1,
  DETAILED_QUANTITY,
  COST_GROUP_ID,
  CONTAINER_LPN_ID,
  STAGED_FLAG,
  SECONDARY_DETAILED_QUANTITY,
  SECONDARY_RESERVATION_QUANTITY,
  SECONDARY_UOM_CODE,
  SECONDARY_UOM_ID,
  CROSSDOCK_FLAG,
  CROSSDOCK_CRITERIA_ID,
  DEMAND_SOURCE_LINE_DETAIL,
  SERIAL_RESERVATION_QUANTITY,
  SUPPLY_RECEIPT_DATE,
  DEMAND_SHIP_DATE,
  EXCEPTION_CODE,
  ORIG_SUPPLY_SOURCE_TYPE_ID,
  ORIG_SUPPLY_SOURCE_HEADER_ID,
  ORIG_SUPPLY_SOURCE_LINE_ID,
  ORIG_SUPPLY_SOURCE_LINE_DETAIL,
  ORIG_DEMAND_SOURCE_TYPE_ID,
  ORIG_DEMAND_SOURCE_HEADER_ID,
  ORIG_DEMAND_SOURCE_LINE_ID,
  ORIG_DEMAND_SOURCE_LINE_DETAIL,
  PROJECT_ID,
  TASK_ID,
  MCC_CODE,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.mtl_reservations;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'mtl_reservations';