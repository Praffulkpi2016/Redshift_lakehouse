DROP TABLE IF EXISTS silver_bec_ods.csi_item_instances;
CREATE TABLE IF NOT EXISTS silver_bec_ods.csi_item_instances (
  INSTANCE_ID DECIMAL(15, 0),
  INSTANCE_NUMBER STRING,
  EXTERNAL_REFERENCE STRING,
  INVENTORY_ITEM_ID DECIMAL(15, 0),
  INVENTORY_REVISION STRING,
  INV_MASTER_ORGANIZATION_ID DECIMAL(15, 0),
  SERIAL_NUMBER STRING,
  MFG_SERIAL_NUMBER_FLAG STRING,
  LOT_NUMBER STRING,
  QUANTITY DECIMAL(28, 10),
  UNIT_OF_MEASURE STRING,
  ACCOUNTING_CLASS_CODE STRING,
  INSTANCE_CONDITION_ID DECIMAL(15, 0),
  INSTANCE_STATUS_ID DECIMAL(15, 0),
  CUSTOMER_VIEW_FLAG STRING,
  MERCHANT_VIEW_FLAG STRING,
  SELLABLE_FLAG STRING,
  SYSTEM_ID DECIMAL(15, 0),
  INSTANCE_TYPE_CODE STRING,
  ACTIVE_START_DATE TIMESTAMP,
  ACTIVE_END_DATE TIMESTAMP,
  LOCATION_TYPE_CODE STRING,
  LOCATION_ID DECIMAL(15, 0),
  INV_ORGANIZATION_ID DECIMAL(15, 0),
  INV_SUBINVENTORY_NAME STRING,
  INV_LOCATOR_ID DECIMAL(15, 0),
  PA_PROJECT_ID DECIMAL(15, 0),
  PA_PROJECT_TASK_ID DECIMAL(15, 0),
  IN_TRANSIT_ORDER_LINE_ID DECIMAL(15, 0),
  WIP_JOB_ID DECIMAL(15, 0),
  PO_ORDER_LINE_ID DECIMAL(15, 0),
  LAST_OE_ORDER_LINE_ID DECIMAL(15, 0),
  LAST_OE_RMA_LINE_ID DECIMAL(15, 0),
  LAST_PO_PO_LINE_ID DECIMAL(15, 0),
  LAST_OE_PO_NUMBER STRING,
  LAST_WIP_JOB_ID DECIMAL(15, 0),
  LAST_PA_PROJECT_ID DECIMAL(15, 0),
  LAST_PA_TASK_ID DECIMAL(15, 0),
  LAST_OE_AGREEMENT_ID DECIMAL(15, 0),
  INSTALL_DATE TIMESTAMP,
  MANUALLY_CREATED_FLAG STRING,
  RETURN_BY_DATE TIMESTAMP,
  ACTUAL_RETURN_DATE TIMESTAMP,
  CREATION_COMPLETE_FLAG STRING,
  COMPLETENESS_FLAG STRING,
  CONTEXT STRING,
  ATTRIBUTE1 STRING,
  ATTRIBUTE2 STRING,
  ATTRIBUTE3 STRING,
  ATTRIBUTE4 STRING,
  ATTRIBUTE5 STRING,
  ATTRIBUTE6 STRING,
  ATTRIBUTE7 STRING,
  ATTRIBUTE8 STRING,
  ATTRIBUTE9 STRING,
  ATTRIBUTE10 STRING,
  ATTRIBUTE11 STRING,
  ATTRIBUTE12 STRING,
  ATTRIBUTE13 STRING,
  ATTRIBUTE14 STRING,
  ATTRIBUTE15 STRING,
  CREATED_BY DECIMAL(15, 0),
  CREATION_DATE TIMESTAMP,
  LAST_UPDATED_BY DECIMAL(15, 0),
  LAST_UPDATE_DATE TIMESTAMP,
  LAST_UPDATE_LOGIN DECIMAL(15, 0),
  OBJECT_VERSION_NUMBER DECIMAL(28, 10),
  SECURITY_GROUP_ID DECIMAL(15, 0),
  LAST_TXN_LINE_DETAIL_ID DECIMAL(15, 0),
  INSTALL_LOCATION_TYPE_CODE STRING,
  INSTALL_LOCATION_ID DECIMAL(15, 0),
  INSTANCE_USAGE_CODE STRING,
  OWNER_PARTY_SOURCE_TABLE STRING,
  OWNER_PARTY_ID DECIMAL(15, 0),
  OWNER_PARTY_ACCOUNT_ID DECIMAL(15, 0),
  LAST_VLD_ORGANIZATION_ID DECIMAL(15, 0),
  MIGRATED_FLAG STRING,
  REQUEST_ID DECIMAL(15, 0),
  PROGRAM_APPLICATION_ID DECIMAL(15, 0),
  PROGRAM_ID DECIMAL(15, 0),
  PROGRAM_UPDATE_DATE TIMESTAMP,
  CONFIG_INST_HDR_ID DECIMAL(15, 0),
  CONFIG_INST_REV_NUM DECIMAL(28, 10),
  CONFIG_INST_ITEM_ID DECIMAL(15, 0),
  CONFIG_VALID_STATUS STRING,
  INSTANCE_DESCRIPTION STRING,
  LAST_PURGE_DATE TIMESTAMP,
  ATTRIBUTE16 STRING,
  ATTRIBUTE17 STRING,
  ATTRIBUTE18 STRING,
  ATTRIBUTE19 STRING,
  ATTRIBUTE20 STRING,
  ATTRIBUTE21 STRING,
  ATTRIBUTE22 STRING,
  ATTRIBUTE23 STRING,
  ATTRIBUTE24 STRING,
  ATTRIBUTE25 STRING,
  ATTRIBUTE26 STRING,
  ATTRIBUTE27 STRING,
  ATTRIBUTE28 STRING,
  ATTRIBUTE29 STRING,
  ATTRIBUTE30 STRING,
  NETWORK_ASSET_FLAG STRING,
  MAINTAINABLE_FLAG STRING,
  PN_LOCATION_ID DECIMAL(15, 0),
  ASSET_CRITICALITY_CODE STRING,
  CATEGORY_ID DECIMAL(15, 0),
  EQUIPMENT_GEN_OBJECT_ID DECIMAL(15, 0),
  INSTANTIATION_FLAG STRING,
  LINEAR_LOCATION_ID DECIMAL(15, 0),
  OPERATIONAL_LOG_FLAG STRING,
  CHECKIN_STATUS DECIMAL(28, 10),
  SUPPLIER_WARRANTY_EXP_DATE TIMESTAMP,
  PURCHASE_UNIT_PRICE DECIMAL(28, 10),
  PURCHASE_CURRENCY_CODE STRING,
  PAYABLES_UNIT_PRICE DECIMAL(28, 10),
  PAYABLES_CURRENCY_CODE STRING,
  SALES_UNIT_PRICE DECIMAL(28, 10),
  SALES_CURRENCY_CODE STRING,
  OPERATIONAL_STATUS_CODE STRING,
  SOURCE_CODE STRING,
  ROUTE_UPDATE_WO_FLAG STRING,
  COST_UPDATE_WO_FLAG STRING,
  ROUTE_COST_EQUAL_FLAG STRING,
  LINEAR_ASSET STRING,
  SEGMENTED STRING,
  ROUTE_QUALITY_RESULT_FLAG STRING,
  ESRI_FEATURE STRING,
  NO_MEASURES_LA STRING,
  ROUTE_LAYER_ID DECIMAL(15, 0),
  IN_SERVICE_DATE TIMESTAMP,
  IOT_SYNC_DATE TIMESTAMP,
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.csi_item_instances (
  INSTANCE_ID,
  INSTANCE_NUMBER,
  EXTERNAL_REFERENCE,
  INVENTORY_ITEM_ID,
  INVENTORY_REVISION,
  INV_MASTER_ORGANIZATION_ID,
  SERIAL_NUMBER,
  MFG_SERIAL_NUMBER_FLAG,
  LOT_NUMBER,
  QUANTITY,
  UNIT_OF_MEASURE,
  ACCOUNTING_CLASS_CODE,
  INSTANCE_CONDITION_ID,
  INSTANCE_STATUS_ID,
  CUSTOMER_VIEW_FLAG,
  MERCHANT_VIEW_FLAG,
  SELLABLE_FLAG,
  SYSTEM_ID,
  INSTANCE_TYPE_CODE,
  ACTIVE_START_DATE,
  ACTIVE_END_DATE,
  LOCATION_TYPE_CODE,
  LOCATION_ID,
  INV_ORGANIZATION_ID,
  INV_SUBINVENTORY_NAME,
  INV_LOCATOR_ID,
  PA_PROJECT_ID,
  PA_PROJECT_TASK_ID,
  IN_TRANSIT_ORDER_LINE_ID,
  WIP_JOB_ID,
  PO_ORDER_LINE_ID,
  LAST_OE_ORDER_LINE_ID,
  LAST_OE_RMA_LINE_ID,
  LAST_PO_PO_LINE_ID,
  LAST_OE_PO_NUMBER,
  LAST_WIP_JOB_ID,
  LAST_PA_PROJECT_ID,
  LAST_PA_TASK_ID,
  LAST_OE_AGREEMENT_ID,
  INSTALL_DATE,
  MANUALLY_CREATED_FLAG,
  RETURN_BY_DATE,
  ACTUAL_RETURN_DATE,
  CREATION_COMPLETE_FLAG,
  COMPLETENESS_FLAG,
  CONTEXT,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  CREATED_BY,
  CREATION_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATE_LOGIN,
  OBJECT_VERSION_NUMBER,
  SECURITY_GROUP_ID,
  LAST_TXN_LINE_DETAIL_ID,
  INSTALL_LOCATION_TYPE_CODE,
  INSTALL_LOCATION_ID,
  INSTANCE_USAGE_CODE,
  OWNER_PARTY_SOURCE_TABLE,
  OWNER_PARTY_ID,
  OWNER_PARTY_ACCOUNT_ID,
  LAST_VLD_ORGANIZATION_ID,
  MIGRATED_FLAG,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  CONFIG_INST_HDR_ID,
  CONFIG_INST_REV_NUM,
  CONFIG_INST_ITEM_ID,
  CONFIG_VALID_STATUS,
  INSTANCE_DESCRIPTION,
  LAST_PURGE_DATE,
  ATTRIBUTE16,
  ATTRIBUTE17,
  ATTRIBUTE18,
  ATTRIBUTE19,
  ATTRIBUTE20,
  ATTRIBUTE21,
  ATTRIBUTE22,
  ATTRIBUTE23,
  ATTRIBUTE24,
  ATTRIBUTE25,
  ATTRIBUTE26,
  ATTRIBUTE27,
  ATTRIBUTE28,
  ATTRIBUTE29,
  ATTRIBUTE30,
  NETWORK_ASSET_FLAG,
  MAINTAINABLE_FLAG,
  PN_LOCATION_ID,
  ASSET_CRITICALITY_CODE,
  CATEGORY_ID,
  EQUIPMENT_GEN_OBJECT_ID,
  INSTANTIATION_FLAG,
  LINEAR_LOCATION_ID,
  OPERATIONAL_LOG_FLAG,
  CHECKIN_STATUS,
  SUPPLIER_WARRANTY_EXP_DATE,
  PURCHASE_UNIT_PRICE,
  PURCHASE_CURRENCY_CODE,
  PAYABLES_UNIT_PRICE,
  PAYABLES_CURRENCY_CODE,
  SALES_UNIT_PRICE,
  SALES_CURRENCY_CODE,
  OPERATIONAL_STATUS_CODE,
  SOURCE_CODE,
  ROUTE_UPDATE_WO_FLAG,
  COST_UPDATE_WO_FLAG,
  ROUTE_COST_EQUAL_FLAG,
  LINEAR_ASSET,
  SEGMENTED,
  ROUTE_QUALITY_RESULT_FLAG,
  ESRI_FEATURE,
  NO_MEASURES_LA,
  ROUTE_LAYER_ID,
  IN_SERVICE_DATE,
  IOT_SYNC_DATE,
  KCA_OPERATION,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
SELECT
  INSTANCE_ID,
  INSTANCE_NUMBER,
  EXTERNAL_REFERENCE,
  INVENTORY_ITEM_ID,
  INVENTORY_REVISION,
  INV_MASTER_ORGANIZATION_ID,
  SERIAL_NUMBER,
  MFG_SERIAL_NUMBER_FLAG,
  LOT_NUMBER,
  QUANTITY,
  UNIT_OF_MEASURE,
  ACCOUNTING_CLASS_CODE,
  INSTANCE_CONDITION_ID,
  INSTANCE_STATUS_ID,
  CUSTOMER_VIEW_FLAG,
  MERCHANT_VIEW_FLAG,
  SELLABLE_FLAG,
  SYSTEM_ID,
  INSTANCE_TYPE_CODE,
  ACTIVE_START_DATE,
  ACTIVE_END_DATE,
  LOCATION_TYPE_CODE,
  LOCATION_ID,
  INV_ORGANIZATION_ID,
  INV_SUBINVENTORY_NAME,
  INV_LOCATOR_ID,
  PA_PROJECT_ID,
  PA_PROJECT_TASK_ID,
  IN_TRANSIT_ORDER_LINE_ID,
  WIP_JOB_ID,
  PO_ORDER_LINE_ID,
  LAST_OE_ORDER_LINE_ID,
  LAST_OE_RMA_LINE_ID,
  LAST_PO_PO_LINE_ID,
  LAST_OE_PO_NUMBER,
  LAST_WIP_JOB_ID,
  LAST_PA_PROJECT_ID,
  LAST_PA_TASK_ID,
  LAST_OE_AGREEMENT_ID,
  INSTALL_DATE,
  MANUALLY_CREATED_FLAG,
  RETURN_BY_DATE,
  ACTUAL_RETURN_DATE,
  CREATION_COMPLETE_FLAG,
  COMPLETENESS_FLAG,
  CONTEXT,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  CREATED_BY,
  CREATION_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATE_LOGIN,
  OBJECT_VERSION_NUMBER,
  SECURITY_GROUP_ID,
  LAST_TXN_LINE_DETAIL_ID,
  INSTALL_LOCATION_TYPE_CODE,
  INSTALL_LOCATION_ID,
  INSTANCE_USAGE_CODE,
  OWNER_PARTY_SOURCE_TABLE,
  OWNER_PARTY_ID,
  OWNER_PARTY_ACCOUNT_ID,
  LAST_VLD_ORGANIZATION_ID,
  MIGRATED_FLAG,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  CONFIG_INST_HDR_ID,
  CONFIG_INST_REV_NUM,
  CONFIG_INST_ITEM_ID,
  CONFIG_VALID_STATUS,
  INSTANCE_DESCRIPTION,
  LAST_PURGE_DATE,
  ATTRIBUTE16,
  ATTRIBUTE17,
  ATTRIBUTE18,
  ATTRIBUTE19,
  ATTRIBUTE20,
  ATTRIBUTE21,
  ATTRIBUTE22,
  ATTRIBUTE23,
  ATTRIBUTE24,
  ATTRIBUTE25,
  ATTRIBUTE26,
  ATTRIBUTE27,
  ATTRIBUTE28,
  ATTRIBUTE29,
  ATTRIBUTE30,
  NETWORK_ASSET_FLAG,
  MAINTAINABLE_FLAG,
  PN_LOCATION_ID,
  ASSET_CRITICALITY_CODE,
  CATEGORY_ID,
  EQUIPMENT_GEN_OBJECT_ID,
  INSTANTIATION_FLAG,
  LINEAR_LOCATION_ID,
  OPERATIONAL_LOG_FLAG,
  CHECKIN_STATUS,
  SUPPLIER_WARRANTY_EXP_DATE,
  PURCHASE_UNIT_PRICE,
  PURCHASE_CURRENCY_CODE,
  PAYABLES_UNIT_PRICE,
  PAYABLES_CURRENCY_CODE,
  SALES_UNIT_PRICE,
  SALES_CURRENCY_CODE,
  OPERATIONAL_STATUS_CODE,
  SOURCE_CODE,
  ROUTE_UPDATE_WO_FLAG,
  COST_UPDATE_WO_FLAG,
  ROUTE_COST_EQUAL_FLAG,
  LINEAR_ASSET,
  SEGMENTED,
  ROUTE_QUALITY_RESULT_FLAG,
  ESRI_FEATURE,
  NO_MEASURES_LA,
  ROUTE_LAYER_ID,
  IN_SERVICE_DATE,
  IOT_SYNC_DATE,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.csi_item_instances;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'csi_item_instances';