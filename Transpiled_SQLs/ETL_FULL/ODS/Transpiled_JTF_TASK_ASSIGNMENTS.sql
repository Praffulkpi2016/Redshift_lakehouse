DROP TABLE IF EXISTS silver_bec_ods.JTF_TASK_ASSIGNMENTS;
CREATE TABLE IF NOT EXISTS silver_bec_ods.JTF_TASK_ASSIGNMENTS (
  TASK_ASSIGNMENT_ID DECIMAL(15, 0),
  CREATED_BY DECIMAL(15, 0),
  CREATION_DATE TIMESTAMP,
  LAST_UPDATED_BY DECIMAL(15, 0),
  LAST_UPDATE_DATE TIMESTAMP,
  LAST_UPDATE_LOGIN DECIMAL(15, 0),
  OBJECT_VERSION_NUMBER DECIMAL(15, 0),
  TASK_ID DECIMAL(15, 0),
  RESOURCE_TYPE_CODE STRING,
  RESOURCE_ID DECIMAL(15, 0),
  ASSIGNMENT_STATUS_ID DECIMAL(15, 0),
  ACTUAL_EFFORT DECIMAL(28, 10),
  RESOURCE_TERRITORY_ID DECIMAL(15, 0),
  ACTUAL_EFFORT_UOM STRING,
  SCHEDULE_FLAG STRING,
  ALARM_TYPE_CODE STRING,
  ALARM_CONTACT STRING,
  SHIFT_CONSTRUCT_ID DECIMAL(15, 0),
  SCHED_TRAVEL_DISTANCE DECIMAL(28, 10),
  SCHED_TRAVEL_DURATION DECIMAL(28, 10),
  SCHED_TRAVEL_DURATION_UOM STRING,
  ACTUAL_TRAVEL_DISTANCE DECIMAL(28, 10),
  ACTUAL_TRAVEL_DURATION DECIMAL(28, 10),
  ACTUAL_TRAVEL_DURATION_UOM STRING,
  ACTUAL_START_DATE TIMESTAMP,
  ACTUAL_END_DATE TIMESTAMP,
  PALM_FLAG STRING,
  WINCE_FLAG STRING,
  LAPTOP_FLAG STRING,
  DEVICE1_FLAG STRING,
  DEVICE2_FLAG STRING,
  DEVICE3_FLAG STRING,
  ATTRIBUTE1 STRING,
  ATTRIBUTE2 STRING,
  ATTRIBUTE3 STRING,
  ATTRIBUTE4 STRING,
  ATTRIBUTE5 STRING,
  ATTRIBUTE6 STRING,
  ATTRIBUTE7 STRING,
  ATTRIBUTE8 STRING,
  ATTRIBUTE9 STRING,
  ATTRIBUTE10 STRING,
  ATTRIBUTE11 STRING,
  ATTRIBUTE12 STRING,
  ATTRIBUTE13 STRING,
  ATTRIBUTE14 STRING,
  ATTRIBUTE15 STRING,
  ATTRIBUTE_CATEGORY STRING,
  SECURITY_GROUP_ID DECIMAL(15, 0),
  ORIG_SYSTEM_REFERENCE STRING,
  ORIG_SYSTEM_REFERENCE_ID DECIMAL(15, 0),
  UPDATE_STATUS_FLAG STRING,
  ASSIGNEE_ROLE STRING,
  SHOW_ON_CALENDAR STRING,
  CATEGORY_ID DECIMAL(15, 0),
  REMINDER_WF_ITEM_TYPE STRING,
  REMINDER_WF_ITEM_KEY STRING,
  FREE_BUSY_TYPE STRING,
  BOOKING_START_DATE TIMESTAMP,
  BOOKING_END_DATE TIMESTAMP,
  OBJECT_CAPACITY_ID DECIMAL(15, 0),
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.JTF_TASK_ASSIGNMENTS (
  TASK_ASSIGNMENT_ID,
  CREATED_BY,
  CREATION_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATE_LOGIN,
  OBJECT_VERSION_NUMBER,
  TASK_ID,
  RESOURCE_TYPE_CODE,
  RESOURCE_ID,
  ASSIGNMENT_STATUS_ID,
  ACTUAL_EFFORT,
  RESOURCE_TERRITORY_ID,
  ACTUAL_EFFORT_UOM,
  SCHEDULE_FLAG,
  ALARM_TYPE_CODE,
  ALARM_CONTACT,
  SHIFT_CONSTRUCT_ID,
  SCHED_TRAVEL_DISTANCE,
  SCHED_TRAVEL_DURATION,
  SCHED_TRAVEL_DURATION_UOM,
  ACTUAL_TRAVEL_DISTANCE,
  ACTUAL_TRAVEL_DURATION,
  ACTUAL_TRAVEL_DURATION_UOM,
  ACTUAL_START_DATE,
  ACTUAL_END_DATE,
  PALM_FLAG,
  WINCE_FLAG,
  LAPTOP_FLAG,
  DEVICE1_FLAG,
  DEVICE2_FLAG,
  DEVICE3_FLAG,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  ATTRIBUTE_CATEGORY,
  SECURITY_GROUP_ID,
  ORIG_SYSTEM_REFERENCE,
  ORIG_SYSTEM_REFERENCE_ID,
  UPDATE_STATUS_FLAG,
  ASSIGNEE_ROLE,
  SHOW_ON_CALENDAR,
  CATEGORY_ID,
  REMINDER_WF_ITEM_TYPE,
  REMINDER_WF_ITEM_KEY,
  FREE_BUSY_TYPE,
  BOOKING_START_DATE,
  BOOKING_END_DATE,
  OBJECT_CAPACITY_ID,
  KCA_OPERATION,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
SELECT
  TASK_ASSIGNMENT_ID,
  CREATED_BY,
  CREATION_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATE_LOGIN,
  OBJECT_VERSION_NUMBER,
  TASK_ID,
  RESOURCE_TYPE_CODE,
  RESOURCE_ID,
  ASSIGNMENT_STATUS_ID,
  ACTUAL_EFFORT,
  RESOURCE_TERRITORY_ID,
  ACTUAL_EFFORT_UOM,
  SCHEDULE_FLAG,
  ALARM_TYPE_CODE,
  ALARM_CONTACT,
  SHIFT_CONSTRUCT_ID,
  SCHED_TRAVEL_DISTANCE,
  SCHED_TRAVEL_DURATION,
  SCHED_TRAVEL_DURATION_UOM,
  ACTUAL_TRAVEL_DISTANCE,
  ACTUAL_TRAVEL_DURATION,
  ACTUAL_TRAVEL_DURATION_UOM,
  ACTUAL_START_DATE,
  ACTUAL_END_DATE,
  PALM_FLAG,
  WINCE_FLAG,
  LAPTOP_FLAG,
  DEVICE1_FLAG,
  DEVICE2_FLAG,
  DEVICE3_FLAG,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  ATTRIBUTE_CATEGORY,
  SECURITY_GROUP_ID,
  ORIG_SYSTEM_REFERENCE,
  ORIG_SYSTEM_REFERENCE_ID,
  UPDATE_STATUS_FLAG,
  ASSIGNEE_ROLE,
  SHOW_ON_CALENDAR,
  CATEGORY_ID,
  REMINDER_WF_ITEM_TYPE,
  REMINDER_WF_ITEM_KEY,
  FREE_BUSY_TYPE,
  BOOKING_START_DATE,
  BOOKING_END_DATE,
  OBJECT_CAPACITY_ID,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.JTF_TASK_ASSIGNMENTS;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'jtf_task_assignments';