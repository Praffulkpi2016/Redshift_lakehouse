DROP TABLE IF EXISTS silver_bec_ods.XLA_DISTRIBUTION_LINKS;
CREATE TABLE IF NOT EXISTS silver_bec_ods.XLA_DISTRIBUTION_LINKS (
  APPLICATION_ID DECIMAL(15, 0),
  EVENT_ID DECIMAL(15, 0),
  AE_HEADER_ID DECIMAL(15, 0),
  AE_LINE_NUM DECIMAL(38, 0),
  SOURCE_DISTRIBUTION_TYPE STRING,
  SOURCE_DISTRIBUTION_ID_CHAR_1 STRING,
  SOURCE_DISTRIBUTION_ID_CHAR_2 STRING,
  SOURCE_DISTRIBUTION_ID_CHAR_3 STRING,
  SOURCE_DISTRIBUTION_ID_CHAR_4 STRING,
  SOURCE_DISTRIBUTION_ID_CHAR_5 STRING,
  SOURCE_DISTRIBUTION_ID_NUM_1 DECIMAL(38, 0),
  SOURCE_DISTRIBUTION_ID_NUM_2 DECIMAL(38, 0),
  SOURCE_DISTRIBUTION_ID_NUM_3 DECIMAL(38, 0),
  SOURCE_DISTRIBUTION_ID_NUM_4 DECIMAL(38, 0),
  SOURCE_DISTRIBUTION_ID_NUM_5 DECIMAL(38, 0),
  TAX_LINE_REF_ID DECIMAL(15, 0),
  TAX_SUMMARY_LINE_REF_ID DECIMAL(15, 0),
  TAX_REC_NREC_DIST_REF_ID DECIMAL(15, 0),
  STATISTICAL_AMOUNT DECIMAL(28, 10),
  REF_AE_HEADER_ID DECIMAL(15, 0),
  REF_TEMP_LINE_NUM DECIMAL(15, 0),
  ACCOUNTING_LINE_CODE STRING,
  ACCOUNTING_LINE_TYPE_CODE STRING,
  MERGE_DUPLICATE_CODE STRING,
  TEMP_LINE_NUM DECIMAL(15, 0),
  REF_EVENT_ID DECIMAL(15, 0),
  LINE_DEFINITION_OWNER_CODE STRING,
  LINE_DEFINITION_CODE STRING,
  EVENT_CLASS_CODE STRING,
  EVENT_TYPE_CODE STRING,
  UPG_BATCH_ID DECIMAL(15, 0),
  CALCULATE_ACCTD_AMTS_FLAG STRING,
  CALCULATE_G_L_AMTS_FLAG STRING,
  ROUNDING_CLASS_CODE STRING,
  DOCUMENT_ROUNDING_LEVEL STRING,
  UNROUNDED_ENTERED_DR DECIMAL(28, 10),
  UNROUNDED_ENTERED_CR DECIMAL(28, 10),
  DOC_ROUNDING_ENTERED_AMT DECIMAL(28, 10),
  DOC_ROUNDING_ACCTD_AMT DECIMAL(28, 10),
  UNROUNDED_ACCOUNTED_CR DECIMAL(28, 10),
  UNROUNDED_ACCOUNTED_DR DECIMAL(28, 10),
  APPLIED_TO_APPLICATION_ID DECIMAL(15, 0),
  APPLIED_TO_ENTITY_CODE STRING,
  APPLIED_TO_ENTITY_ID DECIMAL(15, 0),
  APPLIED_TO_SOURCE_ID_NUM_1 DECIMAL(15, 0),
  APPLIED_TO_SOURCE_ID_NUM_2 DECIMAL(15, 0),
  APPLIED_TO_SOURCE_ID_NUM_3 DECIMAL(15, 0),
  APPLIED_TO_SOURCE_ID_NUM_4 DECIMAL(15, 0),
  APPLIED_TO_SOURCE_ID_CHAR_1 STRING,
  APPLIED_TO_SOURCE_ID_CHAR_2 STRING,
  APPLIED_TO_SOURCE_ID_CHAR_3 STRING,
  APPLIED_TO_SOURCE_ID_CHAR_4 STRING,
  APPLIED_TO_DISTRIBUTION_TYPE STRING,
  APPLIED_TO_DIST_ID_NUM_1 DECIMAL(15, 0),
  APPLIED_TO_DIST_ID_NUM_2 DECIMAL(15, 0),
  APPLIED_TO_DIST_ID_NUM_3 DECIMAL(15, 0),
  APPLIED_TO_DIST_ID_NUM_4 DECIMAL(15, 0),
  APPLIED_TO_DIST_ID_NUM_5 DECIMAL(15, 0),
  APPLIED_TO_DIST_ID_CHAR_1 STRING,
  APPLIED_TO_DIST_ID_CHAR_2 STRING,
  APPLIED_TO_DIST_ID_CHAR_3 STRING,
  APPLIED_TO_DIST_ID_CHAR_4 STRING,
  APPLIED_TO_DIST_ID_CHAR_5 STRING,
  ALLOC_TO_APPLICATION_ID DECIMAL(15, 0),
  ALLOC_TO_ENTITY_CODE STRING,
  ALLOC_TO_SOURCE_ID_NUM_1 DECIMAL(15, 0),
  ALLOC_TO_SOURCE_ID_NUM_2 DECIMAL(15, 0),
  ALLOC_TO_SOURCE_ID_NUM_3 DECIMAL(15, 0),
  ALLOC_TO_SOURCE_ID_NUM_4 DECIMAL(15, 0),
  ALLOC_TO_SOURCE_ID_CHAR_1 STRING,
  ALLOC_TO_SOURCE_ID_CHAR_2 STRING,
  ALLOC_TO_SOURCE_ID_CHAR_3 STRING,
  ALLOC_TO_SOURCE_ID_CHAR_4 STRING,
  ALLOC_TO_DISTRIBUTION_TYPE STRING,
  ALLOC_TO_DIST_ID_NUM_1 DECIMAL(15, 0),
  ALLOC_TO_DIST_ID_NUM_2 DECIMAL(15, 0),
  ALLOC_TO_DIST_ID_NUM_3 DECIMAL(15, 0),
  ALLOC_TO_DIST_ID_NUM_4 DECIMAL(15, 0),
  ALLOC_TO_DIST_ID_NUM_5 DECIMAL(15, 0),
  ALLOC_TO_DIST_ID_CHAR_1 STRING,
  ALLOC_TO_DIST_ID_CHAR_2 STRING,
  ALLOC_TO_DIST_ID_CHAR_3 STRING,
  ALLOC_TO_DIST_ID_CHAR_4 STRING,
  ALLOC_TO_DIST_ID_CHAR_5 STRING,
  GAIN_OR_LOSS_REF STRING,
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  KCA_SEQ_ID DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.XLA_DISTRIBUTION_LINKS (
  APPLICATION_ID,
  EVENT_ID,
  AE_HEADER_ID,
  AE_LINE_NUM,
  SOURCE_DISTRIBUTION_TYPE,
  SOURCE_DISTRIBUTION_ID_CHAR_1,
  SOURCE_DISTRIBUTION_ID_CHAR_2,
  SOURCE_DISTRIBUTION_ID_CHAR_3,
  SOURCE_DISTRIBUTION_ID_CHAR_4,
  SOURCE_DISTRIBUTION_ID_CHAR_5,
  SOURCE_DISTRIBUTION_ID_NUM_1,
  SOURCE_DISTRIBUTION_ID_NUM_2,
  SOURCE_DISTRIBUTION_ID_NUM_3,
  SOURCE_DISTRIBUTION_ID_NUM_4,
  SOURCE_DISTRIBUTION_ID_NUM_5,
  TAX_LINE_REF_ID,
  TAX_SUMMARY_LINE_REF_ID,
  TAX_REC_NREC_DIST_REF_ID,
  STATISTICAL_AMOUNT,
  REF_AE_HEADER_ID,
  REF_TEMP_LINE_NUM,
  ACCOUNTING_LINE_CODE,
  ACCOUNTING_LINE_TYPE_CODE,
  MERGE_DUPLICATE_CODE,
  TEMP_LINE_NUM,
  REF_EVENT_ID,
  LINE_DEFINITION_OWNER_CODE,
  LINE_DEFINITION_CODE,
  EVENT_CLASS_CODE,
  EVENT_TYPE_CODE,
  UPG_BATCH_ID,
  CALCULATE_ACCTD_AMTS_FLAG,
  CALCULATE_G_L_AMTS_FLAG,
  ROUNDING_CLASS_CODE,
  DOCUMENT_ROUNDING_LEVEL,
  UNROUNDED_ENTERED_DR,
  UNROUNDED_ENTERED_CR,
  DOC_ROUNDING_ENTERED_AMT,
  DOC_ROUNDING_ACCTD_AMT,
  UNROUNDED_ACCOUNTED_CR,
  UNROUNDED_ACCOUNTED_DR,
  APPLIED_TO_APPLICATION_ID,
  APPLIED_TO_ENTITY_CODE,
  APPLIED_TO_ENTITY_ID,
  APPLIED_TO_SOURCE_ID_NUM_1,
  APPLIED_TO_SOURCE_ID_NUM_2,
  APPLIED_TO_SOURCE_ID_NUM_3,
  APPLIED_TO_SOURCE_ID_NUM_4,
  APPLIED_TO_SOURCE_ID_CHAR_1,
  APPLIED_TO_SOURCE_ID_CHAR_2,
  APPLIED_TO_SOURCE_ID_CHAR_3,
  APPLIED_TO_SOURCE_ID_CHAR_4,
  APPLIED_TO_DISTRIBUTION_TYPE,
  APPLIED_TO_DIST_ID_NUM_1,
  APPLIED_TO_DIST_ID_NUM_2,
  APPLIED_TO_DIST_ID_NUM_3,
  APPLIED_TO_DIST_ID_NUM_4,
  APPLIED_TO_DIST_ID_NUM_5,
  APPLIED_TO_DIST_ID_CHAR_1,
  APPLIED_TO_DIST_ID_CHAR_2,
  APPLIED_TO_DIST_ID_CHAR_3,
  APPLIED_TO_DIST_ID_CHAR_4,
  APPLIED_TO_DIST_ID_CHAR_5,
  ALLOC_TO_APPLICATION_ID,
  ALLOC_TO_ENTITY_CODE,
  ALLOC_TO_SOURCE_ID_NUM_1,
  ALLOC_TO_SOURCE_ID_NUM_2,
  ALLOC_TO_SOURCE_ID_NUM_3,
  ALLOC_TO_SOURCE_ID_NUM_4,
  ALLOC_TO_SOURCE_ID_CHAR_1,
  ALLOC_TO_SOURCE_ID_CHAR_2,
  ALLOC_TO_SOURCE_ID_CHAR_3,
  ALLOC_TO_SOURCE_ID_CHAR_4,
  ALLOC_TO_DISTRIBUTION_TYPE,
  ALLOC_TO_DIST_ID_NUM_1,
  ALLOC_TO_DIST_ID_NUM_2,
  ALLOC_TO_DIST_ID_NUM_3,
  ALLOC_TO_DIST_ID_NUM_4,
  ALLOC_TO_DIST_ID_NUM_5,
  ALLOC_TO_DIST_ID_CHAR_1,
  ALLOC_TO_DIST_ID_CHAR_2,
  ALLOC_TO_DIST_ID_CHAR_3,
  ALLOC_TO_DIST_ID_CHAR_4,
  ALLOC_TO_DIST_ID_CHAR_5,
  GAIN_OR_LOSS_REF,
  KCA_OPERATION,
  IS_DELETED_FLG,
  KCA_SEQ_ID,
  kca_seq_date
)
SELECT
  APPLICATION_ID,
  EVENT_ID,
  AE_HEADER_ID,
  AE_LINE_NUM,
  SOURCE_DISTRIBUTION_TYPE,
  SOURCE_DISTRIBUTION_ID_CHAR_1,
  SOURCE_DISTRIBUTION_ID_CHAR_2,
  SOURCE_DISTRIBUTION_ID_CHAR_3,
  SOURCE_DISTRIBUTION_ID_CHAR_4,
  SOURCE_DISTRIBUTION_ID_CHAR_5,
  SOURCE_DISTRIBUTION_ID_NUM_1,
  SOURCE_DISTRIBUTION_ID_NUM_2,
  SOURCE_DISTRIBUTION_ID_NUM_3,
  SOURCE_DISTRIBUTION_ID_NUM_4,
  SOURCE_DISTRIBUTION_ID_NUM_5,
  TAX_LINE_REF_ID,
  TAX_SUMMARY_LINE_REF_ID,
  TAX_REC_NREC_DIST_REF_ID,
  STATISTICAL_AMOUNT,
  REF_AE_HEADER_ID,
  REF_TEMP_LINE_NUM,
  ACCOUNTING_LINE_CODE,
  ACCOUNTING_LINE_TYPE_CODE,
  MERGE_DUPLICATE_CODE,
  TEMP_LINE_NUM,
  REF_EVENT_ID,
  LINE_DEFINITION_OWNER_CODE,
  LINE_DEFINITION_CODE,
  EVENT_CLASS_CODE,
  EVENT_TYPE_CODE,
  UPG_BATCH_ID,
  CALCULATE_ACCTD_AMTS_FLAG,
  CALCULATE_G_L_AMTS_FLAG,
  ROUNDING_CLASS_CODE,
  DOCUMENT_ROUNDING_LEVEL,
  UNROUNDED_ENTERED_DR,
  UNROUNDED_ENTERED_CR,
  DOC_ROUNDING_ENTERED_AMT,
  DOC_ROUNDING_ACCTD_AMT,
  UNROUNDED_ACCOUNTED_CR,
  UNROUNDED_ACCOUNTED_DR,
  APPLIED_TO_APPLICATION_ID,
  APPLIED_TO_ENTITY_CODE,
  APPLIED_TO_ENTITY_ID,
  APPLIED_TO_SOURCE_ID_NUM_1,
  APPLIED_TO_SOURCE_ID_NUM_2,
  APPLIED_TO_SOURCE_ID_NUM_3,
  APPLIED_TO_SOURCE_ID_NUM_4,
  APPLIED_TO_SOURCE_ID_CHAR_1,
  APPLIED_TO_SOURCE_ID_CHAR_2,
  APPLIED_TO_SOURCE_ID_CHAR_3,
  APPLIED_TO_SOURCE_ID_CHAR_4,
  APPLIED_TO_DISTRIBUTION_TYPE,
  APPLIED_TO_DIST_ID_NUM_1,
  APPLIED_TO_DIST_ID_NUM_2,
  APPLIED_TO_DIST_ID_NUM_3,
  APPLIED_TO_DIST_ID_NUM_4,
  APPLIED_TO_DIST_ID_NUM_5,
  APPLIED_TO_DIST_ID_CHAR_1,
  APPLIED_TO_DIST_ID_CHAR_2,
  APPLIED_TO_DIST_ID_CHAR_3,
  APPLIED_TO_DIST_ID_CHAR_4,
  APPLIED_TO_DIST_ID_CHAR_5,
  ALLOC_TO_APPLICATION_ID,
  ALLOC_TO_ENTITY_CODE,
  ALLOC_TO_SOURCE_ID_NUM_1,
  ALLOC_TO_SOURCE_ID_NUM_2,
  ALLOC_TO_SOURCE_ID_NUM_3,
  ALLOC_TO_SOURCE_ID_NUM_4,
  ALLOC_TO_SOURCE_ID_CHAR_1,
  ALLOC_TO_SOURCE_ID_CHAR_2,
  ALLOC_TO_SOURCE_ID_CHAR_3,
  ALLOC_TO_SOURCE_ID_CHAR_4,
  ALLOC_TO_DISTRIBUTION_TYPE,
  ALLOC_TO_DIST_ID_NUM_1,
  ALLOC_TO_DIST_ID_NUM_2,
  ALLOC_TO_DIST_ID_NUM_3,
  ALLOC_TO_DIST_ID_NUM_4,
  ALLOC_TO_DIST_ID_NUM_5,
  ALLOC_TO_DIST_ID_CHAR_1,
  ALLOC_TO_DIST_ID_CHAR_2,
  ALLOC_TO_DIST_ID_CHAR_3,
  ALLOC_TO_DIST_ID_CHAR_4,
  ALLOC_TO_DIST_ID_CHAR_5,
  GAIN_OR_LOSS_REF,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.XLA_DISTRIBUTION_LINKS;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'xla_distribution_links';