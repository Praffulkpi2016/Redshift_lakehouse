DROP TABLE IF EXISTS silver_bec_ods.WIP_DISCRETE_JOBS;
CREATE TABLE IF NOT EXISTS silver_bec_ods.WIP_DISCRETE_JOBS (
  wip_entity_id DECIMAL(15, 0),
  organization_id DECIMAL(15, 0),
  last_update_date TIMESTAMP,
  last_updated_by DECIMAL(15, 0),
  creation_date TIMESTAMP,
  created_by DECIMAL(15, 0),
  last_update_login DECIMAL(15, 0),
  request_id DECIMAL(15, 0),
  program_application_id DECIMAL(15, 0),
  program_id DECIMAL(15, 0),
  program_update_date TIMESTAMP,
  source_line_id DECIMAL(15, 0),
  source_code STRING,
  description STRING,
  status_type DECIMAL(15, 0),
  primary_item_id DECIMAL(15, 0),
  firm_planned_flag DECIMAL(15, 0),
  job_type DECIMAL(15, 0),
  wip_supply_type DECIMAL(15, 0),
  class_code STRING,
  material_account DECIMAL(15, 0),
  material_overhead_account DECIMAL(15, 0),
  resource_account DECIMAL(15, 0),
  outside_processing_account DECIMAL(15, 0),
  material_variance_account DECIMAL(15, 0),
  resource_variance_account DECIMAL(15, 0),
  outside_proc_variance_account DECIMAL(15, 0),
  std_cost_adjustment_account DECIMAL(15, 0),
  overhead_account DECIMAL(15, 0),
  overhead_variance_account DECIMAL(15, 0),
  scheduled_start_date TIMESTAMP,
  date_released TIMESTAMP,
  scheduled_completion_date TIMESTAMP,
  date_completed TIMESTAMP,
  date_closed TIMESTAMP,
  start_quantity DECIMAL(28, 10),
  quantity_completed DECIMAL(28, 10),
  quantity_scrapped DECIMAL(28, 10),
  net_quantity DECIMAL(28, 10),
  bom_reference_id DECIMAL(15, 0),
  routing_reference_id DECIMAL(15, 0),
  common_bom_sequence_id DECIMAL(15, 0),
  common_routing_sequence_id DECIMAL(15, 0),
  bom_revision STRING,
  routing_revision STRING,
  bom_revision_date TIMESTAMP,
  routing_revision_date TIMESTAMP,
  lot_number STRING,
  alternate_bom_designator STRING,
  alternate_routing_designator STRING,
  completion_subinventory STRING,
  completion_locator_id DECIMAL(15, 0),
  mps_scheduled_completion_date TIMESTAMP,
  mps_net_quantity DECIMAL(28, 10),
  demand_class STRING,
  attribute_category STRING,
  attribute1 STRING,
  attribute2 STRING,
  attribute3 STRING,
  attribute4 STRING,
  attribute5 STRING,
  attribute6 STRING,
  attribute7 STRING,
  attribute8 STRING,
  attribute9 STRING,
  attribute10 STRING,
  attribute11 STRING,
  attribute12 STRING,
  attribute13 STRING,
  attribute14 STRING,
  attribute15 STRING,
  schedule_group_id DECIMAL(15, 0),
  build_sequence DECIMAL(15, 0),
  line_id DECIMAL(15, 0),
  project_id DECIMAL(15, 0),
  task_id DECIMAL(15, 0),
  kanban_card_id DECIMAL(15, 0),
  overcompletion_tolerance_type DECIMAL(15, 0),
  overcompletion_tolerance_value DECIMAL(28, 10),
  end_item_unit_number STRING,
  po_creation_time DECIMAL(28, 10),
  priority DECIMAL(15, 0),
  due_date TIMESTAMP,
  est_scrap_account DECIMAL(28, 10),
  est_scrap_var_account DECIMAL(28, 10),
  est_scrap_prior_qty DECIMAL(28, 10),
  due_date_penalty DECIMAL(15, 0),
  due_date_tolerance DECIMAL(15, 0),
  coproducts_supply DECIMAL(28, 10),
  parent_wip_entity_id DECIMAL(15, 0),
  asset_number STRING,
  asset_group_id DECIMAL(15, 0),
  rebuild_item_id DECIMAL(15, 0),
  rebuild_serial_number STRING,
  manual_rebuild_flag STRING,
  shutdown_type STRING,
  estimation_status DECIMAL(15, 0),
  requested_start_date TIMESTAMP,
  notification_required STRING,
  work_order_type STRING,
  owning_department DECIMAL(15, 0),
  activity_type STRING,
  activity_cause STRING,
  tagout_required STRING,
  plan_maintenance STRING,
  pm_schedule_id DECIMAL(15, 0),
  last_estimation_date TIMESTAMP,
  last_estimation_req_id DECIMAL(15, 0),
  activity_source STRING,
  serialization_start_op DECIMAL(15, 0),
  maintenance_object_id DECIMAL(15, 0),
  maintenance_object_type DECIMAL(28, 10),
  maintenance_object_source DECIMAL(28, 10),
  material_issue_by_mo STRING,
  scheduling_request_id DECIMAL(15, 0),
  issue_zero_cost_flag STRING,
  eam_linear_location_id DECIMAL(15, 0),
  actual_start_date TIMESTAMP,
  expected_hold_release_date TIMESTAMP,
  expedited STRING,
  job_note STRING,
  kca_operation STRING,
  is_deleted_flg STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.WIP_DISCRETE_JOBS (
  wip_entity_id,
  organization_id,
  last_update_date,
  last_updated_by,
  creation_date,
  created_by,
  last_update_login,
  request_id,
  program_application_id,
  program_id,
  program_update_date,
  source_line_id,
  source_code,
  description,
  status_type,
  primary_item_id,
  firm_planned_flag,
  job_type,
  wip_supply_type,
  class_code,
  material_account,
  material_overhead_account,
  resource_account,
  outside_processing_account,
  material_variance_account,
  resource_variance_account,
  outside_proc_variance_account,
  std_cost_adjustment_account,
  overhead_account,
  overhead_variance_account,
  scheduled_start_date,
  date_released,
  scheduled_completion_date,
  date_completed,
  date_closed,
  start_quantity,
  quantity_completed,
  quantity_scrapped,
  net_quantity,
  bom_reference_id,
  routing_reference_id,
  common_bom_sequence_id,
  common_routing_sequence_id,
  bom_revision,
  routing_revision,
  bom_revision_date,
  routing_revision_date,
  lot_number,
  alternate_bom_designator,
  alternate_routing_designator,
  completion_subinventory,
  completion_locator_id,
  mps_scheduled_completion_date,
  mps_net_quantity,
  demand_class,
  attribute_category,
  attribute1,
  attribute2,
  attribute3,
  attribute4,
  attribute5,
  attribute6,
  attribute7,
  attribute8,
  attribute9,
  attribute10,
  attribute11,
  attribute12,
  attribute13,
  attribute14,
  attribute15,
  schedule_group_id,
  build_sequence,
  line_id,
  project_id,
  task_id,
  kanban_card_id,
  overcompletion_tolerance_type,
  overcompletion_tolerance_value,
  end_item_unit_number,
  po_creation_time,
  priority,
  due_date,
  est_scrap_account,
  est_scrap_var_account,
  est_scrap_prior_qty,
  due_date_penalty,
  due_date_tolerance,
  coproducts_supply,
  parent_wip_entity_id,
  asset_number,
  asset_group_id,
  rebuild_item_id,
  rebuild_serial_number,
  manual_rebuild_flag,
  shutdown_type,
  estimation_status,
  requested_start_date,
  notification_required,
  work_order_type,
  owning_department,
  activity_type,
  activity_cause,
  tagout_required,
  plan_maintenance,
  pm_schedule_id,
  last_estimation_date,
  last_estimation_req_id,
  activity_source,
  serialization_start_op,
  maintenance_object_id,
  maintenance_object_type,
  maintenance_object_source,
  material_issue_by_mo,
  scheduling_request_id,
  issue_zero_cost_flag,
  eam_linear_location_id,
  actual_start_date,
  expected_hold_release_date,
  expedited,
  job_note,
  kca_operation,
  is_deleted_flg,
  kca_seq_id,
  kca_seq_date
)
SELECT
  wip_entity_id,
  organization_id,
  last_update_date,
  last_updated_by,
  creation_date,
  created_by,
  last_update_login,
  request_id,
  program_application_id,
  program_id,
  program_update_date,
  source_line_id,
  source_code,
  description,
  status_type,
  primary_item_id,
  firm_planned_flag,
  job_type,
  wip_supply_type,
  class_code,
  material_account,
  material_overhead_account,
  resource_account,
  outside_processing_account,
  material_variance_account,
  resource_variance_account,
  outside_proc_variance_account,
  std_cost_adjustment_account,
  overhead_account,
  overhead_variance_account,
  scheduled_start_date,
  date_released,
  scheduled_completion_date,
  date_completed,
  date_closed,
  start_quantity,
  quantity_completed,
  quantity_scrapped,
  net_quantity,
  bom_reference_id,
  routing_reference_id,
  common_bom_sequence_id,
  common_routing_sequence_id,
  bom_revision,
  routing_revision,
  bom_revision_date,
  routing_revision_date,
  lot_number,
  alternate_bom_designator,
  alternate_routing_designator,
  completion_subinventory,
  completion_locator_id,
  mps_scheduled_completion_date,
  mps_net_quantity,
  demand_class,
  attribute_category,
  attribute1,
  attribute2,
  attribute3,
  attribute4,
  attribute5,
  attribute6,
  attribute7,
  attribute8,
  attribute9,
  attribute10,
  attribute11,
  attribute12,
  attribute13,
  attribute14,
  attribute15,
  schedule_group_id,
  build_sequence,
  line_id,
  project_id,
  task_id,
  kanban_card_id,
  overcompletion_tolerance_type,
  overcompletion_tolerance_value,
  end_item_unit_number,
  po_creation_time,
  priority,
  due_date,
  est_scrap_account,
  est_scrap_var_account,
  est_scrap_prior_qty,
  due_date_penalty,
  due_date_tolerance,
  coproducts_supply,
  parent_wip_entity_id,
  asset_number,
  asset_group_id,
  rebuild_item_id,
  rebuild_serial_number,
  manual_rebuild_flag,
  shutdown_type,
  estimation_status,
  requested_start_date,
  notification_required,
  work_order_type,
  owning_department,
  activity_type,
  activity_cause,
  tagout_required,
  plan_maintenance,
  pm_schedule_id,
  last_estimation_date,
  last_estimation_req_id,
  activity_source,
  serialization_start_op,
  maintenance_object_id,
  maintenance_object_type,
  maintenance_object_source,
  material_issue_by_mo,
  scheduling_request_id,
  issue_zero_cost_flag,
  eam_linear_location_id,
  actual_start_date,
  expected_hold_release_date,
  expedited,
  job_note,
  kca_operation,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.WIP_DISCRETE_JOBS;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'wip_discrete_jobs';