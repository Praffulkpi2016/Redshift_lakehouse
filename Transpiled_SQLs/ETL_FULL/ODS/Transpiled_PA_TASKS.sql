DROP table IF EXISTS silver_bec_ods.PA_TASKS;
CREATE TABLE IF NOT EXISTS silver_bec_ods.PA_TASKS (
  TASK_ID DECIMAL(15, 0),
  PROJECT_ID DECIMAL(15, 0),
  TASK_NUMBER STRING,
  CREATION_DATE TIMESTAMP,
  CREATED_BY DECIMAL(15, 0),
  LAST_UPDATE_DATE TIMESTAMP,
  LAST_UPDATED_BY DECIMAL(15, 0),
  LAST_UPDATE_LOGIN DECIMAL(15, 0),
  TASK_NAME STRING,
  TOP_TASK_ID DECIMAL(15, 0),
  WBS_LEVEL DECIMAL(15, 0),
  READY_TO_BILL_FLAG STRING,
  READY_TO_DISTRIBUTE_FLAG STRING,
  PARENT_TASK_ID DECIMAL(15, 0),
  DESCRIPTION STRING,
  CARRYING_OUT_ORGANIZATION_ID DECIMAL(15, 0),
  SERVICE_TYPE_CODE STRING,
  TASK_MANAGER_PERSON_ID DECIMAL(15, 0),
  CHARGEABLE_FLAG STRING,
  BILLABLE_FLAG STRING,
  LIMIT_TO_TXN_CONTROLS_FLAG STRING,
  START_DATE TIMESTAMP,
  COMPLETION_DATE TIMESTAMP,
  ADDRESS_ID DECIMAL(15, 0),
  LABOR_BILL_RATE_ORG_ID DECIMAL(15, 0),
  LABOR_STD_BILL_RATE_SCHDL STRING,
  LABOR_SCHEDULE_FIXED_DATE TIMESTAMP,
  LABOR_SCHEDULE_DISCOUNT DECIMAL(28, 10),
  NON_LABOR_BILL_RATE_ORG_ID DECIMAL(15, 0),
  NON_LABOR_STD_BILL_RATE_SCHDL STRING,
  NON_LABOR_SCHEDULE_FIXED_DATE TIMESTAMP,
  NON_LABOR_SCHEDULE_DISCOUNT DECIMAL(28, 10),
  LABOR_COST_MULTIPLIER_NAME STRING,
  REQUEST_ID DECIMAL(15, 0),
  PROGRAM_APPLICATION_ID DECIMAL(15, 0),
  PROGRAM_ID DECIMAL(15, 0),
  PROGRAM_UPDATE_DATE TIMESTAMP,
  ATTRIBUTE_CATEGORY STRING,
  ATTRIBUTE1 STRING,
  ATTRIBUTE2 STRING,
  ATTRIBUTE3 STRING,
  ATTRIBUTE4 STRING,
  ATTRIBUTE5 STRING,
  ATTRIBUTE6 STRING,
  ATTRIBUTE7 STRING,
  ATTRIBUTE8 STRING,
  ATTRIBUTE9 STRING,
  ATTRIBUTE10 STRING,
  COST_IND_RATE_SCH_ID DECIMAL(15, 0),
  REV_IND_RATE_SCH_ID DECIMAL(15, 0),
  INV_IND_RATE_SCH_ID DECIMAL(15, 0),
  COST_IND_SCH_FIXED_DATE TIMESTAMP,
  REV_IND_SCH_FIXED_DATE TIMESTAMP,
  INV_IND_SCH_FIXED_DATE TIMESTAMP,
  LABOR_SCH_TYPE STRING,
  NON_LABOR_SCH_TYPE STRING,
  OVR_COST_IND_RATE_SCH_ID DECIMAL(15, 0),
  OVR_INV_IND_RATE_SCH_ID DECIMAL(15, 0),
  OVR_REV_IND_RATE_SCH_ID DECIMAL(15, 0),
  PM_PRODUCT_CODE STRING,
  PM_TASK_REFERENCE STRING,
  ACTUAL_START_DATE TIMESTAMP,
  ACTUAL_FINISH_DATE TIMESTAMP,
  EARLY_START_DATE TIMESTAMP,
  EARLY_FINISH_DATE TIMESTAMP,
  LATE_START_DATE TIMESTAMP,
  LATE_FINISH_DATE TIMESTAMP,
  SCHEDULED_START_DATE TIMESTAMP,
  SCHEDULED_FINISH_DATE TIMESTAMP,
  ADW_NOTIFY_FLAG STRING,
  ALLOW_CROSS_CHARGE_FLAG STRING,
  PROJECT_RATE_DATE TIMESTAMP,
  PROJECT_RATE_TYPE STRING,
  CC_PROCESS_LABOR_FLAG STRING,
  LABOR_TP_SCHEDULE_ID DECIMAL(15, 0),
  LABOR_TP_FIXED_DATE TIMESTAMP,
  CC_PROCESS_NL_FLAG STRING,
  NL_TP_SCHEDULE_ID DECIMAL(15, 0),
  NL_TP_FIXED_DATE TIMESTAMP,
  RECEIVE_PROJECT_INVOICE_FLAG STRING,
  WORK_TYPE_ID DECIMAL(15, 0),
  RECORD_VERSION_NUMBER DECIMAL(15, 0),
  JOB_BILL_RATE_SCHEDULE_ID DECIMAL(15, 0),
  EMP_BILL_RATE_SCHEDULE_ID DECIMAL(15, 0),
  TASKFUNC_COST_RATE_TYPE STRING,
  TASKFUNC_COST_RATE_DATE TIMESTAMP,
  NON_LAB_STD_BILL_RT_SCH_ID DECIMAL(15, 0),
  LABOR_DISC_REASON_CODE STRING,
  NON_LABOR_DISC_REASON_CODE STRING,
  LONG_TASK_NAME STRING,
  RETIREMENT_COST_FLAG STRING,
  CINT_ELIGIBLE_FLAG STRING,
  CINT_STOP_DATE TIMESTAMP,
  REVENUE_ACCRUAL_METHOD STRING,
  INVOICE_METHOD STRING,
  CUSTOMER_ID DECIMAL(15, 0),
  GEN_ETC_SOURCE_CODE STRING,
  BILL_SCHE_OVRD_FLAG STRING,
  ADJ_ON_STD_INV STRING,
  ALT_LIQUIDATION_RATE_PER DECIMAL(17, 2),
  BILL_GROUP_ID DECIMAL(15, 0),
  COST_PLUS_FIXED_FEE_FLAG STRING,
  FEE_PERCENTAGE DECIMAL(17, 2),
  FEE_RATE DECIMAL(25, 5),
  FEE_RATE_SCHEDULE_ID DECIMAL(15, 0),
  FEE_REVENUE_SCHEDULE_ID DECIMAL(15, 0),
  IC_LABOR_TP_FIXED_DATE TIMESTAMP,
  IC_LABOR_TP_SCHEDULE_ID DECIMAL(22, 0),
  IC_NL_TP_FIXED_DATE TIMESTAMP,
  IC_NL_TP_SCHEDULE_ID DECIMAL(22, 0),
  INV_LINE_GROUP STRING,
  LIQUIDATION_RATE_PERCENTAGE DECIMAL(17, 2),
  OVR_FEE_RATE_SCHEDULE_ID DECIMAL(15, 0),
  PROGRESS_PAYMENT_FLAG STRING,
  RATE_PERCENTAGE DECIMAL(17, 2),
  RETENTION_PERCENTAGE DECIMAL(17, 2),
  SUBCONTRACT_FLAG STRING,
  WITHHOLD_AMOUNT DECIMAL(22, 5),
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.PA_TASKS (
  TASK_ID,
  PROJECT_ID,
  TASK_NUMBER,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_LOGIN,
  TASK_NAME,
  TOP_TASK_ID,
  WBS_LEVEL,
  READY_TO_BILL_FLAG,
  READY_TO_DISTRIBUTE_FLAG,
  PARENT_TASK_ID,
  DESCRIPTION,
  CARRYING_OUT_ORGANIZATION_ID,
  SERVICE_TYPE_CODE,
  TASK_MANAGER_PERSON_ID,
  CHARGEABLE_FLAG,
  BILLABLE_FLAG,
  LIMIT_TO_TXN_CONTROLS_FLAG,
  START_DATE,
  COMPLETION_DATE,
  ADDRESS_ID,
  LABOR_BILL_RATE_ORG_ID,
  LABOR_STD_BILL_RATE_SCHDL,
  LABOR_SCHEDULE_FIXED_DATE,
  LABOR_SCHEDULE_DISCOUNT,
  NON_LABOR_BILL_RATE_ORG_ID,
  NON_LABOR_STD_BILL_RATE_SCHDL,
  NON_LABOR_SCHEDULE_FIXED_DATE,
  NON_LABOR_SCHEDULE_DISCOUNT,
  LABOR_COST_MULTIPLIER_NAME,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  COST_IND_RATE_SCH_ID,
  REV_IND_RATE_SCH_ID,
  INV_IND_RATE_SCH_ID,
  COST_IND_SCH_FIXED_DATE,
  REV_IND_SCH_FIXED_DATE,
  INV_IND_SCH_FIXED_DATE,
  LABOR_SCH_TYPE,
  NON_LABOR_SCH_TYPE,
  OVR_COST_IND_RATE_SCH_ID,
  OVR_INV_IND_RATE_SCH_ID,
  OVR_REV_IND_RATE_SCH_ID,
  PM_PRODUCT_CODE,
  PM_TASK_REFERENCE,
  ACTUAL_START_DATE,
  ACTUAL_FINISH_DATE,
  EARLY_START_DATE,
  EARLY_FINISH_DATE,
  LATE_START_DATE,
  LATE_FINISH_DATE,
  SCHEDULED_START_DATE,
  SCHEDULED_FINISH_DATE,
  ADW_NOTIFY_FLAG,
  ALLOW_CROSS_CHARGE_FLAG,
  PROJECT_RATE_DATE,
  PROJECT_RATE_TYPE,
  CC_PROCESS_LABOR_FLAG,
  LABOR_TP_SCHEDULE_ID,
  LABOR_TP_FIXED_DATE,
  CC_PROCESS_NL_FLAG,
  NL_TP_SCHEDULE_ID,
  NL_TP_FIXED_DATE,
  RECEIVE_PROJECT_INVOICE_FLAG,
  WORK_TYPE_ID,
  RECORD_VERSION_NUMBER,
  JOB_BILL_RATE_SCHEDULE_ID,
  EMP_BILL_RATE_SCHEDULE_ID,
  TASKFUNC_COST_RATE_TYPE,
  TASKFUNC_COST_RATE_DATE,
  NON_LAB_STD_BILL_RT_SCH_ID,
  LABOR_DISC_REASON_CODE,
  NON_LABOR_DISC_REASON_CODE,
  LONG_TASK_NAME,
  RETIREMENT_COST_FLAG,
  CINT_ELIGIBLE_FLAG,
  CINT_STOP_DATE,
  REVENUE_ACCRUAL_METHOD,
  INVOICE_METHOD,
  CUSTOMER_ID,
  GEN_ETC_SOURCE_CODE,
  BILL_SCHE_OVRD_FLAG,
  ADJ_ON_STD_INV,
  ALT_LIQUIDATION_RATE_PER,
  BILL_GROUP_ID,
  COST_PLUS_FIXED_FEE_FLAG,
  FEE_PERCENTAGE,
  FEE_RATE,
  FEE_RATE_SCHEDULE_ID,
  FEE_REVENUE_SCHEDULE_ID,
  IC_LABOR_TP_FIXED_DATE,
  IC_LABOR_TP_SCHEDULE_ID,
  IC_NL_TP_FIXED_DATE,
  IC_NL_TP_SCHEDULE_ID,
  INV_LINE_GROUP,
  LIQUIDATION_RATE_PERCENTAGE,
  OVR_FEE_RATE_SCHEDULE_ID,
  PROGRESS_PAYMENT_FLAG,
  RATE_PERCENTAGE,
  RETENTION_PERCENTAGE,
  SUBCONTRACT_FLAG,
  WITHHOLD_AMOUNT,
  KCA_OPERATION,
  IS_DELETED_FLG,
  KCA_SEQ_ID,
  kca_seq_date
)
(
  SELECT
    TASK_ID,
    PROJECT_ID,
    TASK_NUMBER,
    CREATION_DATE,
    CREATED_BY,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    LAST_UPDATE_LOGIN,
    TASK_NAME,
    TOP_TASK_ID,
    WBS_LEVEL,
    READY_TO_BILL_FLAG,
    READY_TO_DISTRIBUTE_FLAG,
    PARENT_TASK_ID,
    DESCRIPTION,
    CARRYING_OUT_ORGANIZATION_ID,
    SERVICE_TYPE_CODE,
    TASK_MANAGER_PERSON_ID,
    CHARGEABLE_FLAG,
    BILLABLE_FLAG,
    LIMIT_TO_TXN_CONTROLS_FLAG,
    START_DATE,
    COMPLETION_DATE,
    ADDRESS_ID,
    LABOR_BILL_RATE_ORG_ID,
    LABOR_STD_BILL_RATE_SCHDL,
    LABOR_SCHEDULE_FIXED_DATE,
    LABOR_SCHEDULE_DISCOUNT,
    NON_LABOR_BILL_RATE_ORG_ID,
    NON_LABOR_STD_BILL_RATE_SCHDL,
    NON_LABOR_SCHEDULE_FIXED_DATE,
    NON_LABOR_SCHEDULE_DISCOUNT,
    LABOR_COST_MULTIPLIER_NAME,
    REQUEST_ID,
    PROGRAM_APPLICATION_ID,
    PROGRAM_ID,
    PROGRAM_UPDATE_DATE,
    ATTRIBUTE_CATEGORY,
    ATTRIBUTE1,
    ATTRIBUTE2,
    ATTRIBUTE3,
    ATTRIBUTE4,
    ATTRIBUTE5,
    ATTRIBUTE6,
    ATTRIBUTE7,
    ATTRIBUTE8,
    ATTRIBUTE9,
    ATTRIBUTE10,
    COST_IND_RATE_SCH_ID,
    REV_IND_RATE_SCH_ID,
    INV_IND_RATE_SCH_ID,
    COST_IND_SCH_FIXED_DATE,
    REV_IND_SCH_FIXED_DATE,
    INV_IND_SCH_FIXED_DATE,
    LABOR_SCH_TYPE,
    NON_LABOR_SCH_TYPE,
    OVR_COST_IND_RATE_SCH_ID,
    OVR_INV_IND_RATE_SCH_ID,
    OVR_REV_IND_RATE_SCH_ID,
    PM_PRODUCT_CODE,
    PM_TASK_REFERENCE,
    ACTUAL_START_DATE,
    ACTUAL_FINISH_DATE,
    EARLY_START_DATE,
    EARLY_FINISH_DATE,
    LATE_START_DATE,
    LATE_FINISH_DATE,
    SCHEDULED_START_DATE,
    SCHEDULED_FINISH_DATE,
    ADW_NOTIFY_FLAG,
    ALLOW_CROSS_CHARGE_FLAG,
    PROJECT_RATE_DATE,
    PROJECT_RATE_TYPE,
    CC_PROCESS_LABOR_FLAG,
    LABOR_TP_SCHEDULE_ID,
    LABOR_TP_FIXED_DATE,
    CC_PROCESS_NL_FLAG,
    NL_TP_SCHEDULE_ID,
    NL_TP_FIXED_DATE,
    RECEIVE_PROJECT_INVOICE_FLAG,
    WORK_TYPE_ID,
    RECORD_VERSION_NUMBER,
    JOB_BILL_RATE_SCHEDULE_ID,
    EMP_BILL_RATE_SCHEDULE_ID,
    TASKFUNC_COST_RATE_TYPE,
    TASKFUNC_COST_RATE_DATE,
    NON_LAB_STD_BILL_RT_SCH_ID,
    LABOR_DISC_REASON_CODE,
    NON_LABOR_DISC_REASON_CODE,
    LONG_TASK_NAME,
    RETIREMENT_COST_FLAG,
    CINT_ELIGIBLE_FLAG,
    CINT_STOP_DATE,
    REVENUE_ACCRUAL_METHOD,
    INVOICE_METHOD,
    CUSTOMER_ID,
    GEN_ETC_SOURCE_CODE,
    BILL_SCHE_OVRD_FLAG,
    ADJ_ON_STD_INV,
    ALT_LIQUIDATION_RATE_PER,
    BILL_GROUP_ID,
    COST_PLUS_FIXED_FEE_FLAG,
    FEE_PERCENTAGE,
    FEE_RATE,
    FEE_RATE_SCHEDULE_ID,
    FEE_REVENUE_SCHEDULE_ID,
    IC_LABOR_TP_FIXED_DATE,
    IC_LABOR_TP_SCHEDULE_ID,
    IC_NL_TP_FIXED_DATE,
    IC_NL_TP_SCHEDULE_ID,
    INV_LINE_GROUP,
    LIQUIDATION_RATE_PERCENTAGE,
    OVR_FEE_RATE_SCHEDULE_ID,
    PROGRESS_PAYMENT_FLAG,
    RATE_PERCENTAGE,
    RETENTION_PERCENTAGE,
    SUBCONTRACT_FLAG,
    WITHHOLD_AMOUNT,
    KCA_OPERATION,
    'N' AS IS_DELETED_FLG,
    CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
    kca_seq_date
  FROM bronze_bec_ods_stg.PA_TASKS
);
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'pa_tasks';