DROP TABLE IF EXISTS silver_bec_ods.CSF_DEBRIEF_LINES;
CREATE TABLE IF NOT EXISTS silver_bec_ods.CSF_DEBRIEF_LINES (
  DEBRIEF_LINE_ID DECIMAL(15, 0),
  DEBRIEF_HEADER_ID DECIMAL(15, 0),
  DEBRIEF_LINE_NUMBER DECIMAL(15, 0),
  SERVICE_DATE TIMESTAMP,
  TXN_BILLING_TYPE_ID DECIMAL(15, 0),
  INVENTORY_ITEM_ID DECIMAL(15, 0),
  ISSUING_INVENTORY_ORG_ID DECIMAL(15, 0),
  RECEIVING_INVENTORY_ORG_ID DECIMAL(15, 0),
  ISSUING_SUB_INVENTORY_CODE STRING,
  RECEIVING_SUB_INVENTORY_CODE STRING,
  ISSUING_LOCATOR_ID DECIMAL(15, 0),
  RECEIVING_LOCATOR_ID DECIMAL(15, 0),
  PARENT_PRODUCT_ID DECIMAL(15, 0),
  REMOVED_PRODUCT_ID DECIMAL(15, 0),
  STATUS_OF_RECEIVED_PART STRING,
  ITEM_SERIAL_NUMBER STRING,
  ITEM_REVISION STRING,
  ITEM_LOTNUMBER STRING,
  UOM_CODE STRING,
  QUANTITY DECIMAL(28, 10),
  RMA_HEADER_ID DECIMAL(15, 0),
  DISPOSITION_CODE STRING,
  MATERIAL_REASON_CODE STRING,
  LABOR_REASON_CODE STRING,
  EXPENSE_REASON_CODE STRING,
  LABOR_START_DATE TIMESTAMP,
  LABOR_END_DATE TIMESTAMP,
  STARTING_MILEAGE DECIMAL(28, 10),
  ENDING_MILEAGE DECIMAL(28, 10),
  EXPENSE_AMOUNT DECIMAL(28, 10),
  CURRENCY_CODE STRING,
  DEBRIEF_LINE_STATUS_ID DECIMAL(15, 0),
  CHANNEL_CODE STRING,
  CHARGE_UPLOAD_STATUS STRING,
  CHARGE_UPLOAD_MSG_CODE STRING,
  CHARGE_UPLOAD_MESSAGE STRING,
  IB_UPDATE_STATUS STRING,
  IB_UPDATE_MSG_CODE STRING,
  IB_UPDATE_MESSAGE STRING,
  SPARE_UPDATE_STATUS STRING,
  SPARE_UPDATE_MSG_CODE STRING,
  SPARE_UPDATE_MESSAGE STRING,
  CREATED_BY DECIMAL(15, 0),
  CREATION_DATE TIMESTAMP,
  LAST_UPDATED_BY DECIMAL(15, 0),
  LAST_UPDATE_DATE TIMESTAMP,
  LAST_UPDATE_LOGIN DECIMAL(15, 0),
  ATTRIBUTE1 STRING,
  ATTRIBUTE2 STRING,
  ATTRIBUTE3 STRING,
  ATTRIBUTE4 STRING,
  ATTRIBUTE5 STRING,
  ATTRIBUTE6 STRING,
  ATTRIBUTE7 STRING,
  ATTRIBUTE8 STRING,
  ATTRIBUTE9 STRING,
  ATTRIBUTE10 STRING,
  ATTRIBUTE11 STRING,
  ATTRIBUTE12 STRING,
  ATTRIBUTE13 STRING,
  ATTRIBUTE14 STRING,
  ATTRIBUTE15 STRING,
  ATTRIBUTE_CATEGORY STRING,
  SECURITY_GROUP_ID DECIMAL(15, 0),
  UPG_ORIG_SYSTEM_REF STRING,
  UPG_ORIG_SYSTEM_REF_ID DECIMAL(15, 0),
  BUSINESS_PROCESS_ID DECIMAL(15, 0),
  RETURN_REASON_CODE STRING,
  INSTANCE_ID DECIMAL(15, 0),
  STATISTICS_UPDATED STRING,
  ERROR_TEXT STRING,
  TRANSACTION_TYPE_ID DECIMAL(15, 0),
  RETURN_DATE TIMESTAMP,
  OBJECT_VERSION_NUMBER DECIMAL(15, 0),
  ITEM_OPERATIONAL_STATUS_CODE STRING,
  MATERIAL_TRANSACTION_ID DECIMAL(15, 0),
  USAGE_TYPE STRING,
  RETURN_ORGANIZATION_ID DECIMAL(15, 0),
  RETURN_SUBINVENTORY_NAME STRING,
  CARRIER_CODE STRING,
  SHIPPING_METHOD STRING,
  SHIPPING_NUMBER STRING,
  WAYBILL STRING,
  EXPENDITURE_ORG_ID DECIMAL(15, 0),
  PROJECT_ID DECIMAL(15, 0),
  PROJECT_TASK_ID DECIMAL(15, 0),
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.CSF_DEBRIEF_LINES (
  DEBRIEF_LINE_ID,
  DEBRIEF_HEADER_ID,
  DEBRIEF_LINE_NUMBER,
  SERVICE_DATE,
  TXN_BILLING_TYPE_ID,
  INVENTORY_ITEM_ID,
  ISSUING_INVENTORY_ORG_ID,
  RECEIVING_INVENTORY_ORG_ID,
  ISSUING_SUB_INVENTORY_CODE,
  RECEIVING_SUB_INVENTORY_CODE,
  ISSUING_LOCATOR_ID,
  RECEIVING_LOCATOR_ID,
  PARENT_PRODUCT_ID,
  REMOVED_PRODUCT_ID,
  STATUS_OF_RECEIVED_PART,
  ITEM_SERIAL_NUMBER,
  ITEM_REVISION,
  ITEM_LOTNUMBER,
  UOM_CODE,
  QUANTITY,
  RMA_HEADER_ID,
  DISPOSITION_CODE,
  MATERIAL_REASON_CODE,
  LABOR_REASON_CODE,
  EXPENSE_REASON_CODE,
  LABOR_START_DATE,
  LABOR_END_DATE,
  STARTING_MILEAGE,
  ENDING_MILEAGE,
  EXPENSE_AMOUNT,
  CURRENCY_CODE,
  DEBRIEF_LINE_STATUS_ID,
  CHANNEL_CODE,
  CHARGE_UPLOAD_STATUS,
  CHARGE_UPLOAD_MSG_CODE,
  CHARGE_UPLOAD_MESSAGE,
  IB_UPDATE_STATUS,
  IB_UPDATE_MSG_CODE,
  IB_UPDATE_MESSAGE,
  SPARE_UPDATE_STATUS,
  SPARE_UPDATE_MSG_CODE,
  SPARE_UPDATE_MESSAGE,
  CREATED_BY,
  CREATION_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATE_LOGIN,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  ATTRIBUTE_CATEGORY,
  SECURITY_GROUP_ID,
  UPG_ORIG_SYSTEM_REF,
  UPG_ORIG_SYSTEM_REF_ID,
  BUSINESS_PROCESS_ID,
  RETURN_REASON_CODE,
  INSTANCE_ID,
  STATISTICS_UPDATED,
  ERROR_TEXT,
  TRANSACTION_TYPE_ID,
  RETURN_DATE,
  OBJECT_VERSION_NUMBER,
  ITEM_OPERATIONAL_STATUS_CODE,
  MATERIAL_TRANSACTION_ID,
  USAGE_TYPE,
  RETURN_ORGANIZATION_ID,
  RETURN_SUBINVENTORY_NAME,
  CARRIER_CODE,
  SHIPPING_METHOD,
  SHIPPING_NUMBER,
  WAYBILL,
  EXPENDITURE_ORG_ID,
  PROJECT_ID,
  PROJECT_TASK_ID,
  KCA_OPERATION,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
SELECT
  DEBRIEF_LINE_ID,
  DEBRIEF_HEADER_ID,
  DEBRIEF_LINE_NUMBER,
  SERVICE_DATE,
  TXN_BILLING_TYPE_ID,
  INVENTORY_ITEM_ID,
  ISSUING_INVENTORY_ORG_ID,
  RECEIVING_INVENTORY_ORG_ID,
  ISSUING_SUB_INVENTORY_CODE,
  RECEIVING_SUB_INVENTORY_CODE,
  ISSUING_LOCATOR_ID,
  RECEIVING_LOCATOR_ID,
  PARENT_PRODUCT_ID,
  REMOVED_PRODUCT_ID,
  STATUS_OF_RECEIVED_PART,
  ITEM_SERIAL_NUMBER,
  ITEM_REVISION,
  ITEM_LOTNUMBER,
  UOM_CODE,
  QUANTITY,
  RMA_HEADER_ID,
  DISPOSITION_CODE,
  MATERIAL_REASON_CODE,
  LABOR_REASON_CODE,
  EXPENSE_REASON_CODE,
  LABOR_START_DATE,
  LABOR_END_DATE,
  STARTING_MILEAGE,
  ENDING_MILEAGE,
  EXPENSE_AMOUNT,
  CURRENCY_CODE,
  DEBRIEF_LINE_STATUS_ID,
  CHANNEL_CODE,
  CHARGE_UPLOAD_STATUS,
  CHARGE_UPLOAD_MSG_CODE,
  CHARGE_UPLOAD_MESSAGE,
  IB_UPDATE_STATUS,
  IB_UPDATE_MSG_CODE,
  IB_UPDATE_MESSAGE,
  SPARE_UPDATE_STATUS,
  SPARE_UPDATE_MSG_CODE,
  SPARE_UPDATE_MESSAGE,
  CREATED_BY,
  CREATION_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATE_LOGIN,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  ATTRIBUTE_CATEGORY,
  SECURITY_GROUP_ID,
  UPG_ORIG_SYSTEM_REF,
  UPG_ORIG_SYSTEM_REF_ID,
  BUSINESS_PROCESS_ID,
  RETURN_REASON_CODE,
  INSTANCE_ID,
  STATISTICS_UPDATED,
  ERROR_TEXT,
  TRANSACTION_TYPE_ID,
  RETURN_DATE,
  OBJECT_VERSION_NUMBER,
  ITEM_OPERATIONAL_STATUS_CODE,
  MATERIAL_TRANSACTION_ID,
  USAGE_TYPE,
  RETURN_ORGANIZATION_ID,
  RETURN_SUBINVENTORY_NAME,
  CARRIER_CODE,
  SHIPPING_METHOD,
  SHIPPING_NUMBER,
  WAYBILL,
  EXPENDITURE_ORG_ID,
  PROJECT_ID,
  PROJECT_TASK_ID,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.CSF_DEBRIEF_LINES;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'csf_debrief_lines';