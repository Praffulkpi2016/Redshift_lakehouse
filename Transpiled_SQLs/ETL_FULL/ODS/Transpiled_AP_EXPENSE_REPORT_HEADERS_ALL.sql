DROP TABLE IF EXISTS silver_bec_ods.AP_EXPENSE_REPORT_HEADERS_ALL;
CREATE TABLE IF NOT EXISTS silver_bec_ods.AP_EXPENSE_REPORT_HEADERS_ALL (
  report_header_id DECIMAL(15, 0),
  employee_id DECIMAL(10, 0),
  week_end_date TIMESTAMP,
  creation_date TIMESTAMP,
  created_by DECIMAL(15, 0),
  last_update_date TIMESTAMP,
  last_updated_by DECIMAL(15, 0),
  vouchno DECIMAL(15, 0),
  total DECIMAL(28, 10),
  vendor_id DECIMAL(15, 0),
  vendor_site_id DECIMAL(15, 0),
  expense_check_address_flag STRING,
  reference_1 STRING,
  reference_2 STRING,
  invoice_num STRING,
  expense_report_id DECIMAL(15, 0),
  accts_pay_code_combination_id DECIMAL(15, 0),
  set_of_books_id DECIMAL(15, 0),
  source STRING,
  purgeable_flag STRING,
  accounting_date TIMESTAMP,
  maximum_amount_to_apply DECIMAL(28, 10),
  advance_invoice_to_apply DECIMAL(15, 0),
  apply_advances_default STRING,
  employee_ccid DECIMAL(15, 0),
  description STRING,
  reject_code STRING,
  hold_lookup_code STRING,
  attribute_category STRING,
  attribute1 STRING,
  attribute2 STRING,
  attribute3 STRING,
  attribute4 STRING,
  attribute5 STRING,
  attribute6 STRING,
  attribute7 STRING,
  attribute8 STRING,
  attribute9 STRING,
  attribute10 STRING,
  attribute11 STRING,
  attribute12 STRING,
  attribute13 STRING,
  attribute14 STRING,
  attribute15 STRING,
  default_currency_code STRING,
  default_exchange_rate_type STRING,
  default_exchange_rate DECIMAL(28, 10),
  default_exchange_date TIMESTAMP,
  last_update_login DECIMAL(15, 0),
  voucher_num STRING,
  ussgl_transaction_code STRING,
  ussgl_trx_code_context STRING,
  doc_category_code STRING,
  awt_group_id DECIMAL(15, 0),
  org_id DECIMAL(15, 0),
  workflow_approved_flag STRING,
  flex_concatenated STRING,
  global_attribute_category STRING,
  global_attribute1 STRING,
  global_attribute2 STRING,
  global_attribute3 STRING,
  global_attribute4 STRING,
  global_attribute5 STRING,
  global_attribute6 STRING,
  global_attribute7 STRING,
  global_attribute8 STRING,
  global_attribute9 STRING,
  global_attribute10 STRING,
  global_attribute11 STRING,
  global_attribute12 STRING,
  global_attribute13 STRING,
  global_attribute14 STRING,
  global_attribute15 STRING,
  global_attribute16 STRING,
  global_attribute17 STRING,
  global_attribute18 STRING,
  global_attribute19 STRING,
  global_attribute20 STRING,
  override_approver_id DECIMAL(9, 0),
  payment_cross_rate_type STRING,
  payment_cross_rate_date TIMESTAMP,
  payment_cross_rate DECIMAL(28, 10),
  payment_currency_code STRING,
  core_wf_status_flag STRING,
  prepay_apply_flag STRING,
  prepay_num STRING,
  prepay_dist_num DECIMAL(15, 0),
  prepay_apply_amount DECIMAL(28, 10),
  prepay_gl_date TIMESTAMP,
  bothpay_parent_id DECIMAL(15, 0),
  shortpay_parent_id DECIMAL(15, 0),
  paid_on_behalf_employee_id DECIMAL(15, 0),
  override_approver_name STRING,
  amt_due_ccard_company DECIMAL(28, 10),
  amt_due_employee DECIMAL(28, 10),
  default_receipt_currency_code STRING,
  multiple_currencies_flag STRING,
  expense_status_code STRING,
  expense_last_status_date TIMESTAMP,
  expense_current_approver_id DECIMAL(15, 0),
  report_filing_number STRING,
  receipts_received_date TIMESTAMP,
  audit_code STRING,
  report_submitted_date TIMESTAMP,
  last_audited_by DECIMAL(15, 0),
  return_reason_code STRING,
  return_instruction STRING,
  receipts_status STRING,
  holding_report_header_id DECIMAL(15, 0),
  request_id DECIMAL(15, 0),
  advances_justification STRING,
  IMAGE_RECEIPTS_STATUS STRING,
  IMAGE_RECEIPTS_RECEIVED_DATE TIMESTAMP,
  MISSING_IMG_JUST STRING,
  APPROVAL_TYPE STRING,
  OVERDUE_REQUEST_ID DECIMAL(15, 0),
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.AP_EXPENSE_REPORT_HEADERS_ALL (
  REPORT_HEADER_ID,
  EMPLOYEE_ID,
  WEEK_END_DATE,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  VOUCHNO,
  TOTAL,
  VENDOR_ID,
  VENDOR_SITE_ID,
  EXPENSE_CHECK_ADDRESS_FLAG,
  REFERENCE_1,
  REFERENCE_2,
  INVOICE_NUM,
  EXPENSE_REPORT_ID,
  ACCTS_PAY_CODE_COMBINATION_ID,
  SET_OF_BOOKS_ID,
  `SOURCE`,
  PURGEABLE_FLAG,
  ACCOUNTING_DATE,
  MAXIMUM_AMOUNT_TO_APPLY,
  ADVANCE_INVOICE_TO_APPLY,
  APPLY_ADVANCES_DEFAULT,
  EMPLOYEE_CCID,
  DESCRIPTION,
  REJECT_CODE,
  HOLD_LOOKUP_CODE,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  DEFAULT_CURRENCY_CODE,
  DEFAULT_EXCHANGE_RATE_TYPE,
  DEFAULT_EXCHANGE_RATE,
  DEFAULT_EXCHANGE_DATE,
  LAST_UPDATE_LOGIN,
  VOUCHER_NUM,
  USSGL_TRANSACTION_CODE,
  USSGL_TRX_CODE_CONTEXT,
  DOC_CATEGORY_CODE,
  AWT_GROUP_ID,
  ORG_ID,
  WORKFLOW_APPROVED_FLAG,
  FLEX_CONCATENATED,
  GLOBAL_ATTRIBUTE_CATEGORY,
  GLOBAL_ATTRIBUTE1,
  GLOBAL_ATTRIBUTE2,
  GLOBAL_ATTRIBUTE3,
  GLOBAL_ATTRIBUTE4,
  GLOBAL_ATTRIBUTE5,
  GLOBAL_ATTRIBUTE6,
  GLOBAL_ATTRIBUTE7,
  GLOBAL_ATTRIBUTE8,
  GLOBAL_ATTRIBUTE9,
  GLOBAL_ATTRIBUTE10,
  GLOBAL_ATTRIBUTE11,
  GLOBAL_ATTRIBUTE12,
  GLOBAL_ATTRIBUTE13,
  GLOBAL_ATTRIBUTE14,
  GLOBAL_ATTRIBUTE15,
  GLOBAL_ATTRIBUTE16,
  GLOBAL_ATTRIBUTE17,
  GLOBAL_ATTRIBUTE18,
  GLOBAL_ATTRIBUTE19,
  GLOBAL_ATTRIBUTE20,
  OVERRIDE_APPROVER_ID,
  PAYMENT_CROSS_RATE_TYPE,
  PAYMENT_CROSS_RATE_DATE,
  PAYMENT_CROSS_RATE,
  PAYMENT_CURRENCY_CODE,
  CORE_WF_STATUS_FLAG,
  PREPAY_APPLY_FLAG,
  PREPAY_NUM,
  PREPAY_DIST_NUM,
  PREPAY_APPLY_AMOUNT,
  PREPAY_GL_DATE,
  BOTHPAY_PARENT_ID,
  SHORTPAY_PARENT_ID,
  PAID_ON_BEHALF_EMPLOYEE_ID,
  OVERRIDE_APPROVER_NAME,
  AMT_DUE_CCARD_COMPANY,
  AMT_DUE_EMPLOYEE,
  DEFAULT_RECEIPT_CURRENCY_CODE,
  MULTIPLE_CURRENCIES_FLAG,
  EXPENSE_STATUS_CODE,
  EXPENSE_LAST_STATUS_DATE,
  EXPENSE_CURRENT_APPROVER_ID,
  REPORT_FILING_NUMBER,
  RECEIPTS_RECEIVED_DATE,
  AUDIT_CODE,
  REPORT_SUBMITTED_DATE,
  LAST_AUDITED_BY,
  RETURN_REASON_CODE,
  RETURN_INSTRUCTION,
  RECEIPTS_STATUS,
  HOLDING_REPORT_HEADER_ID,
  REQUEST_ID,
  ADVANCES_JUSTIFICATION,
  IMAGE_RECEIPTS_STATUS,
  IMAGE_RECEIPTS_RECEIVED_DATE,
  MISSING_IMG_JUST,
  APPROVAL_TYPE,
  OVERDUE_REQUEST_ID,
  KCA_OPERATION,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
SELECT
  REPORT_HEADER_ID,
  EMPLOYEE_ID,
  WEEK_END_DATE,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  VOUCHNO,
  TOTAL,
  VENDOR_ID,
  VENDOR_SITE_ID,
  EXPENSE_CHECK_ADDRESS_FLAG,
  REFERENCE_1,
  REFERENCE_2,
  INVOICE_NUM,
  EXPENSE_REPORT_ID,
  ACCTS_PAY_CODE_COMBINATION_ID,
  SET_OF_BOOKS_ID,
  `SOURCE`,
  PURGEABLE_FLAG,
  ACCOUNTING_DATE,
  MAXIMUM_AMOUNT_TO_APPLY,
  ADVANCE_INVOICE_TO_APPLY,
  APPLY_ADVANCES_DEFAULT,
  EMPLOYEE_CCID,
  DESCRIPTION,
  REJECT_CODE,
  HOLD_LOOKUP_CODE,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  DEFAULT_CURRENCY_CODE,
  DEFAULT_EXCHANGE_RATE_TYPE,
  DEFAULT_EXCHANGE_RATE,
  DEFAULT_EXCHANGE_DATE,
  LAST_UPDATE_LOGIN,
  VOUCHER_NUM,
  USSGL_TRANSACTION_CODE,
  USSGL_TRX_CODE_CONTEXT,
  DOC_CATEGORY_CODE,
  AWT_GROUP_ID,
  ORG_ID,
  WORKFLOW_APPROVED_FLAG,
  FLEX_CONCATENATED,
  GLOBAL_ATTRIBUTE_CATEGORY,
  GLOBAL_ATTRIBUTE1,
  GLOBAL_ATTRIBUTE2,
  GLOBAL_ATTRIBUTE3,
  GLOBAL_ATTRIBUTE4,
  GLOBAL_ATTRIBUTE5,
  GLOBAL_ATTRIBUTE6,
  GLOBAL_ATTRIBUTE7,
  GLOBAL_ATTRIBUTE8,
  GLOBAL_ATTRIBUTE9,
  GLOBAL_ATTRIBUTE10,
  GLOBAL_ATTRIBUTE11,
  GLOBAL_ATTRIBUTE12,
  GLOBAL_ATTRIBUTE13,
  GLOBAL_ATTRIBUTE14,
  GLOBAL_ATTRIBUTE15,
  GLOBAL_ATTRIBUTE16,
  GLOBAL_ATTRIBUTE17,
  GLOBAL_ATTRIBUTE18,
  GLOBAL_ATTRIBUTE19,
  GLOBAL_ATTRIBUTE20,
  OVERRIDE_APPROVER_ID,
  PAYMENT_CROSS_RATE_TYPE,
  PAYMENT_CROSS_RATE_DATE,
  PAYMENT_CROSS_RATE,
  PAYMENT_CURRENCY_CODE,
  CORE_WF_STATUS_FLAG,
  PREPAY_APPLY_FLAG,
  PREPAY_NUM,
  PREPAY_DIST_NUM,
  PREPAY_APPLY_AMOUNT,
  PREPAY_GL_DATE,
  BOTHPAY_PARENT_ID,
  SHORTPAY_PARENT_ID,
  PAID_ON_BEHALF_EMPLOYEE_ID,
  OVERRIDE_APPROVER_NAME,
  AMT_DUE_CCARD_COMPANY,
  AMT_DUE_EMPLOYEE,
  DEFAULT_RECEIPT_CURRENCY_CODE,
  MULTIPLE_CURRENCIES_FLAG,
  EXPENSE_STATUS_CODE,
  EXPENSE_LAST_STATUS_DATE,
  EXPENSE_CURRENT_APPROVER_ID,
  REPORT_FILING_NUMBER,
  RECEIPTS_RECEIVED_DATE,
  AUDIT_CODE,
  REPORT_SUBMITTED_DATE,
  LAST_AUDITED_BY,
  RETURN_REASON_CODE,
  RETURN_INSTRUCTION,
  RECEIPTS_STATUS,
  HOLDING_REPORT_HEADER_ID,
  REQUEST_ID,
  ADVANCES_JUSTIFICATION,
  IMAGE_RECEIPTS_STATUS,
  IMAGE_RECEIPTS_RECEIVED_DATE,
  MISSING_IMG_JUST,
  APPROVAL_TYPE,
  OVERDUE_REQUEST_ID,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.AP_EXPENSE_REPORT_HEADERS_ALL;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'ap_expense_report_headers_all';