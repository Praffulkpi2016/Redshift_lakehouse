DROP table IF EXISTS silver_bec_ods.GL_JE_LINES;
CREATE TABLE IF NOT EXISTS silver_bec_ods.GL_JE_LINES (
  JE_HEADER_ID DECIMAL(15, 0),
  JE_LINE_NUM DECIMAL(15, 0),
  LAST_UPDATE_DATE TIMESTAMP,
  LAST_UPDATED_BY DECIMAL(15, 0),
  LEDGER_ID DECIMAL(15, 0),
  CODE_COMBINATION_ID DECIMAL(15, 0),
  PERIOD_NAME STRING,
  EFFECTIVE_DATE TIMESTAMP,
  STATUS STRING,
  CREATION_DATE TIMESTAMP,
  CREATED_BY DECIMAL(15, 0),
  LAST_UPDATE_LOGIN DECIMAL(15, 0),
  ENTERED_DR DECIMAL(28, 10),
  ENTERED_CR DECIMAL(28, 10),
  ACCOUNTED_DR DECIMAL(28, 10),
  ACCOUNTED_CR DECIMAL(28, 10),
  DESCRIPTION STRING,
  REFERENCE_1 STRING,
  REFERENCE_2 STRING,
  REFERENCE_3 STRING,
  REFERENCE_4 STRING,
  REFERENCE_5 STRING,
  ATTRIBUTE1 STRING,
  ATTRIBUTE2 STRING,
  ATTRIBUTE3 STRING,
  ATTRIBUTE4 STRING,
  ATTRIBUTE5 STRING,
  ATTRIBUTE6 STRING,
  ATTRIBUTE7 STRING,
  ATTRIBUTE8 STRING,
  ATTRIBUTE9 STRING,
  ATTRIBUTE10 STRING,
  ATTRIBUTE11 STRING,
  ATTRIBUTE12 STRING,
  ATTRIBUTE13 STRING,
  ATTRIBUTE14 STRING,
  ATTRIBUTE15 STRING,
  ATTRIBUTE16 STRING,
  ATTRIBUTE17 STRING,
  ATTRIBUTE18 STRING,
  ATTRIBUTE19 STRING,
  ATTRIBUTE20 STRING,
  CONTEXT STRING,
  CONTEXT2 STRING,
  INVOICE_DATE TIMESTAMP,
  TAX_CODE STRING,
  INVOICE_IDENTIFIER STRING,
  INVOICE_AMOUNT DECIMAL(28, 10),
  NO1 STRING,
  STAT_AMOUNT DECIMAL(28, 10),
  IGNORE_RATE_FLAG STRING,
  CONTEXT3 STRING,
  USSGL_TRANSACTION_CODE STRING,
  SUBLEDGER_DOC_SEQUENCE_ID DECIMAL(15, 0),
  CONTEXT4 STRING,
  SUBLEDGER_DOC_SEQUENCE_VALUE DECIMAL(28, 10),
  REFERENCE_6 STRING,
  REFERENCE_7 STRING,
  REFERENCE_8 STRING,
  REFERENCE_9 STRING,
  REFERENCE_10 STRING,
  JGZZ_RECON_STATUS_11I STRING,
  JGZZ_RECON_DATE_11I TIMESTAMP,
  JGZZ_RECON_ID_11I DECIMAL(28, 10),
  JGZZ_RECON_REF_11I STRING,
  JGZZ_RECON_CONTEXT_11I STRING,
  GLOBAL_ATTRIBUTE_CATEGORY STRING,
  GLOBAL_ATTRIBUTE1 STRING,
  GLOBAL_ATTRIBUTE2 STRING,
  GLOBAL_ATTRIBUTE3 STRING,
  GLOBAL_ATTRIBUTE4 STRING,
  GLOBAL_ATTRIBUTE5 STRING,
  GLOBAL_ATTRIBUTE6 STRING,
  GLOBAL_ATTRIBUTE7 STRING,
  GLOBAL_ATTRIBUTE8 STRING,
  GLOBAL_ATTRIBUTE9 STRING,
  GLOBAL_ATTRIBUTE10 STRING,
  TAXABLE_LINE_FLAG STRING,
  TAX_TYPE_CODE STRING,
  TAX_CODE_ID DECIMAL(15, 0),
  TAX_ROUNDING_RULE_CODE STRING,
  AMOUNT_INCLUDES_TAX_FLAG STRING,
  TAX_DOCUMENT_IDENTIFIER STRING,
  TAX_DOCUMENT_DATE TIMESTAMP,
  TAX_CUSTOMER_NAME STRING,
  TAX_CUSTOMER_REFERENCE STRING,
  TAX_REGISTRATION_NUMBER STRING,
  TAX_LINE_FLAG STRING,
  TAX_GROUP_ID DECIMAL(15, 0),
  LINE_TYPE_CODE STRING,
  GL_SL_LINK_ID DECIMAL(15, 0),
  GL_SL_LINK_TABLE STRING,
  CO_THIRD_PARTY STRING,
  CO_PROCESSED_FLAG STRING,
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.GL_JE_LINES (
  JE_HEADER_ID,
  JE_LINE_NUM,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  LEDGER_ID,
  CODE_COMBINATION_ID,
  PERIOD_NAME,
  EFFECTIVE_DATE,
  STATUS,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_LOGIN,
  ENTERED_DR,
  ENTERED_CR,
  ACCOUNTED_DR,
  ACCOUNTED_CR,
  DESCRIPTION,
  REFERENCE_1,
  REFERENCE_2,
  REFERENCE_3,
  REFERENCE_4,
  REFERENCE_5,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  ATTRIBUTE16,
  ATTRIBUTE17,
  ATTRIBUTE18,
  ATTRIBUTE19,
  ATTRIBUTE20,
  CONTEXT,
  CONTEXT2,
  INVOICE_DATE,
  TAX_CODE,
  INVOICE_IDENTIFIER,
  INVOICE_AMOUNT,
  NO1,
  STAT_AMOUNT,
  IGNORE_RATE_FLAG,
  CONTEXT3,
  USSGL_TRANSACTION_CODE,
  SUBLEDGER_DOC_SEQUENCE_ID,
  CONTEXT4,
  SUBLEDGER_DOC_SEQUENCE_VALUE,
  REFERENCE_6,
  REFERENCE_7,
  REFERENCE_8,
  REFERENCE_9,
  REFERENCE_10,
  JGZZ_RECON_STATUS_11I,
  JGZZ_RECON_DATE_11I,
  JGZZ_RECON_ID_11I,
  JGZZ_RECON_REF_11I,
  JGZZ_RECON_CONTEXT_11I,
  GLOBAL_ATTRIBUTE_CATEGORY,
  GLOBAL_ATTRIBUTE1,
  GLOBAL_ATTRIBUTE2,
  GLOBAL_ATTRIBUTE3,
  GLOBAL_ATTRIBUTE4,
  GLOBAL_ATTRIBUTE5,
  GLOBAL_ATTRIBUTE6,
  GLOBAL_ATTRIBUTE7,
  GLOBAL_ATTRIBUTE8,
  GLOBAL_ATTRIBUTE9,
  GLOBAL_ATTRIBUTE10,
  TAXABLE_LINE_FLAG,
  TAX_TYPE_CODE,
  TAX_CODE_ID,
  TAX_ROUNDING_RULE_CODE,
  AMOUNT_INCLUDES_TAX_FLAG,
  TAX_DOCUMENT_IDENTIFIER,
  TAX_DOCUMENT_DATE,
  TAX_CUSTOMER_NAME,
  TAX_CUSTOMER_REFERENCE,
  TAX_REGISTRATION_NUMBER,
  TAX_LINE_FLAG,
  TAX_GROUP_ID,
  LINE_TYPE_CODE,
  GL_SL_LINK_ID,
  GL_SL_LINK_TABLE,
  CO_THIRD_PARTY,
  CO_PROCESSED_FLAG,
  KCA_OPERATION,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
(
  SELECT
    JE_HEADER_ID,
    JE_LINE_NUM,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    LEDGER_ID,
    CODE_COMBINATION_ID,
    PERIOD_NAME,
    EFFECTIVE_DATE,
    STATUS,
    CREATION_DATE,
    CREATED_BY,
    LAST_UPDATE_LOGIN,
    ENTERED_DR,
    ENTERED_CR,
    ACCOUNTED_DR,
    ACCOUNTED_CR,
    DESCRIPTION,
    REFERENCE_1,
    REFERENCE_2,
    REFERENCE_3,
    REFERENCE_4,
    REFERENCE_5,
    ATTRIBUTE1,
    ATTRIBUTE2,
    ATTRIBUTE3,
    ATTRIBUTE4,
    ATTRIBUTE5,
    ATTRIBUTE6,
    ATTRIBUTE7,
    ATTRIBUTE8,
    ATTRIBUTE9,
    ATTRIBUTE10,
    ATTRIBUTE11,
    ATTRIBUTE12,
    ATTRIBUTE13,
    ATTRIBUTE14,
    ATTRIBUTE15,
    ATTRIBUTE16,
    ATTRIBUTE17,
    ATTRIBUTE18,
    ATTRIBUTE19,
    ATTRIBUTE20,
    CONTEXT,
    CONTEXT2,
    INVOICE_DATE,
    TAX_CODE,
    INVOICE_IDENTIFIER,
    INVOICE_AMOUNT,
    NO1,
    STAT_AMOUNT,
    IGNORE_RATE_FLAG,
    CONTEXT3,
    USSGL_TRANSACTION_CODE,
    SUBLEDGER_DOC_SEQUENCE_ID,
    CONTEXT4,
    SUBLEDGER_DOC_SEQUENCE_VALUE,
    REFERENCE_6,
    REFERENCE_7,
    REFERENCE_8,
    REFERENCE_9,
    REFERENCE_10,
    JGZZ_RECON_STATUS_11I,
    JGZZ_RECON_DATE_11I,
    JGZZ_RECON_ID_11I,
    JGZZ_RECON_REF_11I,
    JGZZ_RECON_CONTEXT_11I,
    GLOBAL_ATTRIBUTE_CATEGORY,
    GLOBAL_ATTRIBUTE1,
    GLOBAL_ATTRIBUTE2,
    GLOBAL_ATTRIBUTE3,
    GLOBAL_ATTRIBUTE4,
    GLOBAL_ATTRIBUTE5,
    GLOBAL_ATTRIBUTE6,
    GLOBAL_ATTRIBUTE7,
    GLOBAL_ATTRIBUTE8,
    GLOBAL_ATTRIBUTE9,
    GLOBAL_ATTRIBUTE10,
    TAXABLE_LINE_FLAG,
    TAX_TYPE_CODE,
    TAX_CODE_ID,
    TAX_ROUNDING_RULE_CODE,
    AMOUNT_INCLUDES_TAX_FLAG,
    TAX_DOCUMENT_IDENTIFIER,
    TAX_DOCUMENT_DATE,
    TAX_CUSTOMER_NAME,
    TAX_CUSTOMER_REFERENCE,
    TAX_REGISTRATION_NUMBER,
    TAX_LINE_FLAG,
    TAX_GROUP_ID,
    LINE_TYPE_CODE,
    GL_SL_LINK_ID,
    GL_SL_LINK_TABLE,
    CO_THIRD_PARTY,
    CO_PROCESSED_FLAG,
    KCA_OPERATION,
    'N' AS IS_DELETED_FLG,
    CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
    kca_seq_date
  FROM bronze_bec_ods_stg.GL_JE_LINES
);
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'gl_je_lines';