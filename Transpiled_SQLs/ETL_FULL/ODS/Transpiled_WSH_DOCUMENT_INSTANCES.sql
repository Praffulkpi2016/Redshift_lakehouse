DROP TABLE IF EXISTS silver_bec_ods.WSH_DOCUMENT_INSTANCES;
CREATE TABLE IF NOT EXISTS silver_bec_ods.WSH_DOCUMENT_INSTANCES (
  document_instance_id DECIMAL(15, 0),
  entity_name STRING,
  entity_id DECIMAL(15, 0),
  document_type STRING,
  sequence_number STRING,
  status STRING,
  final_print_date TIMESTAMP,
  doc_sequence_category_id DECIMAL(15, 0),
  attribute_category STRING,
  attribute1 STRING,
  attribute2 STRING,
  attribute3 STRING,
  attribute4 STRING,
  attribute5 STRING,
  attribute6 STRING,
  attribute7 STRING,
  attribute8 STRING,
  attribute9 STRING,
  attribute10 STRING,
  attribute11 STRING,
  attribute12 STRING,
  attribute13 STRING,
  attribute14 STRING,
  attribute15 STRING,
  creation_date TIMESTAMP,
  created_by DECIMAL(15, 0),
  last_update_date TIMESTAMP,
  last_updated_by DECIMAL(15, 0),
  last_update_login DECIMAL(15, 0),
  program_application_id DECIMAL(15, 0),
  program_id DECIMAL(15, 0),
  program_update_date TIMESTAMP,
  request_id DECIMAL(15, 0),
  pod_flag STRING,
  pod_by STRING,
  pod_date TIMESTAMP,
  reason_of_transport STRING,
  description STRING,
  cod_amount DECIMAL(28, 10),
  cod_currency_code STRING,
  cod_remit_to STRING,
  cod_charge_paid_by STRING,
  problem_contact_reference STRING,
  bill_freight_to STRING,
  carried_by STRING,
  port_of_loading STRING,
  port_of_discharge STRING,
  booking_office STRING,
  booking_number STRING,
  service_contract STRING,
  shipper_export_ref STRING,
  carrier_export_ref STRING,
  bol_notify_party STRING,
  supplier_code STRING,
  aetc_number STRING,
  shipper_signed_by STRING,
  shipper_date TIMESTAMP,
  carrier_signed_by STRING,
  carrier_date TIMESTAMP,
  bol_issue_office STRING,
  bol_issued_by STRING,
  bol_date_issued TIMESTAMP,
  shipper_hm_by STRING,
  shipper_hm_date TIMESTAMP,
  carrier_hm_by STRING,
  carrier_hm_date TIMESTAMP,
  expected_pod_date TIMESTAMP,
  func_amount DECIMAL(28, 10),
  gross_amount DECIMAL(28, 10),
  currency_code STRING,
  certificate_number STRING,
  key_version DECIMAL(15, 0),
  system_entry_date TIMESTAMP,
  document_seq_id DECIMAL(38, 10),
  signature STRING,
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.WSH_DOCUMENT_INSTANCES (
  DOCUMENT_INSTANCE_ID,
  ENTITY_NAME,
  ENTITY_ID,
  DOCUMENT_TYPE,
  SEQUENCE_NUMBER,
  STATUS,
  FINAL_PRINT_DATE,
  DOC_SEQUENCE_CATEGORY_ID,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_LOGIN,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  REQUEST_ID,
  POD_FLAG,
  POD_BY,
  POD_DATE,
  REASON_OF_TRANSPORT,
  DESCRIPTION,
  COD_AMOUNT,
  COD_CURRENCY_CODE,
  COD_REMIT_TO,
  COD_CHARGE_PAID_BY,
  PROBLEM_CONTACT_REFERENCE,
  BILL_FREIGHT_TO,
  CARRIED_BY,
  PORT_OF_LOADING,
  PORT_OF_DISCHARGE,
  BOOKING_OFFICE,
  BOOKING_NUMBER,
  SERVICE_CONTRACT,
  SHIPPER_EXPORT_REF,
  CARRIER_EXPORT_REF,
  BOL_NOTIFY_PARTY,
  SUPPLIER_CODE,
  AETC_NUMBER,
  SHIPPER_SIGNED_BY,
  SHIPPER_DATE,
  CARRIER_SIGNED_BY,
  CARRIER_DATE,
  BOL_ISSUE_OFFICE,
  BOL_ISSUED_BY,
  BOL_DATE_ISSUED,
  SHIPPER_HM_BY,
  SHIPPER_HM_DATE,
  CARRIER_HM_BY,
  CARRIER_HM_DATE,
  EXPECTED_POD_DATE,
  FUNC_AMOUNT,
  GROSS_AMOUNT,
  CURRENCY_CODE,
  CERTIFICATE_NUMBER,
  KEY_VERSION,
  SYSTEM_ENTRY_DATE,
  DOCUMENT_SEQ_ID,
  SIGNATURE,
  KCA_OPERATION,
  IS_DELETED_FLG,
  KCA_SEQ_ID,
  kca_seq_date
)
SELECT
  DOCUMENT_INSTANCE_ID,
  ENTITY_NAME,
  ENTITY_ID,
  DOCUMENT_TYPE,
  SEQUENCE_NUMBER,
  STATUS,
  FINAL_PRINT_DATE,
  DOC_SEQUENCE_CATEGORY_ID,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_LOGIN,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  REQUEST_ID,
  POD_FLAG,
  POD_BY,
  POD_DATE,
  REASON_OF_TRANSPORT,
  DESCRIPTION,
  COD_AMOUNT,
  COD_CURRENCY_CODE,
  COD_REMIT_TO,
  COD_CHARGE_PAID_BY,
  PROBLEM_CONTACT_REFERENCE,
  BILL_FREIGHT_TO,
  CARRIED_BY,
  PORT_OF_LOADING,
  PORT_OF_DISCHARGE,
  BOOKING_OFFICE,
  BOOKING_NUMBER,
  SERVICE_CONTRACT,
  SHIPPER_EXPORT_REF,
  CARRIER_EXPORT_REF,
  BOL_NOTIFY_PARTY,
  SUPPLIER_CODE,
  AETC_NUMBER,
  SHIPPER_SIGNED_BY,
  SHIPPER_DATE,
  CARRIER_SIGNED_BY,
  CARRIER_DATE,
  BOL_ISSUE_OFFICE,
  BOL_ISSUED_BY,
  BOL_DATE_ISSUED,
  SHIPPER_HM_BY,
  SHIPPER_HM_DATE,
  CARRIER_HM_BY,
  CARRIER_HM_DATE,
  EXPECTED_POD_DATE,
  FUNC_AMOUNT,
  GROSS_AMOUNT,
  CURRENCY_CODE,
  CERTIFICATE_NUMBER,
  KEY_VERSION,
  SYSTEM_ENTRY_DATE,
  DOCUMENT_SEQ_ID,
  SIGNATURE,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.WSH_DOCUMENT_INSTANCES;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'wsh_document_instances';