DROP TABLE IF EXISTS silver_bec_ods.FA_BOOK_CONTROLS;
CREATE TABLE IF NOT EXISTS silver_bec_ods.FA_BOOK_CONTROLS (
  book_type_code STRING,
  book_type_name STRING,
  set_of_books_id DECIMAL(15, 0),
  initial_date TIMESTAMP,
  last_deprn_run_date TIMESTAMP,
  amortize_flag STRING,
  fully_reserved_flag STRING,
  deprn_calendar STRING,
  book_class STRING,
  gl_posting_allowed_flag STRING,
  current_fiscal_year SMALLINT,
  allow_mass_changes STRING,
  allow_deprn_adjustments STRING,
  accounting_flex_structure DECIMAL(15, 0),
  last_update_date TIMESTAMP,
  last_updated_by DECIMAL(15, 0),
  prorate_calendar STRING,
  date_ineffective TIMESTAMP,
  je_retirement_category STRING,
  je_depreciation_category STRING,
  je_reclass_category STRING,
  gl_je_source STRING,
  je_addition_category STRING,
  je_adjustment_category STRING,
  distribution_source_book STRING,
  je_transfer_category STRING,
  copy_retirements_flag STRING,
  copy_adjustments_flag STRING,
  deprn_request_id DECIMAL(15, 0),
  allow_cost_ceiling STRING,
  allow_deprn_exp_ceiling STRING,
  calculate_nbv STRING,
  run_year_end_program STRING,
  je_deferred_deprn_category STRING,
  allow_cip_assets_flag STRING,
  itc_allowed_flag STRING,
  created_by DECIMAL(15, 0),
  creation_date TIMESTAMP,
  last_update_login DECIMAL(15, 0),
  allow_mass_copy STRING,
  allow_purge_flag STRING,
  allow_reval_flag STRING,
  amortize_reval_reserve_flag STRING,
  ap_intercompany_acct STRING,
  ar_intercompany_acct STRING,
  attribute1 STRING,
  attribute2 STRING,
  attribute3 STRING,
  attribute4 STRING,
  attribute5 STRING,
  attribute6 STRING,
  attribute7 STRING,
  attribute8 STRING,
  attribute9 STRING,
  attribute10 STRING,
  attribute11 STRING,
  attribute12 STRING,
  attribute13 STRING,
  attribute14 STRING,
  attribute15 STRING,
  attribute_category_code STRING,
  capital_gain_threshold DECIMAL(28, 10),
  copy_salvage_value_flag STRING,
  cost_of_removal_clearing_acct STRING,
  cost_of_removal_gain_acct STRING,
  cost_of_removal_loss_acct STRING,
  default_life_extension_ceiling DECIMAL(28, 10),
  default_life_extension_factor DECIMAL(28, 10),
  default_max_fully_rsvd_revals DECIMAL(28, 10),
  default_reval_fully_rsvd_flag STRING,
  deferred_deprn_expense_acct STRING,
  deferred_deprn_reserve_acct STRING,
  deprn_allocation_code STRING,
  deprn_status STRING,
  fiscal_year_name STRING,
  initial_period_counter DECIMAL(15, 0),
  je_cip_adjustment_category STRING,
  je_cip_addition_category STRING,
  je_cip_reclass_category STRING,
  je_cip_retirement_category STRING,
  je_cip_reval_category STRING,
  je_cip_transfer_category STRING,
  je_reval_category STRING,
  last_mass_copy_period_counter DECIMAL(15, 0),
  last_period_counter DECIMAL(15, 0),
  last_purge_period_counter DECIMAL(15, 0),
  mass_copy_source_book STRING,
  mass_request_id DECIMAL(15, 0),
  nbv_amount_threshold DECIMAL(28, 10),
  nbv_fraction_threshold DECIMAL(28, 10),
  nbv_retired_gain_acct STRING,
  nbv_retired_loss_acct STRING,
  proceeds_of_sale_clearing_acct STRING,
  proceeds_of_sale_gain_acct STRING,
  proceeds_of_sale_loss_acct STRING,
  revalue_on_retirement_flag STRING,
  reval_deprn_reserve_flag STRING,
  reval_posting_flag STRING,
  reval_rsv_retired_gain_acct STRING,
  reval_rsv_retired_loss_acct STRING,
  deprn_adjustment_acct STRING,
  immediate_copy_flag STRING,
  je_deprn_adjustment_category STRING,
  depr_first_year_ret_flag STRING,
  flexbuilder_defaults_ccid DECIMAL(15, 0),
  retire_reval_reserve_flag STRING,
  use_current_nbv_for_deprn STRING,
  copy_additions_flag STRING,
  use_percent_salvage_value_flag STRING,
  mc_source_flag STRING,
  reval_ytd_deprn_flag STRING,
  global_attribute1 STRING,
  global_attribute2 STRING,
  global_attribute3 STRING,
  global_attribute4 STRING,
  global_attribute5 STRING,
  global_attribute6 STRING,
  global_attribute7 STRING,
  global_attribute8 STRING,
  global_attribute9 STRING,
  global_attribute10 STRING,
  global_attribute11 STRING,
  global_attribute12 STRING,
  global_attribute13 STRING,
  global_attribute14 STRING,
  global_attribute15 STRING,
  global_attribute16 STRING,
  global_attribute17 STRING,
  global_attribute18 STRING,
  global_attribute19 STRING,
  global_attribute20 STRING,
  global_attribute_category STRING,
  org_id DECIMAL(15, 0),
  allow_group_deprn_flag STRING,
  allow_cip_dep_group_flag STRING,
  allow_interco_group_flag STRING,
  copy_group_assignment_flag STRING,
  copy_group_addition_flag STRING,
  allow_cip_member_flag STRING,
  allow_member_tracking_flag STRING,
  intercompany_posting_flag STRING,
  allow_backdated_transfers_flag STRING,
  allow_cost_sign_change_flag STRING,
  create_accounting_request_id DECIMAL(15, 0),
  allow_impairment_flag STRING,
  allow_bonus_deprn_flag STRING,
  sorp_enabled_flag STRING,
  copy_amort_adaj_exp_flag STRING,
  copy_group_change_flag STRING,
  prevent_prior_period_txns_flag STRING,
  allow_unallocated_lines_flag STRING,
  default_period_end_reval_flag STRING,
  import_alloc_inv_lines_as_new STRING,
  kca_operation STRING,
  is_deleted_flg STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.FA_BOOK_CONTROLS (
  book_type_code,
  book_type_name,
  set_of_books_id,
  initial_date,
  last_deprn_run_date,
  amortize_flag,
  fully_reserved_flag,
  deprn_calendar,
  book_class,
  gl_posting_allowed_flag,
  current_fiscal_year,
  allow_mass_changes,
  allow_deprn_adjustments,
  accounting_flex_structure,
  last_update_date,
  last_updated_by,
  prorate_calendar,
  date_ineffective,
  je_retirement_category,
  je_depreciation_category,
  je_reclass_category,
  gl_je_source,
  je_addition_category,
  je_adjustment_category,
  distribution_source_book,
  je_transfer_category,
  copy_retirements_flag,
  copy_adjustments_flag,
  deprn_request_id,
  allow_cost_ceiling,
  allow_deprn_exp_ceiling,
  calculate_nbv,
  run_year_end_program,
  je_deferred_deprn_category,
  allow_cip_assets_flag,
  itc_allowed_flag,
  created_by,
  creation_date,
  last_update_login,
  allow_mass_copy,
  allow_purge_flag,
  allow_reval_flag,
  amortize_reval_reserve_flag,
  ap_intercompany_acct,
  ar_intercompany_acct,
  attribute1,
  attribute2,
  attribute3,
  attribute4,
  attribute5,
  attribute6,
  attribute7,
  attribute8,
  attribute9,
  attribute10,
  attribute11,
  attribute12,
  attribute13,
  attribute14,
  attribute15,
  attribute_category_code,
  capital_gain_threshold,
  copy_salvage_value_flag,
  cost_of_removal_clearing_acct,
  cost_of_removal_gain_acct,
  cost_of_removal_loss_acct,
  default_life_extension_ceiling,
  default_life_extension_factor,
  default_max_fully_rsvd_revals,
  default_reval_fully_rsvd_flag,
  deferred_deprn_expense_acct,
  deferred_deprn_reserve_acct,
  deprn_allocation_code,
  deprn_status,
  fiscal_year_name,
  initial_period_counter,
  je_cip_adjustment_category,
  je_cip_addition_category,
  je_cip_reclass_category,
  je_cip_retirement_category,
  je_cip_reval_category,
  je_cip_transfer_category,
  je_reval_category,
  last_mass_copy_period_counter,
  last_period_counter,
  last_purge_period_counter,
  mass_copy_source_book,
  mass_request_id,
  nbv_amount_threshold,
  nbv_fraction_threshold,
  nbv_retired_gain_acct,
  nbv_retired_loss_acct,
  proceeds_of_sale_clearing_acct,
  proceeds_of_sale_gain_acct,
  proceeds_of_sale_loss_acct,
  revalue_on_retirement_flag,
  reval_deprn_reserve_flag,
  reval_posting_flag,
  reval_rsv_retired_gain_acct,
  reval_rsv_retired_loss_acct,
  deprn_adjustment_acct,
  immediate_copy_flag,
  je_deprn_adjustment_category,
  depr_first_year_ret_flag,
  flexbuilder_defaults_ccid,
  retire_reval_reserve_flag,
  use_current_nbv_for_deprn,
  copy_additions_flag,
  use_percent_salvage_value_flag,
  mc_source_flag,
  reval_ytd_deprn_flag,
  global_attribute1,
  global_attribute2,
  global_attribute3,
  global_attribute4,
  global_attribute5,
  global_attribute6,
  global_attribute7,
  global_attribute8,
  global_attribute9,
  global_attribute10,
  global_attribute11,
  global_attribute12,
  global_attribute13,
  global_attribute14,
  global_attribute15,
  global_attribute16,
  global_attribute17,
  global_attribute18,
  global_attribute19,
  global_attribute20,
  global_attribute_category,
  org_id,
  allow_group_deprn_flag,
  allow_cip_dep_group_flag,
  allow_interco_group_flag,
  copy_group_assignment_flag,
  copy_group_addition_flag,
  allow_cip_member_flag,
  allow_member_tracking_flag,
  intercompany_posting_flag,
  allow_backdated_transfers_flag,
  allow_cost_sign_change_flag,
  create_accounting_request_id,
  allow_impairment_flag,
  allow_bonus_deprn_flag,
  sorp_enabled_flag,
  copy_amort_adaj_exp_flag,
  copy_group_change_flag,
  prevent_prior_period_txns_flag,
  allow_unallocated_lines_flag,
  default_period_end_reval_flag,
  import_alloc_inv_lines_as_new,
  kca_operation,
  is_deleted_flg,
  kca_seq_id,
  kca_seq_date
)
SELECT
  book_type_code,
  book_type_name,
  set_of_books_id,
  initial_date,
  last_deprn_run_date,
  amortize_flag,
  fully_reserved_flag,
  deprn_calendar,
  book_class,
  gl_posting_allowed_flag,
  current_fiscal_year,
  allow_mass_changes,
  allow_deprn_adjustments,
  accounting_flex_structure,
  last_update_date,
  last_updated_by,
  prorate_calendar,
  date_ineffective,
  je_retirement_category,
  je_depreciation_category,
  je_reclass_category,
  gl_je_source,
  je_addition_category,
  je_adjustment_category,
  distribution_source_book,
  je_transfer_category,
  copy_retirements_flag,
  copy_adjustments_flag,
  deprn_request_id,
  allow_cost_ceiling,
  allow_deprn_exp_ceiling,
  calculate_nbv,
  run_year_end_program,
  je_deferred_deprn_category,
  allow_cip_assets_flag,
  itc_allowed_flag,
  created_by,
  creation_date,
  last_update_login,
  allow_mass_copy,
  allow_purge_flag,
  allow_reval_flag,
  amortize_reval_reserve_flag,
  ap_intercompany_acct,
  ar_intercompany_acct,
  attribute1,
  attribute2,
  attribute3,
  attribute4,
  attribute5,
  attribute6,
  attribute7,
  attribute8,
  attribute9,
  attribute10,
  attribute11,
  attribute12,
  attribute13,
  attribute14,
  attribute15,
  attribute_category_code,
  capital_gain_threshold,
  copy_salvage_value_flag,
  cost_of_removal_clearing_acct,
  cost_of_removal_gain_acct,
  cost_of_removal_loss_acct,
  default_life_extension_ceiling,
  default_life_extension_factor,
  default_max_fully_rsvd_revals,
  default_reval_fully_rsvd_flag,
  deferred_deprn_expense_acct,
  deferred_deprn_reserve_acct,
  deprn_allocation_code,
  deprn_status,
  fiscal_year_name,
  initial_period_counter,
  je_cip_adjustment_category,
  je_cip_addition_category,
  je_cip_reclass_category,
  je_cip_retirement_category,
  je_cip_reval_category,
  je_cip_transfer_category,
  je_reval_category,
  last_mass_copy_period_counter,
  last_period_counter,
  last_purge_period_counter,
  mass_copy_source_book,
  mass_request_id,
  nbv_amount_threshold,
  nbv_fraction_threshold,
  nbv_retired_gain_acct,
  nbv_retired_loss_acct,
  proceeds_of_sale_clearing_acct,
  proceeds_of_sale_gain_acct,
  proceeds_of_sale_loss_acct,
  revalue_on_retirement_flag,
  reval_deprn_reserve_flag,
  reval_posting_flag,
  reval_rsv_retired_gain_acct,
  reval_rsv_retired_loss_acct,
  deprn_adjustment_acct,
  immediate_copy_flag,
  je_deprn_adjustment_category,
  depr_first_year_ret_flag,
  flexbuilder_defaults_ccid,
  retire_reval_reserve_flag,
  use_current_nbv_for_deprn,
  copy_additions_flag,
  use_percent_salvage_value_flag,
  mc_source_flag,
  reval_ytd_deprn_flag,
  global_attribute1,
  global_attribute2,
  global_attribute3,
  global_attribute4,
  global_attribute5,
  global_attribute6,
  global_attribute7,
  global_attribute8,
  global_attribute9,
  global_attribute10,
  global_attribute11,
  global_attribute12,
  global_attribute13,
  global_attribute14,
  global_attribute15,
  global_attribute16,
  global_attribute17,
  global_attribute18,
  global_attribute19,
  global_attribute20,
  global_attribute_category,
  org_id,
  allow_group_deprn_flag,
  allow_cip_dep_group_flag,
  allow_interco_group_flag,
  copy_group_assignment_flag,
  copy_group_addition_flag,
  allow_cip_member_flag,
  allow_member_tracking_flag,
  intercompany_posting_flag,
  allow_backdated_transfers_flag,
  allow_cost_sign_change_flag,
  create_accounting_request_id,
  allow_impairment_flag,
  allow_bonus_deprn_flag,
  sorp_enabled_flag,
  copy_amort_adaj_exp_flag,
  copy_group_change_flag,
  prevent_prior_period_txns_flag,
  allow_unallocated_lines_flag,
  default_period_end_reval_flag,
  import_alloc_inv_lines_as_new,
  kca_operation,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.FA_BOOK_CONTROLS;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'fa_book_controls';