DROP TABLE IF EXISTS silver_bec_ods.RCV_SHIPMENT_LINES;
CREATE TABLE IF NOT EXISTS silver_bec_ods.RCV_SHIPMENT_LINES (
  shipment_line_id DECIMAL(15, 0),
  last_update_date TIMESTAMP,
  last_updated_by DECIMAL(15, 0),
  creation_date TIMESTAMP,
  created_by DECIMAL(15, 0),
  last_update_login DECIMAL(15, 0),
  shipment_header_id DECIMAL(15, 0),
  line_num DECIMAL(15, 0),
  category_id DECIMAL(15, 0),
  quantity_shipped DECIMAL(28, 10),
  quantity_received DECIMAL(28, 10),
  unit_of_measure STRING,
  item_description STRING,
  item_id DECIMAL(15, 0),
  item_revision STRING,
  vendor_item_num STRING,
  vendor_lot_num STRING,
  uom_conversion_rate DECIMAL(28, 10),
  shipment_line_status_code STRING,
  source_document_code STRING,
  po_header_id DECIMAL(15, 0),
  po_release_id DECIMAL(15, 0),
  po_line_id DECIMAL(15, 0),
  po_line_location_id DECIMAL(15, 0),
  po_distribution_id DECIMAL(15, 0),
  requisition_line_id DECIMAL(15, 0),
  req_distribution_id DECIMAL(15, 0),
  routing_header_id DECIMAL(15, 0),
  packing_slip STRING,
  from_organization_id DECIMAL(15, 0),
  deliver_to_person_id DECIMAL(9, 0),
  employee_id DECIMAL(9, 0),
  destination_type_code STRING,
  to_organization_id DECIMAL(15, 0),
  to_subinventory STRING,
  locator_id DECIMAL(15, 0),
  deliver_to_location_id DECIMAL(15, 0),
  charge_account_id DECIMAL(15, 0),
  transportation_account_id DECIMAL(15, 0),
  shipment_unit_price DECIMAL(28, 10),
  transfer_cost DECIMAL(28, 10),
  transportation_cost DECIMAL(28, 10),
  comments STRING,
  attribute_category STRING,
  attribute1 STRING,
  attribute2 STRING,
  attribute3 STRING,
  attribute4 STRING,
  attribute5 STRING,
  attribute6 STRING,
  attribute7 STRING,
  attribute8 STRING,
  attribute9 STRING,
  attribute10 STRING,
  attribute11 STRING,
  attribute12 STRING,
  attribute13 STRING,
  attribute14 STRING,
  attribute15 STRING,
  reason_id DECIMAL(15, 0),
  ussgl_transaction_code STRING,
  government_context STRING,
  request_id DECIMAL(15, 0),
  program_application_id DECIMAL(15, 0),
  program_id DECIMAL(15, 0),
  program_update_date TIMESTAMP,
  destination_context STRING,
  primary_unit_of_measure STRING,
  excess_transport_reason STRING,
  excess_transport_responsible STRING,
  excess_transport_auth_num STRING,
  asn_line_flag STRING,
  original_asn_parent_line_id STRING,
  original_asn_line_flag STRING,
  vendor_cum_shipped_quantity DECIMAL(28, 10),
  notice_unit_price DECIMAL(28, 10),
  tax_name STRING,
  tax_amount DECIMAL(28, 10),
  invoice_status_code STRING,
  cum_comparison_flag STRING,
  container_num STRING,
  truck_num STRING,
  bar_code_label STRING,
  transfer_percentage DECIMAL(28, 10),
  mrc_shipment_unit_price STRING,
  mrc_transfer_cost STRING,
  mrc_transportation_cost STRING,
  mrc_notice_unit_price STRING,
  ship_to_location_id DECIMAL(15, 0),
  country_of_origin_code STRING,
  oe_order_header_id DECIMAL(15, 0),
  oe_order_line_id DECIMAL(15, 0),
  customer_item_num STRING,
  cost_group_id DECIMAL(15, 0),
  secondary_quantity_shipped DECIMAL(28, 10),
  secondary_quantity_received DECIMAL(28, 10),
  secondary_unit_of_measure STRING,
  qc_grade STRING,
  mmt_transaction_id DECIMAL(15, 0),
  asn_lpn_id DECIMAL(15, 0),
  amount DECIMAL(28, 10),
  amount_received DECIMAL(28, 10),
  job_id DECIMAL(15, 0),
  timecard_id DECIMAL(15, 0),
  timecard_ovn DECIMAL(15, 0),
  osa_flag STRING,
  requested_amount DECIMAL(28, 10),
  material_stored_amount DECIMAL(28, 10),
  approval_status STRING,
  amount_shipped DECIMAL(28, 10),
  lcm_shipment_line_id DECIMAL(15, 0),
  unit_landed_cost DECIMAL(28, 10),
  equipment_id DECIMAL(15, 0),
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.RCV_SHIPMENT_LINES (
  SHIPMENT_LINE_ID,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_LOGIN,
  SHIPMENT_HEADER_ID,
  LINE_NUM,
  CATEGORY_ID,
  QUANTITY_SHIPPED,
  QUANTITY_RECEIVED,
  UNIT_OF_MEASURE,
  ITEM_DESCRIPTION,
  ITEM_ID,
  ITEM_REVISION,
  VENDOR_ITEM_NUM,
  VENDOR_LOT_NUM,
  UOM_CONVERSION_RATE,
  SHIPMENT_LINE_STATUS_CODE,
  SOURCE_DOCUMENT_CODE,
  PO_HEADER_ID,
  PO_RELEASE_ID,
  PO_LINE_ID,
  PO_LINE_LOCATION_ID,
  PO_DISTRIBUTION_ID,
  REQUISITION_LINE_ID,
  REQ_DISTRIBUTION_ID,
  ROUTING_HEADER_ID,
  PACKING_SLIP,
  FROM_ORGANIZATION_ID,
  DELIVER_TO_PERSON_ID,
  EMPLOYEE_ID,
  DESTINATION_TYPE_CODE,
  TO_ORGANIZATION_ID,
  TO_SUBINVENTORY,
  LOCATOR_ID,
  DELIVER_TO_LOCATION_ID,
  CHARGE_ACCOUNT_ID,
  TRANSPORTATION_ACCOUNT_ID,
  SHIPMENT_UNIT_PRICE,
  TRANSFER_COST,
  TRANSPORTATION_COST,
  COMMENTS,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  REASON_ID,
  USSGL_TRANSACTION_CODE,
  GOVERNMENT_CONTEXT,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  DESTINATION_CONTEXT,
  PRIMARY_UNIT_OF_MEASURE,
  EXCESS_TRANSPORT_REASON,
  EXCESS_TRANSPORT_RESPONSIBLE,
  EXCESS_TRANSPORT_AUTH_NUM,
  ASN_LINE_FLAG,
  ORIGINAL_ASN_PARENT_LINE_ID,
  ORIGINAL_ASN_LINE_FLAG,
  VENDOR_CUM_SHIPPED_QUANTITY,
  NOTICE_UNIT_PRICE,
  TAX_NAME,
  TAX_AMOUNT,
  INVOICE_STATUS_CODE,
  CUM_COMPARISON_FLAG,
  CONTAINER_NUM,
  TRUCK_NUM,
  BAR_CODE_LABEL,
  TRANSFER_PERCENTAGE,
  MRC_SHIPMENT_UNIT_PRICE,
  MRC_TRANSFER_COST,
  MRC_TRANSPORTATION_COST,
  MRC_NOTICE_UNIT_PRICE,
  SHIP_TO_LOCATION_ID,
  COUNTRY_OF_ORIGIN_CODE,
  OE_ORDER_HEADER_ID,
  OE_ORDER_LINE_ID,
  CUSTOMER_ITEM_NUM,
  COST_GROUP_ID,
  SECONDARY_QUANTITY_SHIPPED,
  SECONDARY_QUANTITY_RECEIVED,
  SECONDARY_UNIT_OF_MEASURE,
  QC_GRADE,
  MMT_TRANSACTION_ID,
  ASN_LPN_ID,
  AMOUNT,
  AMOUNT_RECEIVED,
  JOB_ID,
  TIMECARD_ID,
  TIMECARD_OVN,
  OSA_FLAG,
  REQUESTED_AMOUNT,
  MATERIAL_STORED_AMOUNT,
  APPROVAL_STATUS,
  AMOUNT_SHIPPED,
  LCM_SHIPMENT_LINE_ID,
  UNIT_LANDED_COST,
  equipment_id,
  KCA_OPERATION,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
SELECT
  SHIPMENT_LINE_ID,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_LOGIN,
  SHIPMENT_HEADER_ID,
  LINE_NUM,
  CATEGORY_ID,
  QUANTITY_SHIPPED,
  QUANTITY_RECEIVED,
  UNIT_OF_MEASURE,
  ITEM_DESCRIPTION,
  ITEM_ID,
  ITEM_REVISION,
  VENDOR_ITEM_NUM,
  VENDOR_LOT_NUM,
  UOM_CONVERSION_RATE,
  SHIPMENT_LINE_STATUS_CODE,
  SOURCE_DOCUMENT_CODE,
  PO_HEADER_ID,
  PO_RELEASE_ID,
  PO_LINE_ID,
  PO_LINE_LOCATION_ID,
  PO_DISTRIBUTION_ID,
  REQUISITION_LINE_ID,
  REQ_DISTRIBUTION_ID,
  ROUTING_HEADER_ID,
  PACKING_SLIP,
  FROM_ORGANIZATION_ID,
  DELIVER_TO_PERSON_ID,
  EMPLOYEE_ID,
  DESTINATION_TYPE_CODE,
  TO_ORGANIZATION_ID,
  TO_SUBINVENTORY,
  LOCATOR_ID,
  DELIVER_TO_LOCATION_ID,
  CHARGE_ACCOUNT_ID,
  TRANSPORTATION_ACCOUNT_ID,
  SHIPMENT_UNIT_PRICE,
  TRANSFER_COST,
  TRANSPORTATION_COST,
  COMMENTS,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  REASON_ID,
  USSGL_TRANSACTION_CODE,
  GOVERNMENT_CONTEXT,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  DESTINATION_CONTEXT,
  PRIMARY_UNIT_OF_MEASURE,
  EXCESS_TRANSPORT_REASON,
  EXCESS_TRANSPORT_RESPONSIBLE,
  EXCESS_TRANSPORT_AUTH_NUM,
  ASN_LINE_FLAG,
  ORIGINAL_ASN_PARENT_LINE_ID,
  ORIGINAL_ASN_LINE_FLAG,
  VENDOR_CUM_SHIPPED_QUANTITY,
  NOTICE_UNIT_PRICE,
  TAX_NAME,
  TAX_AMOUNT,
  INVOICE_STATUS_CODE,
  CUM_COMPARISON_FLAG,
  CONTAINER_NUM,
  TRUCK_NUM,
  BAR_CODE_LABEL,
  TRANSFER_PERCENTAGE,
  MRC_SHIPMENT_UNIT_PRICE,
  MRC_TRANSFER_COST,
  MRC_TRANSPORTATION_COST,
  MRC_NOTICE_UNIT_PRICE,
  SHIP_TO_LOCATION_ID,
  COUNTRY_OF_ORIGIN_CODE,
  OE_ORDER_HEADER_ID,
  OE_ORDER_LINE_ID,
  CUSTOMER_ITEM_NUM,
  COST_GROUP_ID,
  SECONDARY_QUANTITY_SHIPPED,
  SECONDARY_QUANTITY_RECEIVED,
  SECONDARY_UNIT_OF_MEASURE,
  QC_GRADE,
  MMT_TRANSACTION_ID,
  ASN_LPN_ID,
  AMOUNT,
  AMOUNT_RECEIVED,
  JOB_ID,
  TIMECARD_ID,
  TIMECARD_OVN,
  OSA_FLAG,
  REQUESTED_AMOUNT,
  MATERIAL_STORED_AMOUNT,
  APPROVAL_STATUS,
  AMOUNT_SHIPPED,
  LCM_SHIPMENT_LINE_ID,
  UNIT_LANDED_COST,
  equipment_id,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.RCV_SHIPMENT_LINES;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'rcv_shipment_lines';