DROP table IF EXISTS silver_bec_ods.GL_LEDGERS;
CREATE TABLE IF NOT EXISTS silver_bec_ods.GL_LEDGERS (
  LEDGER_ID DECIMAL(15, 0),
  NAME STRING,
  SHORT_NAME STRING,
  DESCRIPTION STRING,
  LEDGER_CATEGORY_CODE STRING,
  ALC_LEDGER_TYPE_CODE STRING,
  OBJECT_TYPE_CODE STRING,
  LE_LEDGER_TYPE_CODE STRING,
  COMPLETION_STATUS_CODE STRING,
  CONFIGURATION_ID DECIMAL(15, 0),
  CHART_OF_ACCOUNTS_ID DECIMAL(15, 0),
  CURRENCY_CODE STRING,
  PERIOD_SET_NAME STRING,
  ACCOUNTED_PERIOD_TYPE STRING,
  FIRST_LEDGER_PERIOD_NAME STRING,
  RET_EARN_CODE_COMBINATION_ID DECIMAL(15, 0),
  SUSPENSE_ALLOWED_FLAG STRING,
  ALLOW_INTERCOMPANY_POST_FLAG STRING,
  TRACK_ROUNDING_IMBALANCE_FLAG STRING,
  ENABLE_AVERAGE_BALANCES_FLAG STRING,
  CUM_TRANS_CODE_COMBINATION_ID DECIMAL(15, 0),
  RES_ENCUMB_CODE_COMBINATION_ID DECIMAL(15, 0),
  NET_INCOME_CODE_COMBINATION_ID DECIMAL(15, 0),
  ROUNDING_CODE_COMBINATION_ID DECIMAL(15, 0),
  ENABLE_BUDGETARY_CONTROL_FLAG STRING,
  REQUIRE_BUDGET_JOURNALS_FLAG STRING,
  ENABLE_JE_APPROVAL_FLAG STRING,
  ENABLE_AUTOMATIC_TAX_FLAG STRING,
  CONSOLIDATION_LEDGER_FLAG STRING,
  TRANSLATE_EOD_FLAG STRING,
  TRANSLATE_QATD_FLAG STRING,
  TRANSLATE_YATD_FLAG STRING,
  TRANSACTION_CALENDAR_ID DECIMAL(15, 0),
  DAILY_TRANSLATION_RATE_TYPE STRING,
  AUTOMATICALLY_CREATED_FLAG STRING,
  BAL_SEG_VALUE_OPTION_CODE STRING,
  BAL_SEG_COLUMN_NAME STRING,
  MGT_SEG_VALUE_OPTION_CODE STRING,
  MGT_SEG_COLUMN_NAME STRING,
  BAL_SEG_VALUE_SET_ID DECIMAL(10, 0),
  MGT_SEG_VALUE_SET_ID DECIMAL(10, 0),
  IMPLICIT_ACCESS_SET_ID DECIMAL(15, 0),
  CRITERIA_SET_ID DECIMAL(15, 0),
  FUTURE_ENTERABLE_PERIODS_LIMIT DECIMAL(15, 0),
  LEDGER_ATTRIBUTES STRING,
  IMPLICIT_LEDGER_SET_ID DECIMAL(15, 0),
  LATEST_OPENED_PERIOD_NAME STRING,
  LATEST_ENCUMBRANCE_YEAR DECIMAL(15, 0),
  PERIOD_AVERAGE_RATE_TYPE STRING,
  PERIOD_END_RATE_TYPE STRING,
  BUDGET_PERIOD_AVG_RATE_TYPE STRING,
  BUDGET_PERIOD_END_RATE_TYPE STRING,
  SLA_ACCOUNTING_METHOD_CODE STRING,
  SLA_ACCOUNTING_METHOD_TYPE STRING,
  SLA_DESCRIPTION_LANGUAGE STRING,
  SLA_ENTERED_CUR_BAL_SUS_CCID DECIMAL(15, 0),
  SLA_SEQUENCING_FLAG STRING,
  SLA_BAL_BY_LEDGER_CURR_FLAG STRING,
  SLA_LEDGER_CUR_BAL_SUS_CCID DECIMAL(15, 0),
  ENABLE_SECONDARY_TRACK_FLAG STRING,
  ENABLE_REVAL_SS_TRACK_FLAG STRING,
  LAST_UPDATE_DATE TIMESTAMP,
  LAST_UPDATED_BY DECIMAL(15, 0),
  CREATION_DATE TIMESTAMP,
  CREATED_BY DECIMAL(15, 0),
  LAST_UPDATE_LOGIN DECIMAL(15, 0),
  CONTEXT STRING,
  ATTRIBUTE1 STRING,
  ATTRIBUTE2 STRING,
  ATTRIBUTE3 STRING,
  ATTRIBUTE4 STRING,
  ATTRIBUTE5 STRING,
  ATTRIBUTE6 STRING,
  ATTRIBUTE7 STRING,
  ATTRIBUTE8 STRING,
  ATTRIBUTE9 STRING,
  ATTRIBUTE10 STRING,
  ATTRIBUTE11 STRING,
  ATTRIBUTE12 STRING,
  ATTRIBUTE13 STRING,
  ATTRIBUTE14 STRING,
  ATTRIBUTE15 STRING,
  ENABLE_RECONCILIATION_FLAG STRING,
  CREATE_JE_FLAG STRING,
  SLA_LEDGER_CASH_BASIS_FLAG STRING,
  COMPLETE_FLAG STRING,
  COMMITMENT_BUDGET_FLAG STRING,
  AUTOMATE_SEC_JRNL_REV_FLAG STRING,
  NET_CLOSING_BAL_FLAG STRING,
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.GL_LEDGERS (
  LEDGER_ID,
  NAME,
  SHORT_NAME,
  DESCRIPTION,
  LEDGER_CATEGORY_CODE,
  ALC_LEDGER_TYPE_CODE,
  OBJECT_TYPE_CODE,
  LE_LEDGER_TYPE_CODE,
  COMPLETION_STATUS_CODE,
  CONFIGURATION_ID,
  CHART_OF_ACCOUNTS_ID,
  CURRENCY_CODE,
  PERIOD_SET_NAME,
  ACCOUNTED_PERIOD_TYPE,
  FIRST_LEDGER_PERIOD_NAME,
  RET_EARN_CODE_COMBINATION_ID,
  SUSPENSE_ALLOWED_FLAG,
  ALLOW_INTERCOMPANY_POST_FLAG,
  TRACK_ROUNDING_IMBALANCE_FLAG,
  ENABLE_AVERAGE_BALANCES_FLAG,
  CUM_TRANS_CODE_COMBINATION_ID,
  RES_ENCUMB_CODE_COMBINATION_ID,
  NET_INCOME_CODE_COMBINATION_ID,
  ROUNDING_CODE_COMBINATION_ID,
  ENABLE_BUDGETARY_CONTROL_FLAG,
  REQUIRE_BUDGET_JOURNALS_FLAG,
  ENABLE_JE_APPROVAL_FLAG,
  ENABLE_AUTOMATIC_TAX_FLAG,
  CONSOLIDATION_LEDGER_FLAG,
  TRANSLATE_EOD_FLAG,
  TRANSLATE_QATD_FLAG,
  TRANSLATE_YATD_FLAG,
  TRANSACTION_CALENDAR_ID,
  DAILY_TRANSLATION_RATE_TYPE,
  AUTOMATICALLY_CREATED_FLAG,
  BAL_SEG_VALUE_OPTION_CODE,
  BAL_SEG_COLUMN_NAME,
  MGT_SEG_VALUE_OPTION_CODE,
  MGT_SEG_COLUMN_NAME,
  BAL_SEG_VALUE_SET_ID,
  MGT_SEG_VALUE_SET_ID,
  IMPLICIT_ACCESS_SET_ID,
  CRITERIA_SET_ID,
  FUTURE_ENTERABLE_PERIODS_LIMIT,
  LEDGER_ATTRIBUTES,
  IMPLICIT_LEDGER_SET_ID,
  LATEST_OPENED_PERIOD_NAME,
  LATEST_ENCUMBRANCE_YEAR,
  PERIOD_AVERAGE_RATE_TYPE,
  PERIOD_END_RATE_TYPE,
  BUDGET_PERIOD_AVG_RATE_TYPE,
  BUDGET_PERIOD_END_RATE_TYPE,
  SLA_ACCOUNTING_METHOD_CODE,
  SLA_ACCOUNTING_METHOD_TYPE,
  SLA_DESCRIPTION_LANGUAGE,
  SLA_ENTERED_CUR_BAL_SUS_CCID,
  SLA_SEQUENCING_FLAG,
  SLA_BAL_BY_LEDGER_CURR_FLAG,
  SLA_LEDGER_CUR_BAL_SUS_CCID,
  ENABLE_SECONDARY_TRACK_FLAG,
  ENABLE_REVAL_SS_TRACK_FLAG,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_LOGIN,
  CONTEXT,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  ENABLE_RECONCILIATION_FLAG,
  CREATE_JE_FLAG,
  SLA_LEDGER_CASH_BASIS_FLAG,
  COMPLETE_FLAG,
  COMMITMENT_BUDGET_FLAG,
  AUTOMATE_SEC_JRNL_REV_FLAG,
  NET_CLOSING_BAL_FLAG,
  KCA_OPERATION,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
(
  SELECT
    LEDGER_ID,
    NAME,
    SHORT_NAME,
    DESCRIPTION,
    LEDGER_CATEGORY_CODE,
    ALC_LEDGER_TYPE_CODE,
    OBJECT_TYPE_CODE,
    LE_LEDGER_TYPE_CODE,
    COMPLETION_STATUS_CODE,
    CONFIGURATION_ID,
    CHART_OF_ACCOUNTS_ID,
    CURRENCY_CODE,
    PERIOD_SET_NAME,
    ACCOUNTED_PERIOD_TYPE,
    FIRST_LEDGER_PERIOD_NAME,
    RET_EARN_CODE_COMBINATION_ID,
    SUSPENSE_ALLOWED_FLAG,
    ALLOW_INTERCOMPANY_POST_FLAG,
    TRACK_ROUNDING_IMBALANCE_FLAG,
    ENABLE_AVERAGE_BALANCES_FLAG,
    CUM_TRANS_CODE_COMBINATION_ID,
    RES_ENCUMB_CODE_COMBINATION_ID,
    NET_INCOME_CODE_COMBINATION_ID,
    ROUNDING_CODE_COMBINATION_ID,
    ENABLE_BUDGETARY_CONTROL_FLAG,
    REQUIRE_BUDGET_JOURNALS_FLAG,
    ENABLE_JE_APPROVAL_FLAG,
    ENABLE_AUTOMATIC_TAX_FLAG,
    CONSOLIDATION_LEDGER_FLAG,
    TRANSLATE_EOD_FLAG,
    TRANSLATE_QATD_FLAG,
    TRANSLATE_YATD_FLAG,
    TRANSACTION_CALENDAR_ID,
    DAILY_TRANSLATION_RATE_TYPE,
    AUTOMATICALLY_CREATED_FLAG,
    BAL_SEG_VALUE_OPTION_CODE,
    BAL_SEG_COLUMN_NAME,
    MGT_SEG_VALUE_OPTION_CODE,
    MGT_SEG_COLUMN_NAME,
    BAL_SEG_VALUE_SET_ID,
    MGT_SEG_VALUE_SET_ID,
    IMPLICIT_ACCESS_SET_ID,
    CRITERIA_SET_ID,
    FUTURE_ENTERABLE_PERIODS_LIMIT,
    LEDGER_ATTRIBUTES,
    IMPLICIT_LEDGER_SET_ID,
    LATEST_OPENED_PERIOD_NAME,
    LATEST_ENCUMBRANCE_YEAR,
    PERIOD_AVERAGE_RATE_TYPE,
    PERIOD_END_RATE_TYPE,
    BUDGET_PERIOD_AVG_RATE_TYPE,
    BUDGET_PERIOD_END_RATE_TYPE,
    SLA_ACCOUNTING_METHOD_CODE,
    SLA_ACCOUNTING_METHOD_TYPE,
    SLA_DESCRIPTION_LANGUAGE,
    SLA_ENTERED_CUR_BAL_SUS_CCID,
    SLA_SEQUENCING_FLAG,
    SLA_BAL_BY_LEDGER_CURR_FLAG,
    SLA_LEDGER_CUR_BAL_SUS_CCID,
    ENABLE_SECONDARY_TRACK_FLAG,
    ENABLE_REVAL_SS_TRACK_FLAG,
    LAST_UPDATE_DATE,
    LAST_UPDATED_BY,
    CREATION_DATE,
    CREATED_BY,
    LAST_UPDATE_LOGIN,
    CONTEXT,
    ATTRIBUTE1,
    ATTRIBUTE2,
    ATTRIBUTE3,
    ATTRIBUTE4,
    ATTRIBUTE5,
    ATTRIBUTE6,
    ATTRIBUTE7,
    ATTRIBUTE8,
    ATTRIBUTE9,
    ATTRIBUTE10,
    ATTRIBUTE11,
    ATTRIBUTE12,
    ATTRIBUTE13,
    ATTRIBUTE14,
    ATTRIBUTE15,
    ENABLE_RECONCILIATION_FLAG,
    CREATE_JE_FLAG,
    SLA_LEDGER_CASH_BASIS_FLAG,
    COMPLETE_FLAG,
    COMMITMENT_BUDGET_FLAG,
    AUTOMATE_SEC_JRNL_REV_FLAG,
    NET_CLOSING_BAL_FLAG,
    KCA_OPERATION,
    'N' AS IS_DELETED_FLG,
    CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
    kca_seq_date
  FROM bronze_bec_ods_stg.GL_LEDGERS
);
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'gl_ledgers';