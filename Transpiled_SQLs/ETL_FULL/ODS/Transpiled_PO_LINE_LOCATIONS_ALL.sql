DROP TABLE IF EXISTS silver_bec_ods.PO_LINE_LOCATIONS_ALL;
CREATE TABLE IF NOT EXISTS silver_bec_ods.PO_LINE_LOCATIONS_ALL (
  line_location_id DECIMAL(15, 0),
  last_update_date TIMESTAMP,
  last_updated_by DECIMAL(15, 0),
  po_header_id DECIMAL(15, 0),
  po_line_id DECIMAL(15, 0),
  last_update_login DECIMAL(15, 0),
  creation_date TIMESTAMP,
  created_by DECIMAL(15, 0),
  quantity DECIMAL(28, 10),
  quantity_received DECIMAL(28, 10),
  quantity_accepted DECIMAL(28, 10),
  quantity_rejected DECIMAL(28, 10),
  quantity_billed DECIMAL(28, 10),
  quantity_cancelled DECIMAL(28, 10),
  unit_meas_lookup_code STRING,
  po_release_id DECIMAL(15, 0),
  ship_to_location_id DECIMAL(15, 0),
  ship_via_lookup_code STRING,
  need_by_date TIMESTAMP,
  promised_date TIMESTAMP,
  last_accept_date TIMESTAMP,
  price_override DECIMAL(28, 10),
  encumbered_flag STRING,
  encumbered_date TIMESTAMP,
  unencumbered_quantity DECIMAL(28, 10),
  fob_lookup_code STRING,
  freight_terms_lookup_code STRING,
  taxable_flag STRING,
  tax_name STRING,
  estimated_tax_amount DECIMAL(28, 10),
  from_header_id DECIMAL(15, 0),
  from_line_id DECIMAL(15, 0),
  from_line_location_id DECIMAL(15, 0),
  start_date TIMESTAMP,
  end_date TIMESTAMP,
  lead_time DECIMAL(15, 0),
  lead_time_unit STRING,
  price_discount DECIMAL(28, 10),
  terms_id DECIMAL(15, 0),
  approved_flag STRING,
  approved_date TIMESTAMP,
  closed_flag STRING,
  cancel_flag STRING,
  cancelled_by DECIMAL(9, 0),
  cancel_date TIMESTAMP,
  cancel_reason STRING,
  firm_status_lookup_code STRING,
  firm_date TIMESTAMP,
  attribute_category STRING,
  attribute1 STRING,
  attribute2 STRING,
  attribute3 STRING,
  attribute4 STRING,
  attribute5 STRING,
  attribute6 STRING,
  attribute7 STRING,
  attribute8 STRING,
  attribute9 STRING,
  attribute10 STRING,
  unit_of_measure_class STRING,
  encumber_now STRING,
  attribute11 STRING,
  attribute12 STRING,
  attribute13 STRING,
  attribute14 STRING,
  attribute15 STRING,
  inspection_required_flag STRING,
  receipt_required_flag STRING,
  qty_rcv_tolerance DECIMAL(28, 10),
  qty_rcv_exception_code STRING,
  enforce_ship_to_location_code STRING,
  allow_substitute_receipts_flag STRING,
  days_early_receipt_allowed DECIMAL(15, 0),
  days_late_receipt_allowed DECIMAL(15, 0),
  receipt_days_exception_code STRING,
  invoice_close_tolerance DECIMAL(15, 0),
  receive_close_tolerance DECIMAL(15, 0),
  ship_to_organization_id DECIMAL(15, 0),
  shipment_num DECIMAL(15, 0),
  source_shipment_id DECIMAL(15, 0),
  shipment_type STRING,
  closed_code STRING,
  request_id DECIMAL(15, 0),
  program_application_id DECIMAL(15, 0),
  program_id DECIMAL(15, 0),
  program_update_date TIMESTAMP,
  ussgl_transaction_code STRING,
  government_context STRING,
  receiving_routing_id DECIMAL(15, 0),
  accrue_on_receipt_flag STRING,
  closed_reason STRING,
  closed_date TIMESTAMP,
  closed_by DECIMAL(9, 0),
  org_id DECIMAL(15, 0),
  quantity_shipped DECIMAL(28, 10),
  global_attribute_category STRING,
  global_attribute1 STRING,
  global_attribute2 STRING,
  global_attribute3 STRING,
  global_attribute4 STRING,
  global_attribute5 STRING,
  global_attribute6 STRING,
  global_attribute7 STRING,
  global_attribute8 STRING,
  global_attribute9 STRING,
  global_attribute10 STRING,
  global_attribute11 STRING,
  global_attribute12 STRING,
  global_attribute13 STRING,
  global_attribute14 STRING,
  global_attribute15 STRING,
  global_attribute16 STRING,
  global_attribute17 STRING,
  global_attribute18 STRING,
  global_attribute19 STRING,
  global_attribute20 STRING,
  country_of_origin_code STRING,
  tax_user_override_flag STRING,
  match_option STRING,
  tax_code_id DECIMAL(15, 0),
  calculate_tax_flag STRING,
  change_promised_date_reason STRING,
  note_to_receiver STRING,
  secondary_quantity DECIMAL(28, 10),
  secondary_unit_of_measure STRING,
  preferred_grade STRING,
  secondary_quantity_received DECIMAL(28, 10),
  secondary_quantity_accepted DECIMAL(28, 10),
  secondary_quantity_rejected DECIMAL(28, 10),
  secondary_quantity_cancelled DECIMAL(28, 10),
  vmi_flag STRING,
  consigned_flag STRING,
  retroactive_date TIMESTAMP,
  supplier_order_line_number STRING,
  amount DECIMAL(28, 10),
  amount_received DECIMAL(28, 10),
  amount_billed DECIMAL(28, 10),
  amount_cancelled DECIMAL(28, 10),
  amount_rejected DECIMAL(28, 10),
  amount_accepted DECIMAL(28, 10),
  drop_ship_flag STRING,
  sales_order_update_date TIMESTAMP,
  transaction_flow_header_id DECIMAL(15, 0),
  final_match_flag STRING,
  manual_price_change_flag STRING,
  shipment_closed_date TIMESTAMP,
  closed_for_receiving_date TIMESTAMP,
  closed_for_invoice_date TIMESTAMP,
  secondary_quantity_shipped DECIMAL(28, 10),
  value_basis STRING,
  matching_basis STRING,
  payment_type STRING,
  description STRING,
  work_approver_id DECIMAL(15, 0),
  bid_payment_id DECIMAL(15, 0),
  quantity_financed DECIMAL(28, 10),
  amount_financed DECIMAL(28, 10),
  quantity_recouped DECIMAL(28, 10),
  amount_recouped DECIMAL(28, 10),
  retainage_withheld_amount DECIMAL(28, 10),
  retainage_released_amount DECIMAL(28, 10),
  amount_shipped DECIMAL(28, 10),
  outsourced_assembly DECIMAL(28, 10),
  tax_attribute_update_code STRING,
  original_shipment_id DECIMAL(15, 0),
  lcm_flag STRING,
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  kca_seq_id DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.PO_LINE_LOCATIONS_ALL (
  LINE_LOCATION_ID,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  PO_HEADER_ID,
  PO_LINE_ID,
  LAST_UPDATE_LOGIN,
  CREATION_DATE,
  CREATED_BY,
  QUANTITY,
  QUANTITY_RECEIVED,
  QUANTITY_ACCEPTED,
  QUANTITY_REJECTED,
  QUANTITY_BILLED,
  QUANTITY_CANCELLED,
  UNIT_MEAS_LOOKUP_CODE,
  PO_RELEASE_ID,
  SHIP_TO_LOCATION_ID,
  SHIP_VIA_LOOKUP_CODE,
  NEED_BY_DATE,
  PROMISED_DATE,
  LAST_ACCEPT_DATE,
  PRICE_OVERRIDE,
  ENCUMBERED_FLAG,
  ENCUMBERED_DATE,
  UNENCUMBERED_QUANTITY,
  FOB_LOOKUP_CODE,
  FREIGHT_TERMS_LOOKUP_CODE,
  TAXABLE_FLAG,
  TAX_NAME,
  ESTIMATED_TAX_AMOUNT,
  FROM_HEADER_ID,
  FROM_LINE_ID,
  FROM_LINE_LOCATION_ID,
  START_DATE,
  END_DATE,
  LEAD_TIME,
  LEAD_TIME_UNIT,
  PRICE_DISCOUNT,
  TERMS_ID,
  APPROVED_FLAG,
  APPROVED_DATE,
  CLOSED_FLAG,
  CANCEL_FLAG,
  CANCELLED_BY,
  CANCEL_DATE,
  CANCEL_REASON,
  FIRM_STATUS_LOOKUP_CODE,
  FIRM_DATE,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  UNIT_OF_MEASURE_CLASS,
  ENCUMBER_NOW,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  INSPECTION_REQUIRED_FLAG,
  RECEIPT_REQUIRED_FLAG,
  QTY_RCV_TOLERANCE,
  QTY_RCV_EXCEPTION_CODE,
  ENFORCE_SHIP_TO_LOCATION_CODE,
  ALLOW_SUBSTITUTE_RECEIPTS_FLAG,
  DAYS_EARLY_RECEIPT_ALLOWED,
  DAYS_LATE_RECEIPT_ALLOWED,
  RECEIPT_DAYS_EXCEPTION_CODE,
  INVOICE_CLOSE_TOLERANCE,
  RECEIVE_CLOSE_TOLERANCE,
  SHIP_TO_ORGANIZATION_ID,
  SHIPMENT_NUM,
  SOURCE_SHIPMENT_ID,
  SHIPMENT_TYPE,
  CLOSED_CODE,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  USSGL_TRANSACTION_CODE,
  GOVERNMENT_CONTEXT,
  RECEIVING_ROUTING_ID,
  ACCRUE_ON_RECEIPT_FLAG,
  CLOSED_REASON,
  CLOSED_DATE,
  CLOSED_BY,
  ORG_ID,
  QUANTITY_SHIPPED,
  GLOBAL_ATTRIBUTE_CATEGORY,
  GLOBAL_ATTRIBUTE1,
  GLOBAL_ATTRIBUTE2,
  GLOBAL_ATTRIBUTE3,
  GLOBAL_ATTRIBUTE4,
  GLOBAL_ATTRIBUTE5,
  GLOBAL_ATTRIBUTE6,
  GLOBAL_ATTRIBUTE7,
  GLOBAL_ATTRIBUTE8,
  GLOBAL_ATTRIBUTE9,
  GLOBAL_ATTRIBUTE10,
  GLOBAL_ATTRIBUTE11,
  GLOBAL_ATTRIBUTE12,
  GLOBAL_ATTRIBUTE13,
  GLOBAL_ATTRIBUTE14,
  GLOBAL_ATTRIBUTE15,
  GLOBAL_ATTRIBUTE16,
  GLOBAL_ATTRIBUTE17,
  GLOBAL_ATTRIBUTE18,
  GLOBAL_ATTRIBUTE19,
  GLOBAL_ATTRIBUTE20,
  COUNTRY_OF_ORIGIN_CODE,
  TAX_USER_OVERRIDE_FLAG,
  MATCH_OPTION,
  TAX_CODE_ID,
  CALCULATE_TAX_FLAG,
  CHANGE_PROMISED_DATE_REASON,
  NOTE_TO_RECEIVER,
  SECONDARY_QUANTITY,
  SECONDARY_UNIT_OF_MEASURE,
  PREFERRED_GRADE,
  SECONDARY_QUANTITY_RECEIVED,
  SECONDARY_QUANTITY_ACCEPTED,
  SECONDARY_QUANTITY_REJECTED,
  SECONDARY_QUANTITY_CANCELLED,
  VMI_FLAG,
  CONSIGNED_FLAG,
  RETROACTIVE_DATE,
  SUPPLIER_ORDER_LINE_NUMBER,
  AMOUNT,
  AMOUNT_RECEIVED,
  AMOUNT_BILLED,
  AMOUNT_CANCELLED,
  AMOUNT_REJECTED,
  AMOUNT_ACCEPTED,
  DROP_SHIP_FLAG,
  SALES_ORDER_UPDATE_DATE,
  TRANSACTION_FLOW_HEADER_ID,
  FINAL_MATCH_FLAG,
  MANUAL_PRICE_CHANGE_FLAG,
  SHIPMENT_CLOSED_DATE,
  CLOSED_FOR_RECEIVING_DATE,
  CLOSED_FOR_INVOICE_DATE,
  SECONDARY_QUANTITY_SHIPPED,
  VALUE_BASIS,
  MATCHING_BASIS,
  PAYMENT_TYPE,
  DESCRIPTION,
  WORK_APPROVER_ID,
  BID_PAYMENT_ID,
  QUANTITY_FINANCED,
  AMOUNT_FINANCED,
  QUANTITY_RECOUPED,
  AMOUNT_RECOUPED,
  RETAINAGE_WITHHELD_AMOUNT,
  RETAINAGE_RELEASED_AMOUNT,
  AMOUNT_SHIPPED,
  OUTSOURCED_ASSEMBLY,
  TAX_ATTRIBUTE_UPDATE_CODE,
  ORIGINAL_SHIPMENT_ID,
  LCM_FLAG,
  KCA_OPERATION,
  IS_DELETED_FLG,
  kca_seq_id,
  kca_seq_date
)
SELECT
  LINE_LOCATION_ID,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  PO_HEADER_ID,
  PO_LINE_ID,
  LAST_UPDATE_LOGIN,
  CREATION_DATE,
  CREATED_BY,
  QUANTITY,
  QUANTITY_RECEIVED,
  QUANTITY_ACCEPTED,
  QUANTITY_REJECTED,
  QUANTITY_BILLED,
  QUANTITY_CANCELLED,
  UNIT_MEAS_LOOKUP_CODE,
  PO_RELEASE_ID,
  SHIP_TO_LOCATION_ID,
  SHIP_VIA_LOOKUP_CODE,
  NEED_BY_DATE,
  PROMISED_DATE,
  LAST_ACCEPT_DATE,
  PRICE_OVERRIDE,
  ENCUMBERED_FLAG,
  ENCUMBERED_DATE,
  UNENCUMBERED_QUANTITY,
  FOB_LOOKUP_CODE,
  FREIGHT_TERMS_LOOKUP_CODE,
  TAXABLE_FLAG,
  TAX_NAME,
  ESTIMATED_TAX_AMOUNT,
  FROM_HEADER_ID,
  FROM_LINE_ID,
  FROM_LINE_LOCATION_ID,
  START_DATE,
  END_DATE,
  LEAD_TIME,
  LEAD_TIME_UNIT,
  PRICE_DISCOUNT,
  TERMS_ID,
  APPROVED_FLAG,
  APPROVED_DATE,
  CLOSED_FLAG,
  CANCEL_FLAG,
  CANCELLED_BY,
  CANCEL_DATE,
  CANCEL_REASON,
  FIRM_STATUS_LOOKUP_CODE,
  FIRM_DATE,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  UNIT_OF_MEASURE_CLASS,
  ENCUMBER_NOW,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  INSPECTION_REQUIRED_FLAG,
  RECEIPT_REQUIRED_FLAG,
  QTY_RCV_TOLERANCE,
  QTY_RCV_EXCEPTION_CODE,
  ENFORCE_SHIP_TO_LOCATION_CODE,
  ALLOW_SUBSTITUTE_RECEIPTS_FLAG,
  DAYS_EARLY_RECEIPT_ALLOWED,
  DAYS_LATE_RECEIPT_ALLOWED,
  RECEIPT_DAYS_EXCEPTION_CODE,
  INVOICE_CLOSE_TOLERANCE,
  RECEIVE_CLOSE_TOLERANCE,
  SHIP_TO_ORGANIZATION_ID,
  SHIPMENT_NUM,
  SOURCE_SHIPMENT_ID,
  SHIPMENT_TYPE,
  CLOSED_CODE,
  REQUEST_ID,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  PROGRAM_UPDATE_DATE,
  USSGL_TRANSACTION_CODE,
  GOVERNMENT_CONTEXT,
  RECEIVING_ROUTING_ID,
  ACCRUE_ON_RECEIPT_FLAG,
  CLOSED_REASON,
  CLOSED_DATE,
  CLOSED_BY,
  ORG_ID,
  QUANTITY_SHIPPED,
  GLOBAL_ATTRIBUTE_CATEGORY,
  GLOBAL_ATTRIBUTE1,
  GLOBAL_ATTRIBUTE2,
  GLOBAL_ATTRIBUTE3,
  GLOBAL_ATTRIBUTE4,
  GLOBAL_ATTRIBUTE5,
  GLOBAL_ATTRIBUTE6,
  GLOBAL_ATTRIBUTE7,
  GLOBAL_ATTRIBUTE8,
  GLOBAL_ATTRIBUTE9,
  GLOBAL_ATTRIBUTE10,
  GLOBAL_ATTRIBUTE11,
  GLOBAL_ATTRIBUTE12,
  GLOBAL_ATTRIBUTE13,
  GLOBAL_ATTRIBUTE14,
  GLOBAL_ATTRIBUTE15,
  GLOBAL_ATTRIBUTE16,
  GLOBAL_ATTRIBUTE17,
  GLOBAL_ATTRIBUTE18,
  GLOBAL_ATTRIBUTE19,
  GLOBAL_ATTRIBUTE20,
  COUNTRY_OF_ORIGIN_CODE,
  TAX_USER_OVERRIDE_FLAG,
  MATCH_OPTION,
  TAX_CODE_ID,
  CALCULATE_TAX_FLAG,
  CHANGE_PROMISED_DATE_REASON,
  NOTE_TO_RECEIVER,
  SECONDARY_QUANTITY,
  SECONDARY_UNIT_OF_MEASURE,
  PREFERRED_GRADE,
  SECONDARY_QUANTITY_RECEIVED,
  SECONDARY_QUANTITY_ACCEPTED,
  SECONDARY_QUANTITY_REJECTED,
  SECONDARY_QUANTITY_CANCELLED,
  VMI_FLAG,
  CONSIGNED_FLAG,
  RETROACTIVE_DATE,
  SUPPLIER_ORDER_LINE_NUMBER,
  AMOUNT,
  AMOUNT_RECEIVED,
  AMOUNT_BILLED,
  AMOUNT_CANCELLED,
  AMOUNT_REJECTED,
  AMOUNT_ACCEPTED,
  DROP_SHIP_FLAG,
  SALES_ORDER_UPDATE_DATE,
  TRANSACTION_FLOW_HEADER_ID,
  FINAL_MATCH_FLAG,
  MANUAL_PRICE_CHANGE_FLAG,
  SHIPMENT_CLOSED_DATE,
  CLOSED_FOR_RECEIVING_DATE,
  CLOSED_FOR_INVOICE_DATE,
  SECONDARY_QUANTITY_SHIPPED,
  VALUE_BASIS,
  MATCHING_BASIS,
  PAYMENT_TYPE,
  DESCRIPTION,
  WORK_APPROVER_ID,
  BID_PAYMENT_ID,
  QUANTITY_FINANCED,
  AMOUNT_FINANCED,
  QUANTITY_RECOUPED,
  AMOUNT_RECOUPED,
  RETAINAGE_WITHHELD_AMOUNT,
  RETAINAGE_RELEASED_AMOUNT,
  AMOUNT_SHIPPED,
  OUTSOURCED_ASSEMBLY,
  TAX_ATTRIBUTE_UPDATE_CODE,
  ORIGINAL_SHIPMENT_ID,
  LCM_FLAG,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.po_line_locations_all;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'po_line_locations_all';