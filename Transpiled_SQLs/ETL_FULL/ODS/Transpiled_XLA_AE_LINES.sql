DROP TABLE IF EXISTS silver_bec_ods.XLA_AE_LINES;
CREATE TABLE IF NOT EXISTS silver_bec_ods.XLA_AE_LINES (
  AE_HEADER_ID DECIMAL(15, 0),
  AE_LINE_NUM DECIMAL(15, 0),
  APPLICATION_ID DECIMAL(15, 0),
  CODE_COMBINATION_ID DECIMAL(15, 0),
  GL_TRANSFER_MODE_CODE STRING,
  GL_SL_LINK_ID DECIMAL(15, 0),
  ACCOUNTING_CLASS_CODE STRING,
  PARTY_ID DECIMAL(15, 0),
  PARTY_SITE_ID DECIMAL(15, 0),
  PARTY_TYPE_CODE STRING,
  ENTERED_DR DECIMAL(28, 10),
  ENTERED_CR DECIMAL(28, 10),
  ACCOUNTED_DR DECIMAL(28, 10),
  ACCOUNTED_CR DECIMAL(28, 10),
  DESCRIPTION STRING,
  STATISTICAL_AMOUNT DECIMAL(28, 10),
  CURRENCY_CODE STRING,
  CURRENCY_CONVERSION_DATE TIMESTAMP,
  CURRENCY_CONVERSION_RATE DECIMAL(28, 10),
  CURRENCY_CONVERSION_TYPE STRING,
  USSGL_TRANSACTION_CODE STRING,
  JGZZ_RECON_REF STRING,
  CONTROL_BALANCE_FLAG STRING,
  ANALYTICAL_BALANCE_FLAG STRING,
  ATTRIBUTE_CATEGORY STRING,
  ATTRIBUTE1 STRING,
  ATTRIBUTE2 STRING,
  ATTRIBUTE3 STRING,
  ATTRIBUTE4 STRING,
  ATTRIBUTE5 STRING,
  ATTRIBUTE6 STRING,
  ATTRIBUTE7 STRING,
  ATTRIBUTE8 STRING,
  ATTRIBUTE9 STRING,
  ATTRIBUTE10 STRING,
  ATTRIBUTE11 STRING,
  ATTRIBUTE12 STRING,
  ATTRIBUTE13 STRING,
  ATTRIBUTE14 STRING,
  ATTRIBUTE15 STRING,
  GL_SL_LINK_TABLE STRING,
  DISPLAYED_LINE_NUMBER DECIMAL(15, 0),
  CREATION_DATE TIMESTAMP,
  CREATED_BY DECIMAL(15, 0),
  LAST_UPDATE_DATE TIMESTAMP,
  LAST_UPDATED_BY DECIMAL(15, 0),
  LAST_UPDATE_LOGIN DECIMAL(15, 0),
  PROGRAM_UPDATE_DATE TIMESTAMP,
  PROGRAM_APPLICATION_ID DECIMAL(15, 0),
  PROGRAM_ID DECIMAL(15, 0),
  REQUEST_ID DECIMAL(15, 0),
  UPG_BATCH_ID DECIMAL(15, 0),
  UPG_TAX_REFERENCE_ID1 DECIMAL(15, 0),
  UPG_TAX_REFERENCE_ID2 DECIMAL(15, 0),
  UPG_TAX_REFERENCE_ID3 DECIMAL(15, 0),
  UNROUNDED_ACCOUNTED_DR DECIMAL(28, 10),
  UNROUNDED_ACCOUNTED_CR DECIMAL(28, 10),
  GAIN_OR_LOSS_FLAG STRING,
  UNROUNDED_ENTERED_DR DECIMAL(28, 10),
  UNROUNDED_ENTERED_CR DECIMAL(28, 10),
  SUBSTITUTED_CCID DECIMAL(15, 0),
  BUSINESS_CLASS_CODE STRING,
  MPA_ACCRUAL_ENTRY_FLAG STRING,
  ENCUMBRANCE_TYPE_ID DECIMAL(15, 0),
  FUNDS_STATUS_CODE STRING,
  MERGE_CODE_COMBINATION_ID DECIMAL(15, 0),
  MERGE_PARTY_ID DECIMAL(15, 0),
  MERGE_PARTY_SITE_ID DECIMAL(15, 0),
  ACCOUNTING_DATE TIMESTAMP,
  LEDGER_ID DECIMAL(15, 0),
  SOURCE_TABLE STRING,
  SOURCE_ID DECIMAL(15, 0),
  ACCOUNT_OVERLAY_SOURCE_ID DECIMAL(15, 0),
  KCA_OPERATION STRING,
  IS_DELETED_FLG STRING,
  KCA_SEQ_ID DECIMAL(36, 0),
  kca_seq_date TIMESTAMP
);
INSERT INTO silver_bec_ods.XLA_AE_LINES (
  AE_HEADER_ID,
  AE_LINE_NUM,
  APPLICATION_ID,
  CODE_COMBINATION_ID,
  GL_TRANSFER_MODE_CODE,
  GL_SL_LINK_ID,
  ACCOUNTING_CLASS_CODE,
  PARTY_ID,
  PARTY_SITE_ID,
  PARTY_TYPE_CODE,
  ENTERED_DR,
  ENTERED_CR,
  ACCOUNTED_DR,
  ACCOUNTED_CR,
  DESCRIPTION,
  STATISTICAL_AMOUNT,
  CURRENCY_CODE,
  CURRENCY_CONVERSION_DATE,
  CURRENCY_CONVERSION_RATE,
  CURRENCY_CONVERSION_TYPE,
  USSGL_TRANSACTION_CODE,
  JGZZ_RECON_REF,
  CONTROL_BALANCE_FLAG,
  ANALYTICAL_BALANCE_FLAG,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  GL_SL_LINK_TABLE,
  DISPLAYED_LINE_NUMBER,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_LOGIN,
  PROGRAM_UPDATE_DATE,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  REQUEST_ID,
  UPG_BATCH_ID,
  UPG_TAX_REFERENCE_ID1,
  UPG_TAX_REFERENCE_ID2,
  UPG_TAX_REFERENCE_ID3,
  UNROUNDED_ACCOUNTED_DR,
  UNROUNDED_ACCOUNTED_CR,
  GAIN_OR_LOSS_FLAG,
  UNROUNDED_ENTERED_DR,
  UNROUNDED_ENTERED_CR,
  SUBSTITUTED_CCID,
  BUSINESS_CLASS_CODE,
  MPA_ACCRUAL_ENTRY_FLAG,
  ENCUMBRANCE_TYPE_ID,
  FUNDS_STATUS_CODE,
  MERGE_CODE_COMBINATION_ID,
  MERGE_PARTY_ID,
  MERGE_PARTY_SITE_ID,
  ACCOUNTING_DATE,
  LEDGER_ID,
  SOURCE_TABLE,
  SOURCE_ID,
  ACCOUNT_OVERLAY_SOURCE_ID,
  KCA_OPERATION,
  IS_DELETED_FLG,
  KCA_SEQ_ID,
  kca_seq_date
)
SELECT
  AE_HEADER_ID,
  AE_LINE_NUM,
  APPLICATION_ID,
  CODE_COMBINATION_ID,
  GL_TRANSFER_MODE_CODE,
  GL_SL_LINK_ID,
  ACCOUNTING_CLASS_CODE,
  PARTY_ID,
  PARTY_SITE_ID,
  PARTY_TYPE_CODE,
  ENTERED_DR,
  ENTERED_CR,
  ACCOUNTED_DR,
  ACCOUNTED_CR,
  DESCRIPTION,
  STATISTICAL_AMOUNT,
  CURRENCY_CODE,
  CURRENCY_CONVERSION_DATE,
  CURRENCY_CONVERSION_RATE,
  CURRENCY_CONVERSION_TYPE,
  USSGL_TRANSACTION_CODE,
  JGZZ_RECON_REF,
  CONTROL_BALANCE_FLAG,
  ANALYTICAL_BALANCE_FLAG,
  ATTRIBUTE_CATEGORY,
  ATTRIBUTE1,
  ATTRIBUTE2,
  ATTRIBUTE3,
  ATTRIBUTE4,
  ATTRIBUTE5,
  ATTRIBUTE6,
  ATTRIBUTE7,
  ATTRIBUTE8,
  ATTRIBUTE9,
  ATTRIBUTE10,
  ATTRIBUTE11,
  ATTRIBUTE12,
  ATTRIBUTE13,
  ATTRIBUTE14,
  ATTRIBUTE15,
  GL_SL_LINK_TABLE,
  DISPLAYED_LINE_NUMBER,
  CREATION_DATE,
  CREATED_BY,
  LAST_UPDATE_DATE,
  LAST_UPDATED_BY,
  LAST_UPDATE_LOGIN,
  PROGRAM_UPDATE_DATE,
  PROGRAM_APPLICATION_ID,
  PROGRAM_ID,
  REQUEST_ID,
  UPG_BATCH_ID,
  UPG_TAX_REFERENCE_ID1,
  UPG_TAX_REFERENCE_ID2,
  UPG_TAX_REFERENCE_ID3,
  UNROUNDED_ACCOUNTED_DR,
  UNROUNDED_ACCOUNTED_CR,
  GAIN_OR_LOSS_FLAG,
  UNROUNDED_ENTERED_DR,
  UNROUNDED_ENTERED_CR,
  SUBSTITUTED_CCID,
  BUSINESS_CLASS_CODE,
  MPA_ACCRUAL_ENTRY_FLAG,
  ENCUMBRANCE_TYPE_ID,
  FUNDS_STATUS_CODE,
  MERGE_CODE_COMBINATION_ID,
  MERGE_PARTY_ID,
  MERGE_PARTY_SITE_ID,
  ACCOUNTING_DATE,
  LEDGER_ID,
  SOURCE_TABLE,
  SOURCE_ID,
  ACCOUNT_OVERLAY_SOURCE_ID,
  KCA_OPERATION,
  'N' AS IS_DELETED_FLG,
  CAST(NULLIF(KCA_SEQ_ID, '') AS DECIMAL(36, 0)) AS KCA_SEQ_ID,
  kca_seq_date
FROM bronze_bec_ods_stg.XLA_AE_LINES;
UPDATE bec_etl_ctrl.batch_ods_info SET load_type = 'I', last_refresh_date = CURRENT_TIMESTAMP()
WHERE
  ods_table_name = 'xla_ae_lines';