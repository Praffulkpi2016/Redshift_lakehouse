/*
# Copyright(c) 2022 KPI Partners, Inc. All Rights Reserved.
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#
# author: KPI Partners, Inc.
# version: 2022.06
# description: This script represents Incremental load approach for ODS.
# File Version: KPI v1.0
*/

begin;

TRUNCATE TABLE bec_ods.GL_CODE_COMBINATIONS_KFV;

insert into bec_ods.GL_CODE_COMBINATIONS_KFV
(
code_combination_id,
chart_of_accounts_id,
concatenated_segments,
padded_concatenated_segments,
gl_account_type,
gl_control_account,
reconciliation_flag,
detail_budgeting_allowed,
detail_posting_allowed,
template_id,
ledger_segment,
attribute1,
revaluation_id,
segment_attribute17,
segment_attribute18,
segment_attribute19,
segment_attribute20,
segment_attribute21,
segment_attribute22,
segment_attribute23,
segment_attribute24,
segment_attribute25,
segment_attribute26,
segment_attribute27,
segment_attribute28,
segment_attribute29,
segment_attribute30,
segment_attribute31,
segment_attribute32,
segment_attribute33,
segment_attribute34,
segment_attribute35,
segment_attribute36,
segment_attribute37,
segment_attribute38,
segment_attribute39,
segment_attribute40,
segment_attribute41,
segment_attribute42,
jgzz_recon_context,
reference1,
reference2,
reference4,
reference5,
preserve_flag,
refresh_flag,
igi_balanced_budget_flag,
company_cost_center_org_id,
alternate_code_combination_id,
last_update_date,
last_updated_by,
enabled_flag,
summary_flag,
segment1,
segment2,
segment3,
segment4,
segment5,
segment6,
segment7,
segment8,
segment9,
segment10,
segment11,
segment12,
segment13,
segment14,
segment15,
segment16,
segment17,
segment18,
segment19,
segment20,
segment21,
segment22,
segment23,
segment24,
segment25,
segment26,
segment27,
segment28,
segment29,
segment30,
description,
allocation_create_flag,
start_date_active,
end_date_active,
attribute2,
attribute3,
attribute4,
attribute5,
attribute6,
attribute7,
attribute8,
attribute9,
attribute10,
context,
segment_attribute1,
segment_attribute2,
segment_attribute3,
segment_attribute4,
segment_attribute5,
segment_attribute6,
segment_attribute7,
segment_attribute8,
segment_attribute9,
segment_attribute10,
segment_attribute11,
segment_attribute12,
segment_attribute13,
segment_attribute14,
segment_attribute15,
segment_attribute16,
kca_operation 
,IS_DELETED_FLG
,kca_seq_id
,kca_seq_date
)
SELECT

code_combination_id,
chart_of_accounts_id,
concatenated_segments,
padded_concatenated_segments,
gl_account_type,
gl_control_account,
reconciliation_flag,
detail_budgeting_allowed,
detail_posting_allowed,
template_id,
ledger_segment,
attribute1,
revaluation_id,
segment_attribute17,
segment_attribute18,
segment_attribute19,
segment_attribute20,
segment_attribute21,
segment_attribute22,
segment_attribute23,
segment_attribute24,
segment_attribute25,
segment_attribute26,
segment_attribute27,
segment_attribute28,
segment_attribute29,
segment_attribute30,
segment_attribute31,
segment_attribute32,
segment_attribute33,
segment_attribute34,
segment_attribute35,
segment_attribute36,
segment_attribute37,
segment_attribute38,
segment_attribute39,
segment_attribute40,
segment_attribute41,
segment_attribute42,
jgzz_recon_context,
reference1,
reference2,
reference4,
reference5,
preserve_flag,
refresh_flag,
igi_balanced_budget_flag,
company_cost_center_org_id,
alternate_code_combination_id,
last_update_date,
last_updated_by,
enabled_flag,
summary_flag,
segment1,
segment2,
segment3,
segment4,
segment5,
segment6,
segment7,
segment8,
segment9,
segment10,
segment11,
segment12,
segment13,
segment14,
segment15,
segment16,
segment17,
segment18,
segment19,
segment20,
segment21,
segment22,
segment23,
segment24,
segment25,
segment26,
segment27,
segment28,
segment29,
segment30,
description,
allocation_create_flag,
start_date_active,
end_date_active,
attribute2,
attribute3,
attribute4,
attribute5,
attribute6,
attribute7,
attribute8,
attribute9,
attribute10,
context,
segment_attribute1,
segment_attribute2,
segment_attribute3,
segment_attribute4,
segment_attribute5,
segment_attribute6,
segment_attribute7,
segment_attribute8,
segment_attribute9,
segment_attribute10,
segment_attribute11,
segment_attribute12,
segment_attribute13,
segment_attribute14,
segment_attribute15,
segment_attribute16,
kca_operation 
,'N' as IS_DELETED_FLG
,cast(NULLIF(KCA_SEQ_ID,'') as numeric(36,0)) as KCA_SEQ_ID
,kca_seq_date
FROM bec_ods_stg.GL_CODE_COMBINATIONS_KFV;

end;

update
	bec_etl_ctrl.batch_ods_info
set load_type = 'I',
	last_refresh_date = getdate()
where
	ods_table_name = 'gl_code_combinations_kfv';

commit;